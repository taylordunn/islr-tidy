<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Resampling Methods | An Introduction to Statistical Learning with the tidyverse</title>
  <meta name="description" content="Working through ISLR with the tidyverse and tidymodels" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Resampling Methods | An Introduction to Statistical Learning with the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Working through ISLR with the tidyverse and tidymodels" />
  <meta name="github-repo" content="taylordunn/islr-tidy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Resampling Methods | An Introduction to Statistical Learning with the tidyverse" />
  
  <meta name="twitter:description" content="Working through ISLR with the tidyverse and tidymodels" />
  

<meta name="author" content="Taylor Dunn" />


<meta name="date" content="2022-02-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="classification.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Who, what, and why?</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#an-overview-of-statistical-learning"><i class="fa fa-check"></i>An Overview of Statistical Learning</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#wage-data"><i class="fa fa-check"></i>Wage Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#a-brief-history-of-statistical-learning"><i class="fa fa-check"></i>A Brief History of Statistical Learning</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#this-book"><i class="fa fa-check"></i>This Book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-learning.html"><a href="statistical-learning.html"><i class="fa fa-check"></i><b>2</b> Statistical Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#what-is-statistical-learning"><i class="fa fa-check"></i><b>2.1</b> What Is Statistical Learning?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-learning.html"><a href="statistical-learning.html#why-estimate-f"><i class="fa fa-check"></i><b>2.1.1</b> Why Estimate <span class="math inline">\(f\)</span>?</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-learning.html"><a href="statistical-learning.html#how-do-we-estimate-f"><i class="fa fa-check"></i><b>2.1.2</b> How Do We Estimate f?</a></li>
<li class="chapter" data-level="2.1.3" data-path="statistical-learning.html"><a href="statistical-learning.html#the-trade-off-between-prediction-accuracy-and-model-interpretability"><i class="fa fa-check"></i><b>2.1.3</b> The Trade-Off Between Prediction Accuracy and Model Interpretability</a></li>
<li class="chapter" data-level="2.1.4" data-path="statistical-learning.html"><a href="statistical-learning.html#supervised-versus-unsupervised-learning"><i class="fa fa-check"></i><b>2.1.4</b> Supervised Versus Unsupervised Learning</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#assessing-model-accuracy"><i class="fa fa-check"></i><b>2.2</b> Assessing Model Accuracy</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#measuring-the-quality-of-fit"><i class="fa fa-check"></i><b>2.2.1</b> Measuring the Quality of Fit</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#the-bias-variance-trade-off"><i class="fa fa-check"></i><b>2.2.2</b> The Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="2.2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#the-classification-setting"><i class="fa fa-check"></i><b>2.2.3</b> The Classification Setting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#lab-introduction-to-r"><i class="fa fa-check"></i><b>2.3</b> Lab: Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>3.1.1</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-coefficient-estimates"><i class="fa fa-check"></i><b>3.1.2</b> Assessing the Accuracy of the Coefficient Estimates</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-model"><i class="fa fa-check"></i><b>3.1.3</b> Assessing the Accuracy of the Model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>3.2</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-regression-coefficients"><i class="fa fa-check"></i><b>3.2.1</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#some-important-questions"><i class="fa fa-check"></i><b>3.2.2</b> Some Important Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#other-considerations-in-the-regression-model"><i class="fa fa-check"></i><b>3.3</b> Other Considerations in the Regression Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="linear-regression.html"><a href="linear-regression.html#qualitative-predictors"><i class="fa fa-check"></i><b>3.3.1</b> Qualitative Predictors</a></li>
<li class="chapter" data-level="3.3.2" data-path="linear-regression.html"><a href="linear-regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>3.3.2</b> Extensions of the Linear Model</a></li>
<li class="chapter" data-level="3.3.3" data-path="linear-regression.html"><a href="linear-regression.html#potential-problems"><i class="fa fa-check"></i><b>3.3.3</b> Potential Problems</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="linear-regression.html"><a href="linear-regression.html#the-marketing-plan"><i class="fa fa-check"></i><b>3.4</b> The Marketing Plan</a></li>
<li class="chapter" data-level="3.5" data-path="linear-regression.html"><a href="linear-regression.html#comparison-of-linear-regression-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>3.5</b> Comparison of Linear Regression with <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="3.6" data-path="linear-regression.html"><a href="linear-regression.html#lab-linear-regression"><i class="fa fa-check"></i><b>3.6</b> Lab: Linear Regression</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="linear-regression.html"><a href="linear-regression.html#libraries"><i class="fa fa-check"></i><b>3.6.1</b> Libraries</a></li>
<li class="chapter" data-level="3.6.2" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="3.6.3" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.3</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="3.6.4" data-path="linear-regression.html"><a href="linear-regression.html#interaction-terms"><i class="fa fa-check"></i><b>3.6.4</b> Interaction Terms</a></li>
<li class="chapter" data-level="3.6.5" data-path="linear-regression.html"><a href="linear-regression.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>3.6.5</b> Non-linear Transformations of the Predictors</a></li>
<li class="chapter" data-level="3.6.6" data-path="linear-regression.html"><a href="linear-regression.html#qualitative-predictors-1"><i class="fa fa-check"></i><b>3.6.6</b> Qualitative Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="linear-regression.html"><a href="linear-regression.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#applied"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>4</b> Classification</a>
<ul>
<li class="chapter" data-level="4.1" data-path="classification.html"><a href="classification.html#an-overview-of-classification"><i class="fa fa-check"></i><b>4.1</b> An Overview of Classification</a></li>
<li class="chapter" data-level="4.2" data-path="classification.html"><a href="classification.html#why-not-linear-regression"><i class="fa fa-check"></i><b>4.2</b> Why Not Linear Regression?</a></li>
<li class="chapter" data-level="4.3" data-path="classification.html"><a href="classification.html#logistic-regression"><i class="fa fa-check"></i><b>4.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="classification.html"><a href="classification.html#the-logistic-model"><i class="fa fa-check"></i><b>4.3.1</b> The Logistic Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="classification.html"><a href="classification.html#estimating-the-regression-coefficients-1"><i class="fa fa-check"></i><b>4.3.2</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="4.3.3" data-path="classification.html"><a href="classification.html#making-predictions"><i class="fa fa-check"></i><b>4.3.3</b> Making Predictions</a></li>
<li class="chapter" data-level="4.3.4" data-path="classification.html"><a href="classification.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>4.3.4</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="classification.html"><a href="classification.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>4.3.5</b> Multinomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="classification.html"><a href="classification.html#generative-models-for-classification"><i class="fa fa-check"></i><b>4.4</b> Generative Models for Classification</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis-for-p-1"><i class="fa fa-check"></i><b>4.4.1</b> Linear Discriminant Analysis for <span class="math inline">\(p = 1\)</span></a></li>
<li class="chapter" data-level="4.4.2" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis-for-p-1-1"><i class="fa fa-check"></i><b>4.4.2</b> Linear Discriminant Analysis for <span class="math inline">\(p &gt; 1\)</span></a></li>
<li class="chapter" data-level="4.4.3" data-path="classification.html"><a href="classification.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>4.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="4.4.4" data-path="classification.html"><a href="classification.html#naive-bayes"><i class="fa fa-check"></i><b>4.4.4</b> Naive Bayes</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="classification.html"><a href="classification.html#a-comparison-of-classification-methods"><i class="fa fa-check"></i><b>4.5</b> A Comparison of Classification Methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="classification.html"><a href="classification.html#an-analytical-comparison"><i class="fa fa-check"></i><b>4.5.1</b> An Analytical Comparison</a></li>
<li class="chapter" data-level="4.5.2" data-path="classification.html"><a href="classification.html#an-empirical-comparison"><i class="fa fa-check"></i><b>4.5.2</b> An Empirical Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="classification.html"><a href="classification.html#generalized-linear-models"><i class="fa fa-check"></i><b>4.6</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="classification.html"><a href="classification.html#linear-regression-on-the-bikeshare-data"><i class="fa fa-check"></i><b>4.6.1</b> Linear Regression on the Bikeshare Data</a></li>
<li class="chapter" data-level="4.6.2" data-path="classification.html"><a href="classification.html#poisson-regression-on-bikeshare-data"><i class="fa fa-check"></i><b>4.6.2</b> Poisson Regression on Bikeshare Data</a></li>
<li class="chapter" data-level="4.6.3" data-path="classification.html"><a href="classification.html#generalized-linear-models-in-greater-generality"><i class="fa fa-check"></i><b>4.6.3</b> Generalized Linear Models in Greater Generality</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="classification.html"><a href="classification.html#lab-classification-methods"><i class="fa fa-check"></i><b>4.7</b> Lab: Classification Methods</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="classification.html"><a href="classification.html#the-stock-market-data"><i class="fa fa-check"></i><b>4.7.1</b> The Stock Market Data</a></li>
<li class="chapter" data-level="4.7.2" data-path="classification.html"><a href="classification.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.7.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="4.7.3" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>4.7.3</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="4.7.4" data-path="classification.html"><a href="classification.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>4.7.4</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="4.7.5" data-path="classification.html"><a href="classification.html#naive-bayes-1"><i class="fa fa-check"></i><b>4.7.5</b> Naive Bayes</a></li>
<li class="chapter" data-level="4.7.6" data-path="classification.html"><a href="classification.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>4.7.6</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="4.7.7" data-path="classification.html"><a href="classification.html#poisson-regression"><i class="fa fa-check"></i><b>4.7.7</b> Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="classification.html"><a href="classification.html#exercises-1"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#applied-1"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>5</b> Resampling Methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation"><i class="fa fa-check"></i><b>5.1</b> Cross Validation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#validation-set"><i class="fa fa-check"></i><b>5.1.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="5.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#loocv"><i class="fa fa-check"></i><b>5.1.2</b> Leave-One-Out Cross Validation</a></li>
<li class="chapter" data-level="5.1.3" data-path="resampling-methods.html"><a href="resampling-methods.html#kfoldcv"><i class="fa fa-check"></i><b>5.1.3</b> <span class="math inline">\(k\)</span>-fold Cross-Validation</a></li>
<li class="chapter" data-level="5.1.4" data-path="resampling-methods.html"><a href="resampling-methods.html#bias-variance-trade-off-for-k-fold-cross-validation"><i class="fa fa-check"></i><b>5.1.4</b> Bias-Variance Trade-Off for <span class="math inline">\(k\)</span>-Fold Cross-Validation</a></li>
<li class="chapter" data-level="5.1.5" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation-on-classification-problems"><i class="fa fa-check"></i><b>5.1.5</b> Cross-Validation on Classification Problems</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap"><i class="fa fa-check"></i><b>5.2</b> The Bootstrap</a></li>
<li class="chapter" data-level="5.3" data-path="resampling-methods.html"><a href="resampling-methods.html#lab-cross-validation-and-the-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Lab: Cross-Validation and the Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="resampling-methods.html"><a href="resampling-methods.html#the-validation-set-approach"><i class="fa fa-check"></i><b>5.3.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="5.3.2" data-path="resampling-methods.html"><a href="resampling-methods.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>5.3.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="5.3.3" data-path="resampling-methods.html"><a href="resampling-methods.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>5.3.3</b> <span class="math inline">\(k\)</span>-fold Cross-Validation</a></li>
<li class="chapter" data-level="5.3.4" data-path="resampling-methods.html"><a href="resampling-methods.html#the-bootstrap"><i class="fa fa-check"></i><b>5.3.4</b> The Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="resampling-methods.html"><a href="resampling-methods.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="resampling-methods.html"><a href="resampling-methods.html#applied-2"><i class="fa fa-check"></i><b>5.4.1</b> Applied</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning with the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="resampling-methods" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Resampling Methods</h1>
<blockquote>
<p>Resampling methods are an indispensable tool in modern statistics. They
involve repeatedly drawing samples from a training set and refitting a model
of interest on each sample in order to obtain additional information about
the fitted model. For example, in order to estimate the variability of a linear
regression fit, we can repeatedly draw different samples from the training
data, fit a linear regression to each new sample, and then examine the
extent to which the resulting fits differ. Such an approach may allow us to
obtain information that would not be available from fitting the model only
once using the original training sample.</p>
</blockquote>
<blockquote>
<p>In this chapter, we discuss two of the most commonly
used resampling methods, <em>cross-validation</em> and the <em>bootstrap</em>.</p>
</blockquote>
<p>Cross-validation is most often used to estimate test error associated with a statistical learning method, whereas the boostrap is most commonly used to provide a measure of accuracy for a given parameter/method.</p>
<blockquote>
<p>The process
of evaluating a model’s performance is known as <em>model assessment</em>, whereas
the process of selecting the proper level of flexibility for a model is known as <em>model selection</em>.</p>
</blockquote>
<div id="cross-validation" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Cross Validation</h2>
<p>Sometimes we want to estimate the test error rate using the available training data.
A number of approaches can be used for this.
In this section we consider methods which involve <em>holding out</em> a subset of the training data from the fitting process, then applying the model to that hold-out set for model assessment.</p>
<div id="validation-set" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> The Validation Set Approach</h3>
<p>This simple strategy involves randomly dividing available observations into training and validation sets.
The model is fit on the training set, and used to make predictions on the validation set.
The corresponding metric from the validation set predictions – usually MSE in the case of a quantitative response – provides an estimate of the test error rate.</p>
<p>To illustrate this, load the <code>Auto</code> data set and R packages:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="resampling-methods.html#cb332-1" aria-hidden="true" tabindex="-1"></a>auto <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Auto</span>
<span id="cb332-2"><a href="resampling-methods.html#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="resampling-methods.html#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb332-4"><a href="resampling-methods.html#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb332-5"><a href="resampling-methods.html#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb332-6"><a href="resampling-methods.html#cb332-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb332-7"><a href="resampling-methods.html#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># for composing plots</span></span>
<span id="cb332-8"><a href="resampling-methods.html#cb332-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb332-9"><a href="resampling-methods.html#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Load my R package and set the ggplot theme</span></span>
<span id="cb332-10"><a href="resampling-methods.html#cb332-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunnr)</span>
<span id="cb332-11"><a href="resampling-methods.html#cb332-11" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">&quot;win&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb332-12"><a href="resampling-methods.html#cb332-12" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_td</span>())</span>
<span id="cb332-13"><a href="resampling-methods.html#cb332-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set_geom_fonts</span>()</span>
<span id="cb332-14"><a href="resampling-methods.html#cb332-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set_palette</span>()</span></code></pre></div>
<p>Randomly split the data into 50% training and 50% validation, fit on the training set, and compute the MSE on the validation set.
Since I’ll be repeating this 10 times to reproduce the figure, make a couple functions.
First, a function to set a random seed and split the data into training and validation set (called <code>assessment</code> set in the <code>rsample</code> package):</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="resampling-methods.html#cb333-1" aria-hidden="true" tabindex="-1"></a>auto_validation_split <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb333-2"><a href="resampling-methods.html#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb333-3"><a href="resampling-methods.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validation_split</span>(auto, <span class="at">prop =</span> <span class="fl">0.5</span>)</span>
<span id="cb333-4"><a href="resampling-methods.html#cb333-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb333-5"><a href="resampling-methods.html#cb333-5" aria-hidden="true" tabindex="-1"></a>auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_validation_split</span>(<span class="at">seed =</span> <span class="dv">10</span>)</span>
<span id="cb333-6"><a href="resampling-methods.html#cb333-6" aria-hidden="true" tabindex="-1"></a>auto_splits</span></code></pre></div>
<pre><code>## # Validation Set Split (0.5/0.5)  
## # A tibble: 1 x 2
##   splits            id        
##   &lt;list&gt;            &lt;chr&gt;     
## 1 &lt;split [196/196]&gt; validation</code></pre>
<p>Similar to the <code>initial_split</code> workflow, I can access the training and validation sets as follows:</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="resampling-methods.html#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="fu">training</span>(auto_splits<span class="sc">$</span>splits[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##      mpg cylinders displacement horsepower weight acceleration year origin
## 139 14.0         8          318        150   4457         13.5   74      1
## 333 29.8         4           89         62   1845         15.3   80      2
## 373 27.0         4          151         90   2735         18.0   82      1
## 73  15.0         8          304        150   3892         12.5   72      1
## 213 16.5         8          350        180   4380         12.1   76      1
## 348 37.0         4           85         65   1975         19.4   81      3
##                          name
## 139 dodge coronet custom (sw)
## 333          vokswagen rabbit
## 373           pontiac phoenix
## 73           amc matador (sw)
## 213          cadillac seville
## 348            datsun 210 mpg</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="resampling-methods.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assessment</span>(auto_splits<span class="sc">$</span>splits[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   mpg cylinders displacement horsepower weight acceleration year origin
## 1  18         8          307        130   3504         12.0   70      1
## 2  15         8          350        165   3693         11.5   70      1
## 3  18         8          318        150   3436         11.0   70      1
## 5  17         8          302        140   3449         10.5   70      1
## 6  15         8          429        198   4341         10.0   70      1
## 7  14         8          454        220   4354          9.0   70      1
##                        name
## 1 chevrolet chevelle malibu
## 2         buick skylark 320
## 3        plymouth satellite
## 5               ford torino
## 6          ford galaxie 500
## 7          chevrolet impala</code></pre>
<p>Second, a function to fit 10 models (1 to 10 polynomial degrees of freedom) on the training set, and evaluate on the validation set with <code>fit_resamples</code>.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="resampling-methods.html#cb339-1" aria-hidden="true" tabindex="-1"></a>auto_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)</span>
<span id="cb339-2"><a href="resampling-methods.html#cb339-2" aria-hidden="true" tabindex="-1"></a>lm_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="fu">add_model</span>(<span class="fu">linear_reg</span>())</span>
<span id="cb339-3"><a href="resampling-methods.html#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="resampling-methods.html#cb339-4" aria-hidden="true" tabindex="-1"></a>evaluate_poly_fits <span class="ot">&lt;-</span> <span class="cf">function</span>(auto_splits) {</span>
<span id="cb339-5"><a href="resampling-methods.html#cb339-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">poly_df =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-6"><a href="resampling-methods.html#cb339-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb339-7"><a href="resampling-methods.html#cb339-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">lm_rec =</span> <span class="fu">map</span>(</span>
<span id="cb339-8"><a href="resampling-methods.html#cb339-8" aria-hidden="true" tabindex="-1"></a>        poly_df, <span class="sc">~</span> auto_rec <span class="sc">%&gt;%</span> <span class="fu">step_poly</span>(horsepower, <span class="at">degree =</span> .x)</span>
<span id="cb339-9"><a href="resampling-methods.html#cb339-9" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb339-10"><a href="resampling-methods.html#cb339-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">lm_fit =</span> <span class="fu">map</span>(</span>
<span id="cb339-11"><a href="resampling-methods.html#cb339-11" aria-hidden="true" tabindex="-1"></a>        lm_rec,</span>
<span id="cb339-12"><a href="resampling-methods.html#cb339-12" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> lm_workflow <span class="sc">%&gt;%</span> <span class="fu">add_recipe</span>(.x) <span class="sc">%&gt;%</span> <span class="fu">fit_resamples</span>(auto_splits)</span>
<span id="cb339-13"><a href="resampling-methods.html#cb339-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb339-14"><a href="resampling-methods.html#cb339-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lm_metrics =</span> <span class="fu">map</span>(lm_fit, collect_metrics)</span>
<span id="cb339-15"><a href="resampling-methods.html#cb339-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb339-16"><a href="resampling-methods.html#cb339-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(lm_metrics) <span class="sc">%&gt;%</span></span>
<span id="cb339-17"><a href="resampling-methods.html#cb339-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rmse&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-18"><a href="resampling-methods.html#cb339-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(poly_df, <span class="at">rmse =</span> mean)</span>
<span id="cb339-19"><a href="resampling-methods.html#cb339-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb339-20"><a href="resampling-methods.html#cb339-20" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation <span class="ot">&lt;-</span> <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb339-21"><a href="resampling-methods.html#cb339-21" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    poly_df  rmse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  5.14
##  2       2  4.46
##  3       3  4.50
##  4       4  4.49
##  5       5  4.39
##  6       6  4.36
##  7       7  4.33
##  8       8  4.33
##  9       9  4.32
## 10      10  4.60</code></pre>
<p>Now reproduce Figure 5.2:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="resampling-methods.html#cb341-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb341-2"><a href="resampling-methods.html#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9 additional sets of fits</span></span>
<span id="cb341-3"><a href="resampling-methods.html#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(</span>
<span id="cb341-4"><a href="resampling-methods.html#cb341-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb341-5"><a href="resampling-methods.html#cb341-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(seed) {</span>
<span id="cb341-6"><a href="resampling-methods.html#cb341-6" aria-hidden="true" tabindex="-1"></a>      auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_validation_split</span>(seed)</span>
<span id="cb341-7"><a href="resampling-methods.html#cb341-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb341-8"><a href="resampling-methods.html#cb341-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb341-9"><a href="resampling-methods.html#cb341-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;rep&quot;</span></span>
<span id="cb341-10"><a href="resampling-methods.html#cb341-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb341-11"><a href="resampling-methods.html#cb341-11" aria-hidden="true" tabindex="-1"></a>  auto_poly_fits_validation <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rep =</span> <span class="st">&quot;10&quot;</span>)</span>
<span id="cb341-12"><a href="resampling-methods.html#cb341-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb341-13"><a href="resampling-methods.html#cb341-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-14"><a href="resampling-methods.html#cb341-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a 10 color palette from the MetBrewer package</span></span>
<span id="cb341-15"><a href="resampling-methods.html#cb341-15" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> MetBrewer<span class="sc">::</span><span class="fu">met.brewer</span>(<span class="st">&quot;Veronese&quot;</span>, <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>)</span>
<span id="cb341-16"><a href="resampling-methods.html#cb341-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-17"><a href="resampling-methods.html#cb341-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> auto_poly_fits_validation <span class="sc">%&gt;%</span></span>
<span id="cb341-18"><a href="resampling-methods.html#cb341-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_df, <span class="at">y =</span> rmse<span class="sc">^</span><span class="dv">2</span>, <span class="at">fill =</span> rep)) <span class="sc">+</span></span>
<span id="cb341-19"><a href="resampling-methods.html#cb341-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> rep), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb341-20"><a href="resampling-methods.html#cb341-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb341-21"><a href="resampling-methods.html#cb341-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb341-22"><a href="resampling-methods.html#cb341-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb341-23"><a href="resampling-methods.html#cb341-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb341-24"><a href="resampling-methods.html#cb341-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Degree of polynomial&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb341-25"><a href="resampling-methods.html#cb341-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb341-26"><a href="resampling-methods.html#cb341-26" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="sc">%+%</span> <span class="fu">filter</span>(auto_poly_fits_validation, rep <span class="sc">==</span> <span class="st">&quot;1&quot;</span>) <span class="sc">+</span></span>
<span id="cb341-27"><a href="resampling-methods.html#cb341-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rep), <span class="at">shape =</span> <span class="dv">21</span>,  <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb341-28"><a href="resampling-methods.html#cb341-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;MSE&quot;</span>)</span>
<span id="cb341-29"><a href="resampling-methods.html#cb341-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.2-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>As is clear from the right-hand panel, this approach is highly variable depending on the testing/validation set split.
Another downside is that, because the training set used to fit the data has fewer observations, it tends to overestimate the test error rate on the entire data set.</p>
</div>
<div id="loocv" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Leave-One-Out Cross Validation</h3>
<p><em>Leave-one-out cross validation</em> (LOOCV) attempts to address the shortcomings of the validation set approach.
It still involves splitting the <span class="math inline">\(n\)</span> observations into two parts, but it repeats it <span class="math inline">\(n\)</span> times, with a single observation <span class="math inline">\((x_i, y_i)\)</span> as the hold-out “set” and the remaining <span class="math inline">\(n-1\)</span> observations as the training set.
The MSE for each iteration is simply <span class="math inline">\(\text{MSE}_i = (y_i - \hat{y}_i)^2\)</span>.
Then the LOOCV estimate of the MSE is the average over all observations:</p>
<p><span class="math display">\[
\text{CV}_{(n)} = \frac{1}{n} \sum_{i=1}^n \text{MSE}_i.
\]</span></p>
<p>The LOOCV approach has a few advantages over the validation set approach:</p>
<blockquote>
<ul>
<li>First, it has far less bias. In LOOCV, we repeatedly fit the statistical learning method using training sets that contain <span class="math inline">\(n − 1\)</span> observations, almost as many as are in the entire data set. This is in contrast to the validation set approach, in which the training set is typically around half the size of the original data set. Consequently, the LOOCV approach tends not to overestimate the test error rate as much as the validation set approach does.</li>
<li>Second, in contrast to the validation approach which will yield different results when applied repeatedly due to randomness in the training/validation set splits, performing LOOCV multiple times will always yield the same results: there is no randomness in the training/validation set splits.</li>
</ul>
</blockquote>
<p>Define a new function to split the data by LOOCV:<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="resampling-methods.html#cb342-1" aria-hidden="true" tabindex="-1"></a>auto_splits <span class="ot">&lt;-</span> <span class="fu">loo_cv</span>(auto)</span>
<span id="cb342-2"><a href="resampling-methods.html#cb342-2" aria-hidden="true" tabindex="-1"></a>auto_splits</span></code></pre></div>
<pre><code>## # Leave-one-out cross-validation 
## # A tibble: 392 x 2
##    splits          id        
##    &lt;list&gt;          &lt;chr&gt;     
##  1 &lt;split [391/1]&gt; Resample1 
##  2 &lt;split [391/1]&gt; Resample2 
##  3 &lt;split [391/1]&gt; Resample3 
##  4 &lt;split [391/1]&gt; Resample4 
##  5 &lt;split [391/1]&gt; Resample5 
##  6 &lt;split [391/1]&gt; Resample6 
##  7 &lt;split [391/1]&gt; Resample7 
##  8 &lt;split [391/1]&gt; Resample8 
##  9 &lt;split [391/1]&gt; Resample9 
## 10 &lt;split [391/1]&gt; Resample10
## # ... with 382 more rows</code></pre>
<p>392 splits, which is the number of observations, as expected.
Fit:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="resampling-methods.html#cb344-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv <span class="ot">&lt;-</span> <span class="fu">evaluate_poly_fits</span>(auto_splits)</span></code></pre></div>
<pre><code>## Error: Problem with `mutate()` column `lm_fit`.
## i `lm_fit = map(lm_rec, ~lm_workflow %&gt;% add_recipe(.x) %&gt;% fit_resamples(auto_splits))`.
## x Leave-one-out cross-validation is not currently supported with tune.</code></pre>
<p>As the error says, LOOCV is not supported.
Here’s an <a href="https://www.tmwr.org/resampling.html#leave-one-out-cross-validation">explanation I found online</a>:</p>
<blockquote>
<p>Leave-one-out methods are deficient compared to almost any other method. For anything but pathologically small samples, LOO is computationally excessive and it may not have good statistical properties. Although rsample contains a <code>loo_cv()</code> function, these objects are not generally integrated into the broader tidymodels frameworks.</p>
</blockquote>
<p>Fair enough.
For completeness, I will still get the LOOCV estimates using <code>boot::cv.glm()</code>:</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="resampling-methods.html#cb346-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb346-2"><a href="resampling-methods.html#cb346-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">poly_df =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb346-3"><a href="resampling-methods.html#cb346-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mse =</span> <span class="fu">map_dbl</span>(poly_df,</span>
<span id="cb346-4"><a href="resampling-methods.html#cb346-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(poly_df) {</span>
<span id="cb346-5"><a href="resampling-methods.html#cb346-5" aria-hidden="true" tabindex="-1"></a>      glm_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, <span class="at">degree =</span> poly_df), <span class="at">data =</span> auto)</span>
<span id="cb346-6"><a href="resampling-methods.html#cb346-6" aria-hidden="true" tabindex="-1"></a>      boot<span class="sc">::</span><span class="fu">cv.glm</span>(auto, glm_fit)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb346-7"><a href="resampling-methods.html#cb346-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb346-8"><a href="resampling-methods.html#cb346-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb346-9"><a href="resampling-methods.html#cb346-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb346-10"><a href="resampling-methods.html#cb346-10" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    poly_df   mse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  24.2
##  2       2  19.2
##  3       3  19.3
##  4       4  19.4
##  5       5  19.0
##  6       6  19.0
##  7       7  18.8
##  8       8  19.0
##  9       9  19.1
## 10      10  19.5</code></pre>
</div>
<div id="kfoldcv" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> <span class="math inline">\(k\)</span>-fold Cross-Validation</h3>
<p><em><span class="math inline">\(k\)</span>-fold CV</em> involves randomly dividing the observations into <span class="math inline">\(k\)</span> groups/folds of approximately equal size.
The first fold is used as the validation/assessment set, and the remaining <span class="math inline">\(k-1\)</span> folds used to fit the model.
This is repeated <span class="math inline">\(k\)</span> times, with each fold being used as the assessment set once.
The <span class="math inline">\(k\)</span>-fold CV estimate of the test error is then the average:</p>
<p><span class="math display">\[
\text{CV}_{(k)} = \frac{1}{k} \sum_{i=1}^k \text{MSE}_i.
\]</span></p>
<p>This should look familiar:</p>
<blockquote>
<p>It is not hard to see that LOOCV is a special case of <span class="math inline">\(k\)</span>-fold CV in which <span class="math inline">\(k\)</span>
is set to equal <span class="math inline">\(n\)</span>. In practice, one typically performs <span class="math inline">\(k\)</span>-fold CV using <span class="math inline">\(k\)</span> = 5
or <span class="math inline">\(k\)</span> = 10. What is the advantage of using <span class="math inline">\(k\)</span> = 5 or <span class="math inline">\(k\)</span> = 10 rather than
<span class="math inline">\(k\)</span> = <span class="math inline">\(n\)</span>? The most obvious advantage is computational. LOOCV requires
fitting the statistical learning method <span class="math inline">\(n\)</span> times. This has the potential to be
computationally expensive (except for linear models fit by least squares,
in which case formula (5.2) can be used). But cross-validation is a very
general approach that can be applied to almost any statistical learning
method. Some statistical learning methods have computationally intensive
fitting procedures, and so performing LOOCV may pose computational
problems, especially if <span class="math inline">\(n\)</span> is extremely large. In contrast, performing 10-fold
CV requires fitting the learning procedure only ten times, which may be
much more feasible. As we see in Section 5.1.4, there also can be other
non-computational advantages to performing 5-fold or 10-fold CV, which
involve the bias-variance trade-off.</p>
</blockquote>
<p>Fit the polynomial models with 10-fold CV:</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="resampling-methods.html#cb348-1" aria-hidden="true" tabindex="-1"></a>auto_10_fold_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb348-2"><a href="resampling-methods.html#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb348-3"><a href="resampling-methods.html#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vfold_cv</span>(auto, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb348-4"><a href="resampling-methods.html#cb348-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb348-5"><a href="resampling-methods.html#cb348-5" aria-hidden="true" tabindex="-1"></a>auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_10_fold_cv</span>(<span class="at">seed =</span> <span class="dv">10</span>)</span>
<span id="cb348-6"><a href="resampling-methods.html#cb348-6" aria-hidden="true" tabindex="-1"></a>auto_splits</span></code></pre></div>
<pre><code>## #  10-fold cross-validation 
## # A tibble: 10 x 2
##    splits           id    
##    &lt;list&gt;           &lt;chr&gt; 
##  1 &lt;split [352/40]&gt; Fold01
##  2 &lt;split [352/40]&gt; Fold02
##  3 &lt;split [353/39]&gt; Fold03
##  4 &lt;split [353/39]&gt; Fold04
##  5 &lt;split [353/39]&gt; Fold05
##  6 &lt;split [353/39]&gt; Fold06
##  7 &lt;split [353/39]&gt; Fold07
##  8 &lt;split [353/39]&gt; Fold08
##  9 &lt;split [353/39]&gt; Fold09
## 10 &lt;split [353/39]&gt; Fold10</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="resampling-methods.html#cb350-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv <span class="ot">&lt;-</span> <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb350-2"><a href="resampling-methods.html#cb350-2" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    poly_df  rmse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  4.90
##  2       2  4.35
##  3       3  4.35
##  4       4  4.37
##  5       5  4.31
##  6       6  4.31
##  7       7  4.28
##  8       8  4.29
##  9       9  4.30
## 10      10  4.37</code></pre>
<p>Now repeat this another 9 times.
Thought it won’t take <em>too</em> long to run, I’ll make use of <code>parallel</code> to speed it up a bit:</p>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## 
## Attaching package: &#39;foreach&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:purrr&#39;:
## 
##     accumulate, when</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="resampling-methods.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb357-2"><a href="resampling-methods.html#cb357-2" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb357-3"><a href="resampling-methods.html#cb357-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9 additional sets of fits</span></span>
<span id="cb357-4"><a href="resampling-methods.html#cb357-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(</span>
<span id="cb357-5"><a href="resampling-methods.html#cb357-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb357-6"><a href="resampling-methods.html#cb357-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(seed) {</span>
<span id="cb357-7"><a href="resampling-methods.html#cb357-7" aria-hidden="true" tabindex="-1"></a>      auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_10_fold_cv</span>(seed)</span>
<span id="cb357-8"><a href="resampling-methods.html#cb357-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb357-9"><a href="resampling-methods.html#cb357-9" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb357-10"><a href="resampling-methods.html#cb357-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;rep&quot;</span></span>
<span id="cb357-11"><a href="resampling-methods.html#cb357-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb357-12"><a href="resampling-methods.html#cb357-12" aria-hidden="true" tabindex="-1"></a>  auto_poly_fits_10_fold_cv <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rep =</span> <span class="st">&quot;10&quot;</span>)</span>
<span id="cb357-13"><a href="resampling-methods.html#cb357-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb357-14"><a href="resampling-methods.html#cb357-14" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 91.87 sec elapsed</code></pre>
<p>Now reproduce Figure 5.4:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="resampling-methods.html#cb359-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> auto_poly_fits_10_fold_cv <span class="sc">%&gt;%</span></span>
<span id="cb359-2"><a href="resampling-methods.html#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mse =</span> rmse<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb359-3"><a href="resampling-methods.html#cb359-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_df, <span class="at">y =</span> mse, <span class="at">fill =</span> rep)) <span class="sc">+</span></span>
<span id="cb359-4"><a href="resampling-methods.html#cb359-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> rep), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb359-5"><a href="resampling-methods.html#cb359-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb359-6"><a href="resampling-methods.html#cb359-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb359-7"><a href="resampling-methods.html#cb359-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb359-8"><a href="resampling-methods.html#cb359-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb359-9"><a href="resampling-methods.html#cb359-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Degree of polynomial&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb359-10"><a href="resampling-methods.html#cb359-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb359-11"><a href="resampling-methods.html#cb359-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="sc">%+%</span> <span class="fu">mutate</span>(auto_poly_fits_loo_cv, <span class="at">rep =</span> <span class="st">&quot;1&quot;</span>) <span class="sc">+</span></span>
<span id="cb359-12"><a href="resampling-methods.html#cb359-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rep), <span class="at">shape =</span> <span class="dv">21</span>,  <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb359-13"><a href="resampling-methods.html#cb359-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;MSE&quot;</span>)</span>
<span id="cb359-14"><a href="resampling-methods.html#cb359-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.4-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <span class="math inline">\(k\)</span>-fold CV approach (right panel) still has some variability due to random splitting, but much less than the validation set approach.</p>
<p>As a reminder, with cross-validation we are trying to approximate the true test MSE, which we cannot know for certain unless the data are simulated (like in Figure 5.6).
The true error value itself is important if we want to know how a model will perform on independent data.
However, if all we care about is parameter(s) that give the minimum error (like the degree of polynomial in these examples), then the CV estimate will usually come close to the true answer.</p>
</div>
<div id="bias-variance-trade-off-for-k-fold-cross-validation" class="section level3" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Bias-Variance Trade-Off for <span class="math inline">\(k\)</span>-Fold Cross-Validation</h3>
<p>In addition to being computationally more efficient than LOOCV, <span class="math inline">\(k\)</span>-fold CV with <span class="math inline">\(k &lt; n\)</span> also often gives more accurate estimates of the test error rate due to the bias-variance tradeoff.</p>
<ul>
<li><span class="math inline">\(k\)</span>-fold CV has moderate bias in comparison to LOOCV, which is approximately unbiased.</li>
<li><span class="math inline">\(k\)</span>-fold CV (average over <span class="math inline">\(k\)</span> fitted models) tends to have lower variance than LOOCV (average over <span class="math inline">\(n\)</span> fitted models, highly correlated with each other).</li>
</ul>
<blockquote>
<p>To summarize, there is a bias-variance trade-off associated with the
choice of <span class="math inline">\(k\)</span> in <span class="math inline">\(k\)</span>-fold cross-validation. Typically, given these considerations,
one performs <span class="math inline">\(k\)</span>-fold cross-validation using <span class="math inline">\(k\)</span> = 5 or <span class="math inline">\(k\)</span> = 10, as these values
have been shown empirically to yield test error rate estimates that suffer
neither from excessively high bias nor from very high variance.</p>
</blockquote>
</div>
<div id="cross-validation-on-classification-problems" class="section level3" number="5.1.5">
<h3><span class="header-section-number">5.1.5</span> Cross-Validation on Classification Problems</h3>
<p>Rather than quantitative <span class="math inline">\(Y\)</span>, cross-validation works just as well with qualitative <span class="math inline">\(Y\)</span>.
Instead of MSE, we use the number of misclassified observations, <span class="math inline">\(\text{Err}_i = I(y_i \neq \hat{y}_i)\)</span>.
The LOOCV error rate:</p>
<p><span class="math display">\[
\text{CV}_{(n)} = \frac{1}{n} \sum_{i=1}^n \text{Err}_i.
\]</span></p>
<p>The <span class="math inline">\(k\)</span>-fold CV and validation set error rates are defined analogously.</p>
</div>
</div>
<div id="bootstrap" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The Bootstrap</h2>
<blockquote>
<p>The <em>bootstrap</em> is a widely applicable and extremely powerful statistical tool that can be used to quantify the uncertainty associated with a given estimator or statistical learning method. As a simple example, the bootstrap can be used to estimate the standard errors of the coefficients from a linear regression fit. In the specific case of linear regression, this is not particularly useful, since we saw in Chapter 3 that standard statistical software such as R outputs such standard errors automatically. However, the power of the bootstrap lies in the fact that it can be easily applied to a wide range of statistical learning methods, including some for which a measure of variability is otherwise difficult to obtain and is not automatically output by
statistical software.</p>
</blockquote>
<p>The toy example in this section is about investment in two assets <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.
We wish to choose a fraction <span class="math inline">\(\alpha\)</span> of investment into <span class="math inline">\(X\)</span> which minimizes the total variance (risk) of the investment.
In can be shown that the optimal value is given by:</p>
<p><span class="math display">\[
\alpha = \frac{\sigma_Y^2 - \sigma_{XY}}{\sigma_X^2 + \sigma_Y^2 - 2\sigma_{XY}},
\]</span></p>
<p>where <span class="math inline">\(\sigma_X^2 = \text{Var}(X)\)</span>, <span class="math inline">\(\sigma_Y^2 = \text{Var}(Y)\)</span>, and <span class="math inline">\(\sigma_{XY} = \text{Cov}(X, Y)\)</span>.
In reality, we don’t know these variances and covariance, so we estimate them (e.g. <span class="math inline">\(\hat{\sigma}_X^2\)</span>) using observations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> to get an estimated <span class="math inline">\(\hat{\alpha}\)</span>.</p>
<p>To illustrate, we simulate 100 pairs of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and compute the estimated <span class="math inline">\(\alpha\)</span>.
The simulation parameters are <span class="math inline">\(\sigma_X^2 = 1\)</span>, <span class="math inline">\(\sigma_Y^2 = 1.25\)</span>, and <span class="math inline">\(\sigma_{XY} = 0.5\)</span>.
Presumably, these are bivariate normally distributed, which I can simulate with the <code>mvtnorm</code> package:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="resampling-methods.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb360-2"><a href="resampling-methods.html#cb360-2" aria-hidden="true" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb360-3"><a href="resampling-methods.html#cb360-3" aria-hidden="true" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">1.25</span>)</span>
<span id="cb360-4"><a href="resampling-methods.html#cb360-4" aria-hidden="true" tabindex="-1"></a>sigma_xy <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb360-5"><a href="resampling-methods.html#cb360-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The variance-covariance matrix</span></span>
<span id="cb360-6"><a href="resampling-methods.html#cb360-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, sigma_xy, sigma_xy, sigma_y<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb360-7"><a href="resampling-methods.html#cb360-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 5 observations</span></span>
<span id="cb360-8"><a href="resampling-methods.html#cb360-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> sigma)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] -0.6198186  0.2723180
## [2,] -0.4510171 -1.4568201
## [3,] -0.0302161 -1.3962636
## [4,] -0.3405990 -0.3004827
## [5,] -0.3552014  1.1948117</code></pre>
<p>Write a function to compute <span class="math inline">\(\alpha\)</span> from the simulated <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="resampling-methods.html#cb362-1" aria-hidden="true" tabindex="-1"></a>sim_alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xy =</span> <span class="cn">NULL</span>) {</span>
<span id="cb362-2"><a href="resampling-methods.html#cb362-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(xy)) {</span>
<span id="cb362-3"><a href="resampling-methods.html#cb362-3" aria-hidden="true" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> sigma)</span>
<span id="cb362-4"><a href="resampling-methods.html#cb362-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb362-5"><a href="resampling-methods.html#cb362-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]; y <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb362-6"><a href="resampling-methods.html#cb362-6" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">var</span>(y) <span class="sc">-</span>  <span class="fu">cov</span>(x, y)) <span class="sc">/</span> (<span class="fu">var</span>(x) <span class="sc">+</span> <span class="fu">var</span>(y) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cov</span>(x, y))</span>
<span id="cb362-7"><a href="resampling-methods.html#cb362-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb362-8"><a href="resampling-methods.html#cb362-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_alpha</span>()</span></code></pre></div>
<pre><code>## [1] 0.577909</code></pre>
<p>Run four simulations and plot <span class="math inline">\(X\)</span> vs <span class="math inline">\(Y\)</span> for Figure 5.9</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="resampling-methods.html#cb364-1" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb364-2"><a href="resampling-methods.html#cb364-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb364-3"><a href="resampling-methods.html#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xy =</span> <span class="fu">list</span>(<span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> sigma))) <span class="sc">%&gt;%</span></span>
<span id="cb364-4"><a href="resampling-methods.html#cb364-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb364-5"><a href="resampling-methods.html#cb364-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">map_dbl</span>(xy, sim_alpha) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb364-6"><a href="resampling-methods.html#cb364-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">map</span>(xy, <span class="sc">~</span> .x[,<span class="dv">1</span>]), <span class="at">y =</span> <span class="fu">map</span>(xy, <span class="sc">~</span> .x[,<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb364-7"><a href="resampling-methods.html#cb364-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(x, y))</span>
<span id="cb364-8"><a href="resampling-methods.html#cb364-8" aria-hidden="true" tabindex="-1"></a>d4 <span class="sc">%&gt;%</span></span>
<span id="cb364-9"><a href="resampling-methods.html#cb364-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb364-10"><a href="resampling-methods.html#cb364-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>emerald, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb364-11"><a href="resampling-methods.html#cb364-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>alpha, <span class="at">labeller =</span> <span class="st">&quot;label_both&quot;</span>) <span class="sc">+</span></span>
<span id="cb364-12"><a href="resampling-methods.html#cb364-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_facet_borders</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.9-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>For Figure 5.10, I first simulate 1000 data sets from the true population and estimate <span class="math inline">\(\alpha\)</span> for each:</p>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="resampling-methods.html#cb365-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb365-2"><a href="resampling-methods.html#cb365-2" aria-hidden="true" tabindex="-1"></a>  d4 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(sim, alpha),</span>
<span id="cb365-3"><a href="resampling-methods.html#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">sim =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb365-4"><a href="resampling-methods.html#cb365-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb365-5"><a href="resampling-methods.html#cb365-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">sim_alpha</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb365-6"><a href="resampling-methods.html#cb365-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb365-7"><a href="resampling-methods.html#cb365-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb365-8"><a href="resampling-methods.html#cb365-8" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 1,000 x 2
##      sim alpha
##    &lt;int&gt; &lt;dbl&gt;
##  1     1 0.392
##  2     2 0.653
##  3     3 0.58 
##  4     4 0.635
##  5     5 0.604
##  6     6 0.680
##  7     7 0.648
##  8     8 0.662
##  9     9 0.674
## 10    10 0.597
## # ... with 990 more rows</code></pre>
<p>And then, using just the first simulated data set, use the <code>rsample::boostraps()</code> function to generate 1000 bootstrap resamples:</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="resampling-methods.html#cb367-1" aria-hidden="true" tabindex="-1"></a>d1_boot <span class="ot">&lt;-</span> d4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sim <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x, y) <span class="sc">%&gt;%</span></span>
<span id="cb367-2"><a href="resampling-methods.html#cb367-2" aria-hidden="true" tabindex="-1"></a>  rsample<span class="sc">::</span><span class="fu">bootstraps</span>(<span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb367-3"><a href="resampling-methods.html#cb367-3" aria-hidden="true" tabindex="-1"></a>d1_boot</span></code></pre></div>
<pre><code>## # Bootstrap sampling 
## # A tibble: 1,000 x 2
##    splits           id           
##    &lt;list&gt;           &lt;chr&gt;        
##  1 &lt;split [100/34]&gt; Bootstrap0001
##  2 &lt;split [100/37]&gt; Bootstrap0002
##  3 &lt;split [100/43]&gt; Bootstrap0003
##  4 &lt;split [100/34]&gt; Bootstrap0004
##  5 &lt;split [100/38]&gt; Bootstrap0005
##  6 &lt;split [100/37]&gt; Bootstrap0006
##  7 &lt;split [100/36]&gt; Bootstrap0007
##  8 &lt;split [100/37]&gt; Bootstrap0008
##  9 &lt;split [100/36]&gt; Bootstrap0009
## 10 &lt;split [100/41]&gt; Bootstrap0010
## # ... with 990 more rows</code></pre>
<p>Compute <span class="math inline">\(\hat{\alpha}\)</span> from each split:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="resampling-methods.html#cb369-1" aria-hidden="true" tabindex="-1"></a>d1_boot_alpha <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb369-2"><a href="resampling-methods.html#cb369-2" aria-hidden="true" tabindex="-1"></a>  d1_boot<span class="sc">$</span>splits,</span>
<span id="cb369-3"><a href="resampling-methods.html#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(split) {</span>
<span id="cb369-4"><a href="resampling-methods.html#cb369-4" aria-hidden="true" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(split)</span>
<span id="cb369-5"><a href="resampling-methods.html#cb369-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sim_alpha</span>(<span class="fu">as.matrix</span>(xy))</span>
<span id="cb369-6"><a href="resampling-methods.html#cb369-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb369-7"><a href="resampling-methods.html#cb369-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb369-8"><a href="resampling-methods.html#cb369-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb369-9"><a href="resampling-methods.html#cb369-9" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">population =</span> <span class="st">&quot;true&quot;</span>),</span>
<span id="cb369-10"><a href="resampling-methods.html#cb369-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">alpha =</span> d1_boot_alpha, <span class="at">population =</span> <span class="st">&quot;bootstrap resamples&quot;</span>)</span>
<span id="cb369-11"><a href="resampling-methods.html#cb369-11" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb369-12"><a href="resampling-methods.html#cb369-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population =</span> <span class="fu">fct_rev</span>(population))</span>
<span id="cb369-13"><a href="resampling-methods.html#cb369-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-14"><a href="resampling-methods.html#cb369-14" aria-hidden="true" tabindex="-1"></a>true_alpha <span class="ot">&lt;-</span> (sigma_y<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> sigma_xy) <span class="sc">/</span> (sigma_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma_y<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> sigma_xy)</span>
<span id="cb369-15"><a href="resampling-methods.html#cb369-15" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb369-16"><a href="resampling-methods.html#cb369-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> alpha, <span class="at">fill =</span> population)) <span class="sc">+</span></span>
<span id="cb369-17"><a href="resampling-methods.html#cb369-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb369-18"><a href="resampling-methods.html#cb369-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> true_alpha,</span>
<span id="cb369-19"><a href="resampling-methods.html#cb369-19" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>light_coral, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb369-20"><a href="resampling-methods.html#cb369-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> population, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb369-21"><a href="resampling-methods.html#cb369-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(td_colors<span class="sc">$</span>nice<span class="sc">$</span>soft_orange,</span>
<span id="cb369-22"><a href="resampling-methods.html#cb369-22" aria-hidden="true" tabindex="-1"></a>                               td_colors<span class="sc">$</span>nice<span class="sc">$</span>strong_blue))</span>
<span id="cb369-23"><a href="resampling-methods.html#cb369-23" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb369-24"><a href="resampling-methods.html#cb369-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> alpha, <span class="at">x =</span> population)) <span class="sc">+</span></span>
<span id="cb369-25"><a href="resampling-methods.html#cb369-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> population), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb369-26"><a href="resampling-methods.html#cb369-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_alpha,</span>
<span id="cb369-27"><a href="resampling-methods.html#cb369-27" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>light_coral, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb369-28"><a href="resampling-methods.html#cb369-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(td_colors<span class="sc">$</span>nice<span class="sc">$</span>soft_orange,</span>
<span id="cb369-29"><a href="resampling-methods.html#cb369-29" aria-hidden="true" tabindex="-1"></a>                               td_colors<span class="sc">$</span>nice<span class="sc">$</span>strong_blue))</span>
<span id="cb369-30"><a href="resampling-methods.html#cb369-30" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-203-1.png" width="576" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Note that the histogram looks very similar to the left-hand panel, which
displays the idealized histogram of the estimates of α obtained by generating 1,000 simulated data sets from the true population. In particular the
bootstrap estimate <span class="math inline">\(\text{SE}(\hat{\alpha})\)</span> from (5.8) is 0.087, very close to the estimate
of 0.083 obtained using 1,000 simulated data sets. The right-hand panel
displays the information in the center and left panels in a different way, via
boxplots of the estimates for <span class="math inline">\(\alpha\)</span> obtained by generating 1,000 simulated data
sets from the true population and using the bootstrap approach. Again, the
boxplots have similar spreads, indicating that the bootstrap approach can
be used to effectively estimate the variability associated with <span class="math inline">\(\hat{\alpha}\)</span>.</p>
</blockquote>
</div>
<div id="lab-cross-validation-and-the-bootstrap" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Lab: Cross-Validation and the Bootstrap</h2>
<div id="the-validation-set-approach" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> The Validation Set Approach</h3>
<p>Here are the MSE values as computed in @ref(#validation-set):</p>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="resampling-methods.html#cb370-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation <span class="sc">%&gt;%</span></span>
<span id="cb370-2"><a href="resampling-methods.html#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(poly_df <span class="sc">&lt;=</span> <span class="dv">3</span>, rep <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="resampling-methods.html#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mse =</span> rmse<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   rep   poly_df  rmse   mse
##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 1           1  4.82  23.3
## 2 1           2  4.33  18.7
## 3 1           3  4.34  18.8</code></pre>
</div>
<div id="leave-one-out-cross-validation" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Leave-One-Out Cross-Validation</h3>
<p>Because LOOCV is deterministic (not random), the process in @ref(#loocv) produces the same MSE values:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="resampling-methods.html#cb372-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    poly_df   mse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  24.2
##  2       2  19.2
##  3       3  19.3
##  4       4  19.4
##  5       5  19.0
##  6       6  19.0
##  7       7  18.8
##  8       8  19.0
##  9       9  19.1
## 10      10  19.5</code></pre>
</div>
<div id="k-fold-cross-validation" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> <span class="math inline">\(k\)</span>-fold Cross-Validation</h3>
<p>The MSE values as computed in @ref{#kfoldcv}:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="resampling-methods.html#cb374-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv <span class="sc">%&gt;%</span></span>
<span id="cb374-2"><a href="resampling-methods.html#cb374-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rep <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb374-3"><a href="resampling-methods.html#cb374-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mse =</span> rmse<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 4
##    rep   poly_df  rmse   mse
##    &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 1           1  4.87  23.7
##  2 1           2  4.31  18.6
##  3 1           3  4.31  18.6
##  4 1           4  4.32  18.7
##  5 1           5  4.28  18.3
##  6 1           6  4.28  18.3
##  7 1           7  4.24  18.0
##  8 1           8  4.26  18.1
##  9 1           9  4.26  18.2
## 10 1          10  4.32  18.7</code></pre>
</div>
<div id="the-bootstrap" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> The Bootstrap</h3>
<div id="estimating-the-accuracy-of-a-statistic-of-interest" class="section level4" number="5.3.4.1">
<h4><span class="header-section-number">5.3.4.1</span> Estimating the Accuracy of a Statistic of Interest</h4>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="resampling-methods.html#cb376-1" aria-hidden="true" tabindex="-1"></a>portfolio <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Portfolio</span>
<span id="cb376-2"><a href="resampling-methods.html#cb376-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(portfolio)</span></code></pre></div>
<pre><code>## Rows: 100
## Columns: 2
## $ X &lt;dbl&gt; -0.89525089, -1.56245433, -0.41708988, 1.04435573, -0.31556841, -1.7~
## $ Y &lt;dbl&gt; -0.2349235, -0.8851760, 0.2718880, -0.7341975, 0.8419834, -2.0371910~</code></pre>
<p>The <code>tidymodels</code> approach to bootstrap estimates, as in @ref{#boostrap}:</p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="resampling-methods.html#cb378-1" aria-hidden="true" tabindex="-1"></a>portfolio_boot <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">bootstraps</span>(portfolio, <span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb378-2"><a href="resampling-methods.html#cb378-2" aria-hidden="true" tabindex="-1"></a>portfolio_boot_alpha <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb378-3"><a href="resampling-methods.html#cb378-3" aria-hidden="true" tabindex="-1"></a>  portfolio_boot<span class="sc">$</span>splits,</span>
<span id="cb378-4"><a href="resampling-methods.html#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(split) {</span>
<span id="cb378-5"><a href="resampling-methods.html#cb378-5" aria-hidden="true" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(split)</span>
<span id="cb378-6"><a href="resampling-methods.html#cb378-6" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">var</span>(xy<span class="sc">$</span>Y) <span class="sc">-</span> <span class="fu">cov</span>(xy<span class="sc">$</span>X, xy<span class="sc">$</span>Y)) <span class="sc">/</span></span>
<span id="cb378-7"><a href="resampling-methods.html#cb378-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">var</span>(xy<span class="sc">$</span>X) <span class="sc">+</span> <span class="fu">var</span>(xy<span class="sc">$</span>Y) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cov</span>(xy<span class="sc">$</span>X, xy<span class="sc">$</span>Y))</span>
<span id="cb378-8"><a href="resampling-methods.html#cb378-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb378-9"><a href="resampling-methods.html#cb378-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb378-10"><a href="resampling-methods.html#cb378-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(portfolio_boot_alpha); <span class="fu">sd</span>(portfolio_boot_alpha)</span></code></pre></div>
<pre><code>## [1] 0.5739259</code></pre>
<pre><code>## [1] 0.09040623</code></pre>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="resampling-methods.html#cb381-1" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> portfolio_boot<span class="sc">$</span>splits[[<span class="dv">1</span>]]</span>
<span id="cb381-2"><a href="resampling-methods.html#cb381-2" aria-hidden="true" tabindex="-1"></a>xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(xy)</span></code></pre></div>
</div>
<div id="estimating-the-accuracy-of-a-regression-model" class="section level4" number="5.3.4.2">
<h4><span class="header-section-number">5.3.4.2</span> Estimating the Accuracy of a Regression Model</h4>
<blockquote>
<p>The bootstrap approach can be used to assess the variability of the coefficient estimates and predictions from a statistical learning method. Here we use the bootstrap approach in order to assess the variability of the estimates for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, the intercept and slope terms for the linear regression model that uses horsepower to predict mpg in the <code>Auto</code> data set. We will compare the estimates obtained using the bootstrap to those obtained using the formulas for <span class="math inline">\(\text{SE}(\hat{\beta}_0)\)</span> and <span class="math inline">\(\text{SE}(\hat{\beta}_1)\)</span> described in Section 3.1.2.</p>
</blockquote>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="resampling-methods.html#cb382-1" aria-hidden="true" tabindex="-1"></a>auto_boot <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">bootstraps</span>(auto, <span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb382-2"><a href="resampling-methods.html#cb382-2" aria-hidden="true" tabindex="-1"></a>auto_boot</span></code></pre></div>
<pre><code>## # Bootstrap sampling 
## # A tibble: 1,000 x 2
##    splits            id           
##    &lt;list&gt;            &lt;chr&gt;        
##  1 &lt;split [392/146]&gt; Bootstrap0001
##  2 &lt;split [392/154]&gt; Bootstrap0002
##  3 &lt;split [392/140]&gt; Bootstrap0003
##  4 &lt;split [392/148]&gt; Bootstrap0004
##  5 &lt;split [392/129]&gt; Bootstrap0005
##  6 &lt;split [392/143]&gt; Bootstrap0006
##  7 &lt;split [392/140]&gt; Bootstrap0007
##  8 &lt;split [392/143]&gt; Bootstrap0008
##  9 &lt;split [392/142]&gt; Bootstrap0009
## 10 &lt;split [392/140]&gt; Bootstrap0010
## # ... with 990 more rows</code></pre>
<p>By default, the <code>tune::fit_resamples()</code> function does not keep the model object from each fit.
Usually, all we care about is the performance metrics and (if we’re tuning) the best hyper parameters.
So in order to get the actual regression coefficients, I need to provide a <code>control_grid()</code> object to the <code>control</code> argument of <code>fit_resamples()</code> (see <a href="https://www.tidymodels.org/learn/models/coefficients">this article for more explanation</a>:</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="resampling-methods.html#cb384-1" aria-hidden="true" tabindex="-1"></a>get_lm_coefs <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb384-2"><a href="resampling-methods.html#cb384-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb384-3"><a href="resampling-methods.html#cb384-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb384-4"><a href="resampling-methods.html#cb384-4" aria-hidden="true" tabindex="-1"></a>tidy_ctrl <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">extract =</span> get_lm_coefs)</span></code></pre></div>
<p>Now fit the resamples with this with control object:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="resampling-methods.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb385-2"><a href="resampling-methods.html#cb385-2" aria-hidden="true" tabindex="-1"></a>auto_boot_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb385-3"><a href="resampling-methods.html#cb385-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb385-4"><a href="resampling-methods.html#cb385-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(<span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)) <span class="sc">%&gt;%</span></span>
<span id="cb385-5"><a href="resampling-methods.html#cb385-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(auto_boot, <span class="at">control =</span> tidy_ctrl)</span>
<span id="cb385-6"><a href="resampling-methods.html#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 81.84 sec elapsed</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="resampling-methods.html#cb387-1" aria-hidden="true" tabindex="-1"></a>auto_boot_fit</span></code></pre></div>
<pre><code>## # Resampling results
## # Bootstrap sampling 
## # A tibble: 1,000 x 5
##    splits            id            .metrics         .notes           .extracts  
##    &lt;list&gt;            &lt;chr&gt;         &lt;list&gt;           &lt;list&gt;           &lt;list&gt;     
##  1 &lt;split [392/146]&gt; Bootstrap0001 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  2 &lt;split [392/154]&gt; Bootstrap0002 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  3 &lt;split [392/140]&gt; Bootstrap0003 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  4 &lt;split [392/148]&gt; Bootstrap0004 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  5 &lt;split [392/129]&gt; Bootstrap0005 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  6 &lt;split [392/143]&gt; Bootstrap0006 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  7 &lt;split [392/140]&gt; Bootstrap0007 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  8 &lt;split [392/143]&gt; Bootstrap0008 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
##  9 &lt;split [392/142]&gt; Bootstrap0009 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
## 10 &lt;split [392/140]&gt; Bootstrap0010 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1~
## # ... with 990 more rows</code></pre>
<p>The <code>.extracts</code> column contains the tidy model objects.
It is a but clunky to work with – it is a list column with a list of tibbles, so requires <code>tidyr::unnest()</code> twice:</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="resampling-methods.html#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A single `.extracts` element, which contains a tibble</span></span>
<span id="cb389-2"><a href="resampling-methods.html#cb389-2" aria-hidden="true" tabindex="-1"></a>auto_boot_fit<span class="sc">$</span>.extracts[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   .extracts        .config             
##   &lt;list&gt;           &lt;chr&gt;               
## 1 &lt;tibble [2 x 5]&gt; Preprocessor1_Model1</code></pre>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="resampling-methods.html#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using `unnest` to get all `.extracts`</span></span>
<span id="cb391-2"><a href="resampling-methods.html#cb391-2" aria-hidden="true" tabindex="-1"></a>auto_boot_fit_coefs <span class="ot">&lt;-</span> auto_boot_fit <span class="sc">%&gt;%</span></span>
<span id="cb391-3"><a href="resampling-methods.html#cb391-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb391-4"><a href="resampling-methods.html#cb391-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb391-5"><a href="resampling-methods.html#cb391-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, term, estimate, std.error)</span>
<span id="cb391-6"><a href="resampling-methods.html#cb391-6" aria-hidden="true" tabindex="-1"></a>auto_boot_fit_coefs</span></code></pre></div>
<pre><code>## # A tibble: 2,000 x 4
##    id            term        estimate std.error
##    &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
##  1 Bootstrap0001 (Intercept)   41.7     0.734  
##  2 Bootstrap0001 horsepower    -0.174   0.00655
##  3 Bootstrap0002 (Intercept)   39.3     0.683  
##  4 Bootstrap0002 horsepower    -0.153   0.00620
##  5 Bootstrap0003 (Intercept)   39.3     0.703  
##  6 Bootstrap0003 horsepower    -0.153   0.00624
##  7 Bootstrap0004 (Intercept)   39.4     0.738  
##  8 Bootstrap0004 horsepower    -0.154   0.00667
##  9 Bootstrap0005 (Intercept)   38.1     0.698  
## 10 Bootstrap0005 horsepower    -0.144   0.00617
## # ... with 1,990 more rows</code></pre>
<p>Then taking the mean of the estimates, and applying equation 5.8 to get the standard error:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="resampling-methods.html#cb393-1" aria-hidden="true" tabindex="-1"></a>auto_boot_fit_coefs <span class="sc">%&gt;%</span></span>
<span id="cb393-2"><a href="resampling-methods.html#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb393-3"><a href="resampling-methods.html#cb393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb393-4"><a href="resampling-methods.html#cb393-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_estimate =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb393-5"><a href="resampling-methods.html#cb393-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_estimate =</span> <span class="fu">sqrt</span>(</span>
<span id="cb393-6"><a href="resampling-methods.html#cb393-6" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">/</span> (<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>((estimate <span class="sc">-</span> mean_estimate)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb393-7"><a href="resampling-methods.html#cb393-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb393-8"><a href="resampling-methods.html#cb393-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb393-9"><a href="resampling-methods.html#cb393-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb393-10"><a href="resampling-methods.html#cb393-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb393-11"><a href="resampling-methods.html#cb393-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="xqmmecrbyi" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xqmmecrbyi .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xqmmecrbyi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xqmmecrbyi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xqmmecrbyi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xqmmecrbyi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xqmmecrbyi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xqmmecrbyi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xqmmecrbyi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xqmmecrbyi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xqmmecrbyi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xqmmecrbyi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xqmmecrbyi .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xqmmecrbyi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xqmmecrbyi .gt_from_md > :first-child {
  margin-top: 0;
}

#xqmmecrbyi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xqmmecrbyi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xqmmecrbyi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#xqmmecrbyi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xqmmecrbyi .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#xqmmecrbyi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xqmmecrbyi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xqmmecrbyi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xqmmecrbyi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xqmmecrbyi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xqmmecrbyi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#xqmmecrbyi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xqmmecrbyi .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#xqmmecrbyi .gt_left {
  text-align: left;
}

#xqmmecrbyi .gt_center {
  text-align: center;
}

#xqmmecrbyi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xqmmecrbyi .gt_font_normal {
  font-weight: normal;
}

#xqmmecrbyi .gt_font_bold {
  font-weight: bold;
}

#xqmmecrbyi .gt_font_italic {
  font-style: italic;
}

#xqmmecrbyi .gt_super {
  font-size: 65%;
}

#xqmmecrbyi .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">39.9594</td>
<td class="gt_row gt_right">0.8563</td></tr>
    <tr><td class="gt_row gt_left">horsepower</td>
<td class="gt_row gt_right">&minus;0.1582</td>
<td class="gt_row gt_right">0.0074</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Not exactly the same as those in the text due to the difference in the random bootstrap samples.
And here are the SE estimates using the formula from section 3.1.2:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="resampling-methods.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)) <span class="sc">%&gt;%</span></span>
<span id="cb394-2"><a href="resampling-methods.html#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se_estimate =</span> std.error) <span class="sc">%&gt;%</span></span>
<span id="cb394-3"><a href="resampling-methods.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb394-4"><a href="resampling-methods.html#cb394-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="bbneihskdr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#bbneihskdr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bbneihskdr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bbneihskdr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bbneihskdr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bbneihskdr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bbneihskdr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bbneihskdr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bbneihskdr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bbneihskdr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bbneihskdr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bbneihskdr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bbneihskdr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#bbneihskdr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bbneihskdr .gt_from_md > :first-child {
  margin-top: 0;
}

#bbneihskdr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bbneihskdr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bbneihskdr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#bbneihskdr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bbneihskdr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#bbneihskdr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bbneihskdr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bbneihskdr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bbneihskdr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bbneihskdr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bbneihskdr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#bbneihskdr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bbneihskdr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#bbneihskdr .gt_left {
  text-align: left;
}

#bbneihskdr .gt_center {
  text-align: center;
}

#bbneihskdr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bbneihskdr .gt_font_normal {
  font-weight: normal;
}

#bbneihskdr .gt_font_bold {
  font-weight: bold;
}

#bbneihskdr .gt_font_italic {
  font-style: italic;
}

#bbneihskdr .gt_super {
  font-size: 65%;
}

#bbneihskdr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">39.9359</td>
<td class="gt_row gt_right">0.7175</td></tr>
    <tr><td class="gt_row gt_left">horsepower</td>
<td class="gt_row gt_right">&minus;0.1578</td>
<td class="gt_row gt_right">0.0064</td></tr>
  </tbody>
  
  
</table>
</div>
<p>There are quite different to the bootstrap estimates.</p>
<blockquote>
<p>Does this indicate a problem with the bootstrap? In fact, it suggests the opposite. Recall that the standard formulas given in Equation 3.8 on page 66 rely on certain assumptions. For example, they depend on the unknown parameter <span class="math inline">\(\sigma^2\)</span>, the noise variance. We then estimate <span class="math inline">\(\sigma^2\)</span> using the RSS. Now although the formulas for the standard errors do not rely on the linear model being correct, the estimate for <span class="math inline">\(\sigma^2\)</span> does. We see in
Figure 3.8 on page 91 that there is a non-linear relationship in the data, and so the residuals from a linear fit will be inflated, and so will <span class="math inline">\(\hat{\sigma}^2\)</span>. Secondly, the standard formulas assume (somewhat unrealistically) that the <span class="math inline">\(x_i\)</span> are fixed, and all the variability comes from the variation in the errors <span class="math inline">\(\epsilon_i\)</span>. The bootstrap approach does not rely on any of these assumptions, and so it is likely giving a more accurate estimate of the standard errors of <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> than is the <code>summary()</code> function.</p>
</blockquote>
<p>We can find better correspondence between bootstrap and regression estimates if we use the quadratic model because it better fits the data:</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="resampling-methods.html#cb395-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb395-2"><a href="resampling-methods.html#cb395-2" aria-hidden="true" tabindex="-1"></a>auto_boot_quad_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb395-3"><a href="resampling-methods.html#cb395-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb395-4"><a href="resampling-methods.html#cb395-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(</span>
<span id="cb395-5"><a href="resampling-methods.html#cb395-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto) <span class="sc">%&gt;%</span></span>
<span id="cb395-6"><a href="resampling-methods.html#cb395-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Need to set `raw` = TRUE to not use orthogonal polynomials</span></span>
<span id="cb395-7"><a href="resampling-methods.html#cb395-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">step_poly</span>(horsepower, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">raw =</span> <span class="cn">TRUE</span>))</span>
<span id="cb395-8"><a href="resampling-methods.html#cb395-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb395-9"><a href="resampling-methods.html#cb395-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(auto_boot, <span class="at">control =</span> tidy_ctrl)</span>
<span id="cb395-10"><a href="resampling-methods.html#cb395-10" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 87.42 sec elapsed</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="resampling-methods.html#cb397-1" aria-hidden="true" tabindex="-1"></a>auto_boot_quad_fit <span class="sc">%&gt;%</span></span>
<span id="cb397-2"><a href="resampling-methods.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb397-3"><a href="resampling-methods.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb397-4"><a href="resampling-methods.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb397-5"><a href="resampling-methods.html#cb397-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb397-6"><a href="resampling-methods.html#cb397-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_estimate =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb397-7"><a href="resampling-methods.html#cb397-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_estimate =</span> <span class="fu">sqrt</span>(</span>
<span id="cb397-8"><a href="resampling-methods.html#cb397-8" aria-hidden="true" tabindex="-1"></a>      (<span class="dv">1</span> <span class="sc">/</span> (<span class="fu">n</span>() <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">sum</span>((estimate <span class="sc">-</span> mean_estimate)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb397-9"><a href="resampling-methods.html#cb397-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb397-10"><a href="resampling-methods.html#cb397-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb397-11"><a href="resampling-methods.html#cb397-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb397-12"><a href="resampling-methods.html#cb397-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb397-13"><a href="resampling-methods.html#cb397-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="yttrklbnrs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#yttrklbnrs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yttrklbnrs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yttrklbnrs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yttrklbnrs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yttrklbnrs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yttrklbnrs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yttrklbnrs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yttrklbnrs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yttrklbnrs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yttrklbnrs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yttrklbnrs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yttrklbnrs .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#yttrklbnrs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yttrklbnrs .gt_from_md > :first-child {
  margin-top: 0;
}

#yttrklbnrs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yttrklbnrs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yttrklbnrs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#yttrklbnrs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yttrklbnrs .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#yttrklbnrs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yttrklbnrs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yttrklbnrs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yttrklbnrs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yttrklbnrs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yttrklbnrs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#yttrklbnrs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yttrklbnrs .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#yttrklbnrs .gt_left {
  text-align: left;
}

#yttrklbnrs .gt_center {
  text-align: center;
}

#yttrklbnrs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yttrklbnrs .gt_font_normal {
  font-weight: normal;
}

#yttrklbnrs .gt_font_bold {
  font-weight: bold;
}

#yttrklbnrs .gt_font_italic {
  font-style: italic;
}

#yttrklbnrs .gt_super {
  font-size: 65%;
}

#yttrklbnrs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">56.9224</td>
<td class="gt_row gt_right">2.1379</td></tr>
    <tr><td class="gt_row gt_left">horsepower_poly_1</td>
<td class="gt_row gt_right">&minus;0.4667</td>
<td class="gt_row gt_right">0.0341</td></tr>
    <tr><td class="gt_row gt_left">horsepower_poly_2</td>
<td class="gt_row gt_right">0.0012</td>
<td class="gt_row gt_right">0.0001</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="resampling-methods.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to set `raw` = TRUE to not use orthogonal polynomials</span></span>
<span id="cb398-2"><a href="resampling-methods.html#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> auto)) <span class="sc">%&gt;%</span></span>
<span id="cb398-3"><a href="resampling-methods.html#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se_estimate =</span> std.error) <span class="sc">%&gt;%</span></span>
<span id="cb398-4"><a href="resampling-methods.html#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb398-5"><a href="resampling-methods.html#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="iyennmwejz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#iyennmwejz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#iyennmwejz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iyennmwejz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#iyennmwejz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#iyennmwejz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iyennmwejz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#iyennmwejz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#iyennmwejz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#iyennmwejz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#iyennmwejz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#iyennmwejz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#iyennmwejz .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#iyennmwejz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#iyennmwejz .gt_from_md > :first-child {
  margin-top: 0;
}

#iyennmwejz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#iyennmwejz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#iyennmwejz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#iyennmwejz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iyennmwejz .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#iyennmwejz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#iyennmwejz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#iyennmwejz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#iyennmwejz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#iyennmwejz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iyennmwejz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#iyennmwejz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#iyennmwejz .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#iyennmwejz .gt_left {
  text-align: left;
}

#iyennmwejz .gt_center {
  text-align: center;
}

#iyennmwejz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#iyennmwejz .gt_font_normal {
  font-weight: normal;
}

#iyennmwejz .gt_font_bold {
  font-weight: bold;
}

#iyennmwejz .gt_font_italic {
  font-style: italic;
}

#iyennmwejz .gt_super {
  font-size: 65%;
}

#iyennmwejz .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">56.9001</td>
<td class="gt_row gt_right">1.8004</td></tr>
    <tr><td class="gt_row gt_left">poly(horsepower, 2, raw = TRUE)1</td>
<td class="gt_row gt_right">&minus;0.4662</td>
<td class="gt_row gt_right">0.0311</td></tr>
    <tr><td class="gt_row gt_left">poly(horsepower, 2, raw = TRUE)2</td>
<td class="gt_row gt_right">0.0012</td>
<td class="gt_row gt_right">0.0001</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="exercises-2" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Exercises</h2>
<div id="applied-2" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Applied</h3>
<div id="logistic-regression-with-default" class="section level4" number="5.4.1.1">
<h4><span class="header-section-number">5.4.1.1</span> 5. Logistic regression with <code>default</code></h4>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="resampling-methods.html#cb399-1" aria-hidden="true" tabindex="-1"></a>default <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Default</span></code></pre></div>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em><span class="nocase">The Elements of Statistical Learning</span></em>. Springer Series in Statistics. New York, NY: Springer New York. <a href="https://doi.org/10.1007/978-0-387-84858-7">https://doi.org/10.1007/978-0-387-84858-7</a>.
</div>
<div class="csl-entry">
Smith, Gary. 2018. <span>“<span class="nocase">Step away from stepwise</span>.”</span> <em>Journal of Big Data</em> 5 (1): 32. <a href="https://doi.org/10.1186/s40537-018-0143-6">https://doi.org/10.1186/s40537-018-0143-6</a>.
</div>
</div>
</div>
</div>
</div>
</div>







<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>In the text, they compute the MSE but here I am computing RMSE then squaring it. This is because <code>yardstick</code> has a <code>rmse()</code> function but not an <code>mse()</code> function. If I wanted to, I could define a custom metric <a href="https://yardstick.tidymodels.org/articles/custom-metrics.html">like this</a>.<a href="resampling-methods.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Since there is no random splitting with this approach, I don’t need use a function that sets the random seed.<a href="resampling-methods.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="classification.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
