<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Resampling Methods | An Introduction to Statistical Learning with the tidyverse and tidymodels</title>
  <meta name="description" content="Working through ISLR with the tidyverse and tidymodels" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Resampling Methods | An Introduction to Statistical Learning with the tidyverse and tidymodels" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Working through ISLR with the tidyverse and tidymodels" />
  <meta name="github-repo" content="taylordunn/islr-tidy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Resampling Methods | An Introduction to Statistical Learning with the tidyverse and tidymodels" />
  
  <meta name="twitter:description" content="Working through ISLR with the tidyverse and tidymodels" />
  

<meta name="author" content="Taylor Dunn" />


<meta name="date" content="2022-06-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="classification.html"/>
<link rel="next" href="linear-model-selection-and-regularization.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Who, what, and why?</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#an-overview-of-statistical-learning"><i class="fa fa-check"></i>An Overview of Statistical Learning</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#wage-data"><i class="fa fa-check"></i>Wage Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#a-brief-history-of-statistical-learning"><i class="fa fa-check"></i>A Brief History of Statistical Learning</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#this-book"><i class="fa fa-check"></i>This Book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-learning.html"><a href="statistical-learning.html"><i class="fa fa-check"></i><b>2</b> Statistical Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#what-is-statistical-learning"><i class="fa fa-check"></i><b>2.1</b> What Is Statistical Learning?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-learning.html"><a href="statistical-learning.html#why-estimate-f"><i class="fa fa-check"></i><b>2.1.1</b> Why Estimate <span class="math inline">\(f\)</span>?</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-learning.html"><a href="statistical-learning.html#how-do-we-estimate-f"><i class="fa fa-check"></i><b>2.1.2</b> How Do We Estimate f?</a></li>
<li class="chapter" data-level="2.1.3" data-path="statistical-learning.html"><a href="statistical-learning.html#the-trade-off-between-prediction-accuracy-and-model-interpretability"><i class="fa fa-check"></i><b>2.1.3</b> The Trade-Off Between Prediction Accuracy and Model Interpretability</a></li>
<li class="chapter" data-level="2.1.4" data-path="statistical-learning.html"><a href="statistical-learning.html#supervised-versus-unsupervised-learning"><i class="fa fa-check"></i><b>2.1.4</b> Supervised Versus Unsupervised Learning</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#assessing-model-accuracy"><i class="fa fa-check"></i><b>2.2</b> Assessing Model Accuracy</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#measuring-the-quality-of-fit"><i class="fa fa-check"></i><b>2.2.1</b> Measuring the Quality of Fit</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#the-bias-variance-trade-off"><i class="fa fa-check"></i><b>2.2.2</b> The Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="2.2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#the-classification-setting"><i class="fa fa-check"></i><b>2.2.3</b> The Classification Setting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#lab-introduction-to-r"><i class="fa fa-check"></i><b>2.3</b> Lab: Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>3.1.1</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-coefficient-estimates"><i class="fa fa-check"></i><b>3.1.2</b> Assessing the Accuracy of the Coefficient Estimates</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-model"><i class="fa fa-check"></i><b>3.1.3</b> Assessing the Accuracy of the Model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>3.2</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-regression-coefficients"><i class="fa fa-check"></i><b>3.2.1</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#some-important-questions"><i class="fa fa-check"></i><b>3.2.2</b> Some Important Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#other-considerations-in-the-regression-model"><i class="fa fa-check"></i><b>3.3</b> Other Considerations in the Regression Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="linear-regression.html"><a href="linear-regression.html#qualitative-predictors"><i class="fa fa-check"></i><b>3.3.1</b> Qualitative Predictors</a></li>
<li class="chapter" data-level="3.3.2" data-path="linear-regression.html"><a href="linear-regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>3.3.2</b> Extensions of the Linear Model</a></li>
<li class="chapter" data-level="3.3.3" data-path="linear-regression.html"><a href="linear-regression.html#potential-problems"><i class="fa fa-check"></i><b>3.3.3</b> Potential Problems</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="linear-regression.html"><a href="linear-regression.html#the-marketing-plan"><i class="fa fa-check"></i><b>3.4</b> The Marketing Plan</a></li>
<li class="chapter" data-level="3.5" data-path="linear-regression.html"><a href="linear-regression.html#comparison-of-linear-regression-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>3.5</b> Comparison of Linear Regression with <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="3.6" data-path="linear-regression.html"><a href="linear-regression.html#lab-linear-regression"><i class="fa fa-check"></i><b>3.6</b> Lab: Linear Regression</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="linear-regression.html"><a href="linear-regression.html#libraries"><i class="fa fa-check"></i><b>3.6.1</b> Libraries</a></li>
<li class="chapter" data-level="3.6.2" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="3.6.3" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.3</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="3.6.4" data-path="linear-regression.html"><a href="linear-regression.html#interaction-terms"><i class="fa fa-check"></i><b>3.6.4</b> Interaction Terms</a></li>
<li class="chapter" data-level="3.6.5" data-path="linear-regression.html"><a href="linear-regression.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>3.6.5</b> Non-linear Transformations of the Predictors</a></li>
<li class="chapter" data-level="3.6.6" data-path="linear-regression.html"><a href="linear-regression.html#qualitative-predictors-1"><i class="fa fa-check"></i><b>3.6.6</b> Qualitative Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="linear-regression.html"><a href="linear-regression.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#applied"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>4</b> Classification</a>
<ul>
<li class="chapter" data-level="4.1" data-path="classification.html"><a href="classification.html#an-overview-of-classification"><i class="fa fa-check"></i><b>4.1</b> An Overview of Classification</a></li>
<li class="chapter" data-level="4.2" data-path="classification.html"><a href="classification.html#why-not-linear-regression"><i class="fa fa-check"></i><b>4.2</b> Why Not Linear Regression?</a></li>
<li class="chapter" data-level="4.3" data-path="classification.html"><a href="classification.html#logistic-regression"><i class="fa fa-check"></i><b>4.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="classification.html"><a href="classification.html#the-logistic-model"><i class="fa fa-check"></i><b>4.3.1</b> The Logistic Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="classification.html"><a href="classification.html#estimating-the-regression-coefficients-1"><i class="fa fa-check"></i><b>4.3.2</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="4.3.3" data-path="classification.html"><a href="classification.html#making-predictions"><i class="fa fa-check"></i><b>4.3.3</b> Making Predictions</a></li>
<li class="chapter" data-level="4.3.4" data-path="classification.html"><a href="classification.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>4.3.4</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="classification.html"><a href="classification.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>4.3.5</b> Multinomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="classification.html"><a href="classification.html#generative-models-for-classification"><i class="fa fa-check"></i><b>4.4</b> Generative Models for Classification</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis-for-p-1"><i class="fa fa-check"></i><b>4.4.1</b> Linear Discriminant Analysis for <span class="math inline">\(p = 1\)</span></a></li>
<li class="chapter" data-level="4.4.2" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis-for-p-1-1"><i class="fa fa-check"></i><b>4.4.2</b> Linear Discriminant Analysis for <span class="math inline">\(p &gt; 1\)</span></a></li>
<li class="chapter" data-level="4.4.3" data-path="classification.html"><a href="classification.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>4.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="4.4.4" data-path="classification.html"><a href="classification.html#naive-bayes"><i class="fa fa-check"></i><b>4.4.4</b> Naive Bayes</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="classification.html"><a href="classification.html#a-comparison-of-classification-methods"><i class="fa fa-check"></i><b>4.5</b> A Comparison of Classification Methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="classification.html"><a href="classification.html#an-analytical-comparison"><i class="fa fa-check"></i><b>4.5.1</b> An Analytical Comparison</a></li>
<li class="chapter" data-level="4.5.2" data-path="classification.html"><a href="classification.html#an-empirical-comparison"><i class="fa fa-check"></i><b>4.5.2</b> An Empirical Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="classification.html"><a href="classification.html#generalized-linear-models"><i class="fa fa-check"></i><b>4.6</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="classification.html"><a href="classification.html#linear-regression-on-the-bikeshare-data"><i class="fa fa-check"></i><b>4.6.1</b> Linear Regression on the Bikeshare Data</a></li>
<li class="chapter" data-level="4.6.2" data-path="classification.html"><a href="classification.html#poisson-regression-on-bikeshare-data"><i class="fa fa-check"></i><b>4.6.2</b> Poisson Regression on Bikeshare Data</a></li>
<li class="chapter" data-level="4.6.3" data-path="classification.html"><a href="classification.html#generalized-linear-models-in-greater-generality"><i class="fa fa-check"></i><b>4.6.3</b> Generalized Linear Models in Greater Generality</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="classification.html"><a href="classification.html#lab-classification-methods"><i class="fa fa-check"></i><b>4.7</b> Lab: Classification Methods</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="classification.html"><a href="classification.html#the-stock-market-data"><i class="fa fa-check"></i><b>4.7.1</b> The Stock Market Data</a></li>
<li class="chapter" data-level="4.7.2" data-path="classification.html"><a href="classification.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.7.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="4.7.3" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>4.7.3</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="4.7.4" data-path="classification.html"><a href="classification.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>4.7.4</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="4.7.5" data-path="classification.html"><a href="classification.html#naive-bayes-1"><i class="fa fa-check"></i><b>4.7.5</b> Naive Bayes</a></li>
<li class="chapter" data-level="4.7.6" data-path="classification.html"><a href="classification.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>4.7.6</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="4.7.7" data-path="classification.html"><a href="classification.html#poisson-regression"><i class="fa fa-check"></i><b>4.7.7</b> Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="classification.html"><a href="classification.html#exercises-1"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#applied-1"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#reproducibility-1"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>5</b> Resampling Methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation"><i class="fa fa-check"></i><b>5.1</b> Cross Validation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#validation-set"><i class="fa fa-check"></i><b>5.1.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="5.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#loocv"><i class="fa fa-check"></i><b>5.1.2</b> Leave-One-Out Cross Validation</a></li>
<li class="chapter" data-level="5.1.3" data-path="resampling-methods.html"><a href="resampling-methods.html#kfoldcv"><i class="fa fa-check"></i><b>5.1.3</b> <span class="math inline">\(k\)</span>-fold Cross-Validation</a></li>
<li class="chapter" data-level="5.1.4" data-path="resampling-methods.html"><a href="resampling-methods.html#bias-variance-trade-off-for-k-fold-cross-validation"><i class="fa fa-check"></i><b>5.1.4</b> Bias-Variance Trade-Off for <span class="math inline">\(k\)</span>-Fold Cross-Validation</a></li>
<li class="chapter" data-level="5.1.5" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation-on-classification-problems"><i class="fa fa-check"></i><b>5.1.5</b> Cross-Validation on Classification Problems</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap-lab"><i class="fa fa-check"></i><b>5.2</b> The Bootstrap</a></li>
<li class="chapter" data-level="5.3" data-path="resampling-methods.html"><a href="resampling-methods.html#lab-cross-validation-and-the-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Lab: Cross-Validation and the Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="resampling-methods.html"><a href="resampling-methods.html#the-validation-set-approach"><i class="fa fa-check"></i><b>5.3.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="5.3.2" data-path="resampling-methods.html"><a href="resampling-methods.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>5.3.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="5.3.3" data-path="resampling-methods.html"><a href="resampling-methods.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>5.3.3</b> <span class="math inline">\(k\)</span>-fold Cross-Validation</a></li>
<li class="chapter" data-level="5.3.4" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap"><i class="fa fa-check"></i><b>5.3.4</b> The Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="resampling-methods.html"><a href="resampling-methods.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="resampling-methods.html"><a href="resampling-methods.html#applied-2"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="resampling-methods.html"><a href="resampling-methods.html#reproducibility-2"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html"><i class="fa fa-check"></i><b>6</b> Linear Model Selection and Regularization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#subset-selection"><i class="fa fa-check"></i><b>6.1</b> Subset Selection</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#best-subset-selection"><i class="fa fa-check"></i><b>6.1.1</b> Best Subset Selection</a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#stepwise-selection"><i class="fa fa-check"></i><b>6.1.2</b> Stepwise Selection</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#choosing-the-optimal-model"><i class="fa fa-check"></i><b>6.1.3</b> Choosing the Optimal Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#shrinkage-methods"><i class="fa fa-check"></i><b>6.2</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#ridge-regression"><i class="fa fa-check"></i><b>6.2.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso"><i class="fa fa-check"></i><b>6.2.2</b> The Lasso</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#selecting-the-tuning-parameter"><i class="fa fa-check"></i><b>6.2.3</b> Selecting the Tuning Parameter</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#dimension-reduction-methods"><i class="fa fa-check"></i><b>6.3</b> Dimension Reduction Methods</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#principal-components-regression"><i class="fa fa-check"></i><b>6.3.1</b> Principal Components Regression</a></li>
<li class="chapter" data-level="6.3.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#partial-least-squares"><i class="fa fa-check"></i><b>6.3.2</b> Partial Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#considerations-in-high-dimensions"><i class="fa fa-check"></i><b>6.4</b> Considerations in High Dimensions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#high-dimensional-data"><i class="fa fa-check"></i><b>6.4.1</b> High-Dimensional Data</a></li>
<li class="chapter" data-level="6.4.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#what-goes-wrong-in-high-dimensions"><i class="fa fa-check"></i><b>6.4.2</b> What Goes Wrong in High Dimensions?</a></li>
<li class="chapter" data-level="6.4.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#regression-in-high-dimensions"><i class="fa fa-check"></i><b>6.4.3</b> Regression in High Dimensions</a></li>
<li class="chapter" data-level="6.4.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#interpreting-results-in-high-dimensions"><i class="fa fa-check"></i><b>6.4.4</b> Interpreting Results in High Dimensions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#lab-linear-models-and-regularization-methods"><i class="fa fa-check"></i><b>6.5</b> Lab: Linear Models and Regularization Methods</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#subset-selection-methods"><i class="fa fa-check"></i><b>6.5.1</b> Subset Selection Methods</a></li>
<li class="chapter" data-level="6.5.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#ridge-regression-and-the-lasso"><i class="fa fa-check"></i><b>6.5.2</b> Ridge Regression and the Lasso</a></li>
<li class="chapter" data-level="6.5.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#pcr-and-pls-regression"><i class="fa fa-check"></i><b>6.5.3</b> PCR and PLS Regression</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#applied-3"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#reproducibility-3"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html"><i class="fa fa-check"></i><b>7</b> Moving Beyond Linearity</a>
<ul>
<li class="chapter" data-level="7.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#polynomial-regression"><i class="fa fa-check"></i><b>7.1</b> Polynomial Regression</a></li>
<li class="chapter" data-level="7.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#step-functions"><i class="fa fa-check"></i><b>7.2</b> Step Functions</a></li>
<li class="chapter" data-level="7.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#basis-functions"><i class="fa fa-check"></i><b>7.3</b> Basis Functions</a></li>
<li class="chapter" data-level="7.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#regression-splines"><i class="fa fa-check"></i><b>7.4</b> Regression Splines</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#piecewise-polynomials"><i class="fa fa-check"></i><b>7.4.1</b> Piecewise Polynomials</a></li>
<li class="chapter" data-level="7.4.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#constraints-and-splines"><i class="fa fa-check"></i><b>7.4.2</b> Constraints and Splines</a></li>
<li class="chapter" data-level="7.4.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#spline-basis"><i class="fa fa-check"></i><b>7.4.3</b> The Spline Basis Representation</a></li>
<li class="chapter" data-level="7.4.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#choosing-knots"><i class="fa fa-check"></i><b>7.4.4</b> Choosing the Number and Locations of the Knots</a></li>
<li class="chapter" data-level="7.4.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#comparison-polynomial"><i class="fa fa-check"></i><b>7.4.5</b> Comparison to Polynomial Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#smoothing-splines"><i class="fa fa-check"></i><b>7.5</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#an-overview-of-smoothing-splines"><i class="fa fa-check"></i><b>7.5.1</b> An Overview of Smoothing Splines</a></li>
<li class="chapter" data-level="7.5.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#smoothing-parameter"><i class="fa fa-check"></i><b>7.5.2</b> Choosing the Smoothing Parameter <span class="math inline">\(\lambda\)</span></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#local-regression"><i class="fa fa-check"></i><b>7.6</b> Local Regression</a></li>
<li class="chapter" data-level="7.7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#generalized-additive-models"><i class="fa fa-check"></i><b>7.7</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#gam-regression"><i class="fa fa-check"></i><b>7.7.1</b> GAMs for Regression Problems</a></li>
<li class="chapter" data-level="7.7.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#gam-classification"><i class="fa fa-check"></i><b>7.7.2</b> GAMs for Classification Problems</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#lab-non-linear-modeling"><i class="fa fa-check"></i><b>7.8</b> Lab: Non-linear Modeling</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#polynomial-regression-and-step-functions"><i class="fa fa-check"></i><b>7.8.1</b> Polynomial Regression and Step Functions</a></li>
<li class="chapter" data-level="7.8.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#splines"><i class="fa fa-check"></i><b>7.8.2</b> Splines</a></li>
<li class="chapter" data-level="7.8.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#gams-lab"><i class="fa fa-check"></i><b>7.8.3</b> GAMs</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#exercises-4"><i class="fa fa-check"></i><b>7.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#applied-4"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#reproducibility-4"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning with the tidyverse and tidymodels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="resampling-methods" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Resampling Methods</h1>
<blockquote>
<p>Resampling methods are an indispensable tool in modern statistics. They
involve repeatedly drawing samples from a training set and refitting a model
of interest on each sample in order to obtain additional information about
the fitted model. For example, in order to estimate the variability of a linear
regression fit, we can repeatedly draw different samples from the training
data, fit a linear regression to each new sample, and then examine the
extent to which the resulting fits differ. Such an approach may allow us to
obtain information that would not be available from fitting the model only
once using the original training sample.</p>
</blockquote>
<blockquote>
<p>In this chapter, we discuss two of the most commonly
used resampling methods, <em>cross-validation</em> and the <em>bootstrap</em>.</p>
</blockquote>
<p>Cross-validation is most often used to estimate test error associated with a statistical learning method, whereas the boostrap is most commonly used to provide a measure of accuracy for a given parameter/method.</p>
<blockquote>
<p>The process
of evaluating a model’s performance is known as <em>model assessment</em>, whereas
the process of selecting the proper level of flexibility for a model is known as <em>model selection</em>.</p>
</blockquote>
<div id="cross-validation" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Cross Validation</h2>
<p>Sometimes we want to estimate the test error rate using the available training data.
A number of approaches can be used for this.
In this section we consider methods which involve <em>holding out</em> a subset of the training data from the fitting process, then applying the model to that hold-out set for model assessment.</p>
<div id="validation-set" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> The Validation Set Approach</h3>
<p>This simple strategy involves randomly dividing available observations into training and validation sets.
The model is fit on the training set, and used to make predictions on the validation set.
The corresponding metric from the validation set predictions – usually MSE in the case of a quantitative response – provides an estimate of the test error rate.</p>
<p>To illustrate this, load the <code>Auto</code> data set and R packages:</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="resampling-methods.html#cb340-1" aria-hidden="true" tabindex="-1"></a>auto <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Auto</span>
<span id="cb340-2"><a href="resampling-methods.html#cb340-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-3"><a href="resampling-methods.html#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb340-4"><a href="resampling-methods.html#cb340-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb340-5"><a href="resampling-methods.html#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb340-6"><a href="resampling-methods.html#cb340-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb340-7"><a href="resampling-methods.html#cb340-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb340-8"><a href="resampling-methods.html#cb340-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb340-9"><a href="resampling-methods.html#cb340-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-10"><a href="resampling-methods.html#cb340-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load my R package and set the ggplot theme</span></span>
<span id="cb340-11"><a href="resampling-methods.html#cb340-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunnr)</span>
<span id="cb340-12"><a href="resampling-methods.html#cb340-12" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">&quot;win&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb340-13"><a href="resampling-methods.html#cb340-13" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_td</span>())</span>
<span id="cb340-14"><a href="resampling-methods.html#cb340-14" aria-hidden="true" tabindex="-1"></a><span class="fu">set_geom_fonts</span>()</span>
<span id="cb340-15"><a href="resampling-methods.html#cb340-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set_palette</span>()</span></code></pre></div>
<p>Randomly split the data into 50% training and 50% validation, fit on the training set, and compute the MSE on the validation set.
Since I’ll be repeating this 10 times to reproduce the figure, make a couple functions.
First, a function to set a random seed and split the data into training and validation set (called <code>assessment</code> set in the <code>rsample</code> package):</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="resampling-methods.html#cb341-1" aria-hidden="true" tabindex="-1"></a>auto_validation_split <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb341-2"><a href="resampling-methods.html#cb341-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb341-3"><a href="resampling-methods.html#cb341-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">validation_split</span>(auto, <span class="at">prop =</span> <span class="fl">0.5</span>)</span>
<span id="cb341-4"><a href="resampling-methods.html#cb341-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb341-5"><a href="resampling-methods.html#cb341-5" aria-hidden="true" tabindex="-1"></a>auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_validation_split</span>(<span class="at">seed =</span> <span class="dv">10</span>)</span>
<span id="cb341-6"><a href="resampling-methods.html#cb341-6" aria-hidden="true" tabindex="-1"></a>auto_splits</span></code></pre></div>
<pre><code>## # Validation Set Split (0.5/0.5)  
## # A tibble: 1 × 2
##   splits            id        
##   &lt;list&gt;            &lt;chr&gt;     
## 1 &lt;split [196/196]&gt; validation</code></pre>
<p>Similar to the <code>initial_split</code> workflow, I can access the training and validation sets as follows:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="resampling-methods.html#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">training</span>(auto_splits<span class="sc">$</span>splits[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##      mpg cylinders displacement horsepower weight acceleration year origin
## 139 14.0         8          318        150   4457         13.5   74      1
## 333 29.8         4           89         62   1845         15.3   80      2
## 373 27.0         4          151         90   2735         18.0   82      1
## 73  15.0         8          304        150   3892         12.5   72      1
## 213 16.5         8          350        180   4380         12.1   76      1
## 348 37.0         4           85         65   1975         19.4   81      3
##                          name
## 139 dodge coronet custom (sw)
## 333          vokswagen rabbit
## 373           pontiac phoenix
## 73           amc matador (sw)
## 213          cadillac seville
## 348            datsun 210 mpg</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="resampling-methods.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assessment</span>(auto_splits<span class="sc">$</span>splits[[<span class="dv">1</span>]]) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   mpg cylinders displacement horsepower weight acceleration year origin
## 1  18         8          307        130   3504         12.0   70      1
## 2  15         8          350        165   3693         11.5   70      1
## 3  18         8          318        150   3436         11.0   70      1
## 5  17         8          302        140   3449         10.5   70      1
## 6  15         8          429        198   4341         10.0   70      1
## 7  14         8          454        220   4354          9.0   70      1
##                        name
## 1 chevrolet chevelle malibu
## 2         buick skylark 320
## 3        plymouth satellite
## 5               ford torino
## 6          ford galaxie 500
## 7          chevrolet impala</code></pre>
<p>Second, a function to fit 10 models (1 to 10 polynomial degrees of freedom) on the training set, and evaluate on the validation set with <code>fit_resamples()</code>:
<a href="moving-beyond-linearity.html#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="resampling-methods.html#cb347-1" aria-hidden="true" tabindex="-1"></a>auto_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)</span>
<span id="cb347-2"><a href="resampling-methods.html#cb347-2" aria-hidden="true" tabindex="-1"></a>lm_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> <span class="fu">add_model</span>(<span class="fu">linear_reg</span>())</span>
<span id="cb347-3"><a href="resampling-methods.html#cb347-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-4"><a href="resampling-methods.html#cb347-4" aria-hidden="true" tabindex="-1"></a>evaluate_poly_fits <span class="ot">&lt;-</span> <span class="cf">function</span>(auto_splits) {</span>
<span id="cb347-5"><a href="resampling-methods.html#cb347-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">poly_df =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb347-6"><a href="resampling-methods.html#cb347-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb347-7"><a href="resampling-methods.html#cb347-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">lm_rec =</span> <span class="fu">map</span>(</span>
<span id="cb347-8"><a href="resampling-methods.html#cb347-8" aria-hidden="true" tabindex="-1"></a>        poly_df, <span class="sc">~</span> auto_rec <span class="sc">%&gt;%</span> <span class="fu">step_poly</span>(horsepower, <span class="at">degree =</span> .x)</span>
<span id="cb347-9"><a href="resampling-methods.html#cb347-9" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb347-10"><a href="resampling-methods.html#cb347-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">lm_fit =</span> <span class="fu">map</span>(</span>
<span id="cb347-11"><a href="resampling-methods.html#cb347-11" aria-hidden="true" tabindex="-1"></a>        lm_rec,</span>
<span id="cb347-12"><a href="resampling-methods.html#cb347-12" aria-hidden="true" tabindex="-1"></a>        <span class="sc">~</span> lm_workflow <span class="sc">%&gt;%</span> <span class="fu">add_recipe</span>(.x) <span class="sc">%&gt;%</span> <span class="fu">fit_resamples</span>(auto_splits)</span>
<span id="cb347-13"><a href="resampling-methods.html#cb347-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb347-14"><a href="resampling-methods.html#cb347-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">lm_metrics =</span> <span class="fu">map</span>(lm_fit, collect_metrics)</span>
<span id="cb347-15"><a href="resampling-methods.html#cb347-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb347-16"><a href="resampling-methods.html#cb347-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(lm_metrics) <span class="sc">%&gt;%</span></span>
<span id="cb347-17"><a href="resampling-methods.html#cb347-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;rmse&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb347-18"><a href="resampling-methods.html#cb347-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(poly_df, <span class="at">rmse =</span> mean)</span>
<span id="cb347-19"><a href="resampling-methods.html#cb347-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb347-20"><a href="resampling-methods.html#cb347-20" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation <span class="ot">&lt;-</span> <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb347-21"><a href="resampling-methods.html#cb347-21" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    poly_df  rmse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  5.14
##  2       2  4.46
##  3       3  4.50
##  4       4  4.49
##  5       5  4.39
##  6       6  4.36
##  7       7  4.33
##  8       8  4.33
##  9       9  4.32
## 10      10  4.60</code></pre>
<p>Now reproduce Figure 5.2:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="resampling-methods.html#cb349-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb349-2"><a href="resampling-methods.html#cb349-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9 additional sets of fits</span></span>
<span id="cb349-3"><a href="resampling-methods.html#cb349-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(</span>
<span id="cb349-4"><a href="resampling-methods.html#cb349-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb349-5"><a href="resampling-methods.html#cb349-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(seed) {</span>
<span id="cb349-6"><a href="resampling-methods.html#cb349-6" aria-hidden="true" tabindex="-1"></a>      auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_validation_split</span>(seed)</span>
<span id="cb349-7"><a href="resampling-methods.html#cb349-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb349-8"><a href="resampling-methods.html#cb349-8" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb349-9"><a href="resampling-methods.html#cb349-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;rep&quot;</span></span>
<span id="cb349-10"><a href="resampling-methods.html#cb349-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb349-11"><a href="resampling-methods.html#cb349-11" aria-hidden="true" tabindex="-1"></a>  auto_poly_fits_validation <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rep =</span> <span class="st">&quot;10&quot;</span>)</span>
<span id="cb349-12"><a href="resampling-methods.html#cb349-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb349-13"><a href="resampling-methods.html#cb349-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-14"><a href="resampling-methods.html#cb349-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a 10 color palette from the MetBrewer package</span></span>
<span id="cb349-15"><a href="resampling-methods.html#cb349-15" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> MetBrewer<span class="sc">::</span><span class="fu">met.brewer</span>(<span class="st">&quot;Veronese&quot;</span>, <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;continuous&quot;</span>)</span>
<span id="cb349-16"><a href="resampling-methods.html#cb349-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-17"><a href="resampling-methods.html#cb349-17" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> auto_poly_fits_validation <span class="sc">%&gt;%</span></span>
<span id="cb349-18"><a href="resampling-methods.html#cb349-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_df, <span class="at">y =</span> rmse<span class="sc">^</span><span class="dv">2</span>, <span class="at">fill =</span> rep)) <span class="sc">+</span></span>
<span id="cb349-19"><a href="resampling-methods.html#cb349-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> rep), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb349-20"><a href="resampling-methods.html#cb349-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb349-21"><a href="resampling-methods.html#cb349-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb349-22"><a href="resampling-methods.html#cb349-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb349-23"><a href="resampling-methods.html#cb349-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb349-24"><a href="resampling-methods.html#cb349-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Degree of polynomial&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb349-25"><a href="resampling-methods.html#cb349-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb349-26"><a href="resampling-methods.html#cb349-26" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="sc">%+%</span> <span class="fu">filter</span>(auto_poly_fits_validation, rep <span class="sc">==</span> <span class="st">&quot;1&quot;</span>) <span class="sc">+</span></span>
<span id="cb349-27"><a href="resampling-methods.html#cb349-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rep), <span class="at">shape =</span> <span class="dv">21</span>,  <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb349-28"><a href="resampling-methods.html#cb349-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;MSE&quot;</span>)</span>
<span id="cb349-29"><a href="resampling-methods.html#cb349-29" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.2-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>As is clear from the right-hand panel, this approach is highly variable depending on the testing/validation set split.
Another downside is that, because the training set used to fit the data has fewer observations, it tends to overestimate the test error rate on the entire data set.</p>
</div>
<div id="loocv" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Leave-One-Out Cross Validation</h3>
<p><em>Leave-one-out cross validation</em> (LOOCV) attempts to address the shortcomings of the validation set approach.
It still involves splitting the <span class="math inline">\(n\)</span> observations into two parts, but it repeats it <span class="math inline">\(n\)</span> times, with a single observation <span class="math inline">\((x_i, y_i)\)</span> as the hold-out “set” and the remaining <span class="math inline">\(n-1\)</span> observations as the training set.
The MSE for each iteration is simply <span class="math inline">\(\text{MSE}_i = (y_i - \hat{y}_i)^2\)</span>.
Then the LOOCV estimate of the MSE is the average over all observations:</p>
<p><span class="math display">\[
\text{CV}_{(n)} = \frac{1}{n} \sum_{i=1}^n \text{MSE}_i.
\]</span></p>
<p>The LOOCV approach has a few advantages over the validation set approach:</p>
<blockquote>
<ul>
<li>First, it has far less bias. In LOOCV, we repeatedly fit the statistical learning method using training sets that contain <span class="math inline">\(n − 1\)</span> observations, almost as many as are in the entire data set. This is in contrast to the validation set approach, in which the training set is typically around half the size of the original data set. Consequently, the LOOCV approach tends not to overestimate the test error rate as much as the validation set approach does.</li>
<li>Second, in contrast to the validation approach which will yield different results when applied repeatedly due to randomness in the training/validation set splits, performing LOOCV multiple times will always yield the same results: there is no randomness in the training/validation set splits.</li>
</ul>
</blockquote>
<p>Define a new function to split the data by LOOCV:
<a href="moving-beyond-linearity.html#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="resampling-methods.html#cb350-1" aria-hidden="true" tabindex="-1"></a>auto_splits <span class="ot">&lt;-</span> <span class="fu">loo_cv</span>(auto)</span>
<span id="cb350-2"><a href="resampling-methods.html#cb350-2" aria-hidden="true" tabindex="-1"></a>auto_splits</span></code></pre></div>
<pre><code>## # Leave-one-out cross-validation 
## # A tibble: 392 × 2
##    splits          id        
##    &lt;list&gt;          &lt;chr&gt;     
##  1 &lt;split [391/1]&gt; Resample1 
##  2 &lt;split [391/1]&gt; Resample2 
##  3 &lt;split [391/1]&gt; Resample3 
##  4 &lt;split [391/1]&gt; Resample4 
##  5 &lt;split [391/1]&gt; Resample5 
##  6 &lt;split [391/1]&gt; Resample6 
##  7 &lt;split [391/1]&gt; Resample7 
##  8 &lt;split [391/1]&gt; Resample8 
##  9 &lt;split [391/1]&gt; Resample9 
## 10 &lt;split [391/1]&gt; Resample10
## # … with 382 more rows</code></pre>
<p>392 splits, which is the number of observations, as expected.
Fit:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="resampling-methods.html#cb352-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv <span class="ot">&lt;-</span> <span class="fu">evaluate_poly_fits</span>(auto_splits)</span></code></pre></div>
<pre><code>## Error in `mutate()`:
## ! Problem while computing `lm_fit = map(lm_rec, ~lm_workflow %&gt;%
##   add_recipe(.x) %&gt;% fit_resamples(auto_splits))`.
## Caused by error in `check_rset()`:
## ! Leave-one-out cross-validation is not currently supported with tune.</code></pre>
<p>As the error says, LOOCV is not supported.
Here’s an <a href="https://www.tmwr.org/resampling.html#leave-one-out-cross-validation">explanation I found online</a>:</p>
<blockquote>
<p>Leave-one-out methods are deficient compared to almost any other method. For anything but pathologically small samples, LOO is computationally excessive and it may not have good statistical properties. Although rsample contains a <code>loo_cv()</code> function, these objects are not generally integrated into the broader tidymodels frameworks.</p>
</blockquote>
<p>Fair enough.
For completeness, I will still get the LOOCV estimates using <code>boot::cv.glm()</code>:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="resampling-methods.html#cb354-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb354-2"><a href="resampling-methods.html#cb354-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">poly_df =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb354-3"><a href="resampling-methods.html#cb354-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mse =</span> <span class="fu">map_dbl</span>(poly_df,</span>
<span id="cb354-4"><a href="resampling-methods.html#cb354-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(poly_df) {</span>
<span id="cb354-5"><a href="resampling-methods.html#cb354-5" aria-hidden="true" tabindex="-1"></a>      glm_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, <span class="at">degree =</span> poly_df), <span class="at">data =</span> auto)</span>
<span id="cb354-6"><a href="resampling-methods.html#cb354-6" aria-hidden="true" tabindex="-1"></a>      boot<span class="sc">::</span><span class="fu">cv.glm</span>(auto, glm_fit)<span class="sc">$</span>delta[<span class="dv">1</span>]</span>
<span id="cb354-7"><a href="resampling-methods.html#cb354-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb354-8"><a href="resampling-methods.html#cb354-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb354-9"><a href="resampling-methods.html#cb354-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb354-10"><a href="resampling-methods.html#cb354-10" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    poly_df   mse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  24.2
##  2       2  19.2
##  3       3  19.3
##  4       4  19.4
##  5       5  19.0
##  6       6  19.0
##  7       7  18.8
##  8       8  19.0
##  9       9  19.1
## 10      10  19.5</code></pre>
</div>
<div id="kfoldcv" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> <span class="math inline">\(k\)</span>-fold Cross-Validation</h3>
<p><em><span class="math inline">\(k\)</span>-fold CV</em> involves randomly dividing the observations into <span class="math inline">\(k\)</span> groups/folds of approximately equal size.
The first fold is used as the validation/assessment set, and the remaining <span class="math inline">\(k-1\)</span> folds used to fit the model.
This is repeated <span class="math inline">\(k\)</span> times, with each fold being used as the assessment set once.
The <span class="math inline">\(k\)</span>-fold CV estimate of the test error is then the average:</p>
<p><span class="math display">\[
\text{CV}_{(k)} = \frac{1}{k} \sum_{i=1}^k \text{MSE}_i.
\]</span></p>
<p>This should look familiar:</p>
<blockquote>
<p>It is not hard to see that LOOCV is a special case of <span class="math inline">\(k\)</span>-fold CV in which <span class="math inline">\(k\)</span>
is set to equal <span class="math inline">\(n\)</span>. In practice, one typically performs <span class="math inline">\(k\)</span>-fold CV using <span class="math inline">\(k\)</span> = 5
or <span class="math inline">\(k\)</span> = 10. What is the advantage of using <span class="math inline">\(k\)</span> = 5 or <span class="math inline">\(k\)</span> = 10 rather than
<span class="math inline">\(k\)</span> = <span class="math inline">\(n\)</span>? The most obvious advantage is computational. LOOCV requires
fitting the statistical learning method <span class="math inline">\(n\)</span> times. This has the potential to be
computationally expensive (except for linear models fit by least squares,
in which case formula (5.2) can be used). But cross-validation is a very
general approach that can be applied to almost any statistical learning
method. Some statistical learning methods have computationally intensive
fitting procedures, and so performing LOOCV may pose computational
problems, especially if <span class="math inline">\(n\)</span> is extremely large. In contrast, performing 10-fold
CV requires fitting the learning procedure only ten times, which may be
much more feasible. As we see in Section 5.1.4, there also can be other
non-computational advantages to performing 5-fold or 10-fold CV, which
involve the bias-variance trade-off.</p>
</blockquote>
<p>Fit the polynomial models with 10-fold CV:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="resampling-methods.html#cb356-1" aria-hidden="true" tabindex="-1"></a>auto_10_fold_cv <span class="ot">&lt;-</span> <span class="cf">function</span>(seed) {</span>
<span id="cb356-2"><a href="resampling-methods.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb356-3"><a href="resampling-methods.html#cb356-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">vfold_cv</span>(auto, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb356-4"><a href="resampling-methods.html#cb356-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb356-5"><a href="resampling-methods.html#cb356-5" aria-hidden="true" tabindex="-1"></a>auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_10_fold_cv</span>(<span class="at">seed =</span> <span class="dv">10</span>)</span>
<span id="cb356-6"><a href="resampling-methods.html#cb356-6" aria-hidden="true" tabindex="-1"></a>auto_splits</span></code></pre></div>
<pre><code>## #  10-fold cross-validation 
## # A tibble: 10 × 2
##    splits           id    
##    &lt;list&gt;           &lt;chr&gt; 
##  1 &lt;split [352/40]&gt; Fold01
##  2 &lt;split [352/40]&gt; Fold02
##  3 &lt;split [353/39]&gt; Fold03
##  4 &lt;split [353/39]&gt; Fold04
##  5 &lt;split [353/39]&gt; Fold05
##  6 &lt;split [353/39]&gt; Fold06
##  7 &lt;split [353/39]&gt; Fold07
##  8 &lt;split [353/39]&gt; Fold08
##  9 &lt;split [353/39]&gt; Fold09
## 10 &lt;split [353/39]&gt; Fold10</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="resampling-methods.html#cb358-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv <span class="ot">&lt;-</span> <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb358-2"><a href="resampling-methods.html#cb358-2" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    poly_df  rmse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  4.90
##  2       2  4.35
##  3       3  4.35
##  4       4  4.37
##  5       5  4.31
##  6       6  4.31
##  7       7  4.28
##  8       8  4.29
##  9       9  4.30
## 10      10  4.37</code></pre>
<p>Now repeat this another 9 times.
Thought it won’t take <em>too</em> long to run, I’ll make use of <code>parallel</code> to speed it up a bit:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="resampling-methods.html#cb360-1" aria-hidden="true" tabindex="-1"></a>n_cores <span class="ot">&lt;-</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(<span class="at">logical =</span> <span class="cn">FALSE</span>)</span>
<span id="cb360-2"><a href="resampling-methods.html#cb360-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb360-3"><a href="resampling-methods.html#cb360-3" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makePSOCKcluster</span>(n_cores <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb360-4"><a href="resampling-methods.html#cb360-4" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span></code></pre></div>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="resampling-methods.html#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb361-2"><a href="resampling-methods.html#cb361-2" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb361-3"><a href="resampling-methods.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 9 additional sets of fits</span></span>
<span id="cb361-4"><a href="resampling-methods.html#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(</span>
<span id="cb361-5"><a href="resampling-methods.html#cb361-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,</span>
<span id="cb361-6"><a href="resampling-methods.html#cb361-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(seed) {</span>
<span id="cb361-7"><a href="resampling-methods.html#cb361-7" aria-hidden="true" tabindex="-1"></a>      auto_splits <span class="ot">&lt;-</span> <span class="fu">auto_10_fold_cv</span>(seed)</span>
<span id="cb361-8"><a href="resampling-methods.html#cb361-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">evaluate_poly_fits</span>(auto_splits)</span>
<span id="cb361-9"><a href="resampling-methods.html#cb361-9" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb361-10"><a href="resampling-methods.html#cb361-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;rep&quot;</span></span>
<span id="cb361-11"><a href="resampling-methods.html#cb361-11" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb361-12"><a href="resampling-methods.html#cb361-12" aria-hidden="true" tabindex="-1"></a>  auto_poly_fits_10_fold_cv <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rep =</span> <span class="st">&quot;10&quot;</span>)</span>
<span id="cb361-13"><a href="resampling-methods.html#cb361-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb361-14"><a href="resampling-methods.html#cb361-14" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 93.12 sec elapsed</code></pre>
<p>Now reproduce Figure 5.4:</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="resampling-methods.html#cb363-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> auto_poly_fits_10_fold_cv <span class="sc">%&gt;%</span></span>
<span id="cb363-2"><a href="resampling-methods.html#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mse =</span> rmse<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-3"><a href="resampling-methods.html#cb363-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> poly_df, <span class="at">y =</span> mse, <span class="at">fill =</span> rep)) <span class="sc">+</span></span>
<span id="cb363-4"><a href="resampling-methods.html#cb363-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> rep), <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb363-5"><a href="resampling-methods.html#cb363-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">30</span>)) <span class="sc">+</span></span>
<span id="cb363-6"><a href="resampling-methods.html#cb363-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb363-7"><a href="resampling-methods.html#cb363-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb363-8"><a href="resampling-methods.html#cb363-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> pal) <span class="sc">+</span></span>
<span id="cb363-9"><a href="resampling-methods.html#cb363-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Degree of polynomial&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb363-10"><a href="resampling-methods.html#cb363-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb363-11"><a href="resampling-methods.html#cb363-11" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> p2 <span class="sc">%+%</span> <span class="fu">mutate</span>(auto_poly_fits_loo_cv, <span class="at">rep =</span> <span class="st">&quot;1&quot;</span>) <span class="sc">+</span></span>
<span id="cb363-12"><a href="resampling-methods.html#cb363-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">fill =</span> rep), <span class="at">shape =</span> <span class="dv">21</span>,  <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb363-13"><a href="resampling-methods.html#cb363-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;MSE&quot;</span>)</span>
<span id="cb363-14"><a href="resampling-methods.html#cb363-14" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.4-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The <span class="math inline">\(k\)</span>-fold CV approach (right panel) still has some variability due to random splitting, but much less than the validation set approach.</p>
<p>As a reminder, with cross-validation we are trying to approximate the true test MSE, which we cannot know for certain unless the data are simulated (like in Figure 5.6).
The true error value itself is important if we want to know how a model will perform on independent data.
However, if all we care about is parameter(s) that give the minimum error (like the degree of polynomial in these examples), then the CV estimate will usually come close to the true answer.</p>
</div>
<div id="bias-variance-trade-off-for-k-fold-cross-validation" class="section level3" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Bias-Variance Trade-Off for <span class="math inline">\(k\)</span>-Fold Cross-Validation</h3>
<p>In addition to being computationally more efficient than LOOCV, <span class="math inline">\(k\)</span>-fold CV with <span class="math inline">\(k &lt; n\)</span> also often gives more accurate estimates of the test error rate due to the bias-variance tradeoff.</p>
<ul>
<li><span class="math inline">\(k\)</span>-fold CV has moderate bias in comparison to LOOCV, which is approximately unbiased.</li>
<li><span class="math inline">\(k\)</span>-fold CV (average over <span class="math inline">\(k\)</span> fitted models) tends to have lower variance than LOOCV (average over <span class="math inline">\(n\)</span> fitted models, highly correlated with each other).</li>
</ul>
<blockquote>
<p>To summarize, there is a bias-variance trade-off associated with the
choice of <span class="math inline">\(k\)</span> in <span class="math inline">\(k\)</span>-fold cross-validation. Typically, given these considerations,
one performs <span class="math inline">\(k\)</span>-fold cross-validation using <span class="math inline">\(k\)</span> = 5 or <span class="math inline">\(k\)</span> = 10, as these values
have been shown empirically to yield test error rate estimates that suffer
neither from excessively high bias nor from very high variance.</p>
</blockquote>
</div>
<div id="cross-validation-on-classification-problems" class="section level3" number="5.1.5">
<h3><span class="header-section-number">5.1.5</span> Cross-Validation on Classification Problems</h3>
<p>Rather than quantitative <span class="math inline">\(Y\)</span>, cross-validation works just as well with qualitative <span class="math inline">\(Y\)</span>.
Instead of MSE, we use the number of misclassified observations, <span class="math inline">\(\text{Err}_i = I(y_i \neq \hat{y}_i)\)</span>.
The LOOCV error rate:</p>
<p><span class="math display">\[
\text{CV}_{(n)} = \frac{1}{n} \sum_{i=1}^n \text{Err}_i.
\]</span></p>
<p>The <span class="math inline">\(k\)</span>-fold CV and validation set error rates are defined analogously.</p>
</div>
</div>
<div id="bootstrap-lab" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The Bootstrap</h2>
<blockquote>
<p>The <em>bootstrap</em> is a widely applicable and extremely powerful statistical tool that can be used to quantify the uncertainty associated with a given estimator or statistical learning method. As a simple example, the bootstrap can be used to estimate the standard errors of the coefficients from a linear regression fit. In the specific case of linear regression, this is not particularly useful, since we saw in Chapter 3 that standard statistical software such as R outputs such standard errors automatically. However, the power of the bootstrap lies in the fact that it can be easily applied to a wide range of statistical learning methods, including some for which a measure of variability is otherwise difficult to obtain and is not automatically output by
statistical software.</p>
</blockquote>
<p>The toy example in this section is about investment in two assets <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>.
We wish to choose a fraction <span class="math inline">\(\alpha\)</span> of investment into <span class="math inline">\(X\)</span> which minimizes the total variance (risk) of the investment.
In can be shown that the optimal value is given by:</p>
<p><span class="math display">\[
\alpha = \frac{\sigma_Y^2 - \sigma_{XY}}{\sigma_X^2 + \sigma_Y^2 - 2\sigma_{XY}},
\]</span></p>
<p>where <span class="math inline">\(\sigma_X^2 = \text{Var}(X)\)</span>, <span class="math inline">\(\sigma_Y^2 = \text{Var}(Y)\)</span>, and <span class="math inline">\(\sigma_{XY} = \text{Cov}(X, Y)\)</span>.
In reality, we don’t know these variances and covariance, so we estimate them (e.g. <span class="math inline">\(\hat{\sigma}_X^2\)</span>) using observations of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> to get an estimated <span class="math inline">\(\hat{\alpha}\)</span>.</p>
<p>To illustrate, we simulate 100 pairs of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and compute the estimated <span class="math inline">\(\alpha\)</span>.
The simulation parameters are <span class="math inline">\(\sigma_X^2 = 1\)</span>, <span class="math inline">\(\sigma_Y^2 = 1.25\)</span>, and <span class="math inline">\(\sigma_{XY} = 0.5\)</span>.
Presumably, these are bivariate normally distributed, which I can simulate with the <code>mvtnorm</code> package:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="resampling-methods.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb364-2"><a href="resampling-methods.html#cb364-2" aria-hidden="true" tabindex="-1"></a>sigma_x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb364-3"><a href="resampling-methods.html#cb364-3" aria-hidden="true" tabindex="-1"></a>sigma_y <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">1.25</span>)</span>
<span id="cb364-4"><a href="resampling-methods.html#cb364-4" aria-hidden="true" tabindex="-1"></a>sigma_xy <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb364-5"><a href="resampling-methods.html#cb364-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The variance-covariance matrix</span></span>
<span id="cb364-6"><a href="resampling-methods.html#cb364-6" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(sigma_x<span class="sc">^</span><span class="dv">2</span>, sigma_xy, sigma_xy, sigma_y<span class="sc">^</span><span class="dv">2</span>), <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb364-7"><a href="resampling-methods.html#cb364-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 5 observations</span></span>
<span id="cb364-8"><a href="resampling-methods.html#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">5</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> sigma)</span></code></pre></div>
<pre><code>##            [,1]       [,2]
## [1,] -0.6198186  0.2723180
## [2,] -0.4510171 -1.4568201
## [3,] -0.0302161 -1.3962636
## [4,] -0.3405990 -0.3004827
## [5,] -0.3552014  1.1948117</code></pre>
<p>Write a function to compute <span class="math inline">\(\alpha\)</span> from the simulated <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="resampling-methods.html#cb366-1" aria-hidden="true" tabindex="-1"></a>sim_alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xy =</span> <span class="cn">NULL</span>) {</span>
<span id="cb366-2"><a href="resampling-methods.html#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(xy)) {</span>
<span id="cb366-3"><a href="resampling-methods.html#cb366-3" aria-hidden="true" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> sigma)</span>
<span id="cb366-4"><a href="resampling-methods.html#cb366-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb366-5"><a href="resampling-methods.html#cb366-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> xy[,<span class="dv">1</span>]; y <span class="ot">&lt;-</span> xy[,<span class="dv">2</span>]</span>
<span id="cb366-6"><a href="resampling-methods.html#cb366-6" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">var</span>(y) <span class="sc">-</span>  <span class="fu">cov</span>(x, y)) <span class="sc">/</span> (<span class="fu">var</span>(x) <span class="sc">+</span> <span class="fu">var</span>(y) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cov</span>(x, y))</span>
<span id="cb366-7"><a href="resampling-methods.html#cb366-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb366-8"><a href="resampling-methods.html#cb366-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_alpha</span>()</span></code></pre></div>
<pre><code>## [1] 0.577909</code></pre>
<p>Run four simulations and plot <span class="math inline">\(X\)</span> vs <span class="math inline">\(Y\)</span> for Figure 5.9</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="resampling-methods.html#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">319</span>)</span>
<span id="cb368-2"><a href="resampling-methods.html#cb368-2" aria-hidden="true" tabindex="-1"></a>d4 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb368-3"><a href="resampling-methods.html#cb368-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb368-4"><a href="resampling-methods.html#cb368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xy =</span> <span class="fu">list</span>(<span class="fu">rmvnorm</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">mean =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="at">sigma =</span> sigma))) <span class="sc">%&gt;%</span></span>
<span id="cb368-5"><a href="resampling-methods.html#cb368-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb368-6"><a href="resampling-methods.html#cb368-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">map_dbl</span>(xy, sim_alpha) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">3</span>),</span>
<span id="cb368-7"><a href="resampling-methods.html#cb368-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">map</span>(xy, <span class="sc">~</span> .x[,<span class="dv">1</span>]), <span class="at">y =</span> <span class="fu">map</span>(xy, <span class="sc">~</span> .x[,<span class="dv">2</span>])) <span class="sc">%&gt;%</span></span>
<span id="cb368-8"><a href="resampling-methods.html#cb368-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(x, y))</span>
<span id="cb368-9"><a href="resampling-methods.html#cb368-9" aria-hidden="true" tabindex="-1"></a>d4 <span class="sc">%&gt;%</span></span>
<span id="cb368-10"><a href="resampling-methods.html#cb368-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb368-11"><a href="resampling-methods.html#cb368-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>emerald, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb368-12"><a href="resampling-methods.html#cb368-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>alpha, <span class="at">labeller =</span> <span class="st">&quot;label_both&quot;</span>) <span class="sc">+</span></span>
<span id="cb368-13"><a href="resampling-methods.html#cb368-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_facet_borders</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.9-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>For Figure 5.10, I first simulate 1000 data sets from the true population and estimate <span class="math inline">\(\alpha\)</span> for each:</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="resampling-methods.html#cb369-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb369-2"><a href="resampling-methods.html#cb369-2" aria-hidden="true" tabindex="-1"></a>  d4 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(sim, alpha),</span>
<span id="cb369-3"><a href="resampling-methods.html#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">sim =</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-4"><a href="resampling-methods.html#cb369-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb369-5"><a href="resampling-methods.html#cb369-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">sim_alpha</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb369-6"><a href="resampling-methods.html#cb369-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb369-7"><a href="resampling-methods.html#cb369-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb369-8"><a href="resampling-methods.html#cb369-8" aria-hidden="true" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## # A tibble: 1,000 × 2
##      sim alpha
##    &lt;int&gt; &lt;dbl&gt;
##  1     1 0.555
##  2     2 0.622
##  3     3 0.615
##  4     4 0.453
##  5     5 0.588
##  6     6 0.605
##  7     7 0.483
##  8     8 0.598
##  9     9 0.602
## 10    10 0.633
## # … with 990 more rows</code></pre>
<p>And then, using just the first simulated data set, use the <code>rsample::boostraps()</code> function to generate 1000 bootstrap resamples:</p>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="resampling-methods.html#cb371-1" aria-hidden="true" tabindex="-1"></a>d1_boot <span class="ot">&lt;-</span> d4 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sim <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(x, y) <span class="sc">%&gt;%</span></span>
<span id="cb371-2"><a href="resampling-methods.html#cb371-2" aria-hidden="true" tabindex="-1"></a>  rsample<span class="sc">::</span><span class="fu">bootstraps</span>(<span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb371-3"><a href="resampling-methods.html#cb371-3" aria-hidden="true" tabindex="-1"></a>d1_boot</span></code></pre></div>
<pre><code>## # Bootstrap sampling 
## # A tibble: 1,000 × 2
##    splits           id           
##    &lt;list&gt;           &lt;chr&gt;        
##  1 &lt;split [100/34]&gt; Bootstrap0001
##  2 &lt;split [100/37]&gt; Bootstrap0002
##  3 &lt;split [100/32]&gt; Bootstrap0003
##  4 &lt;split [100/35]&gt; Bootstrap0004
##  5 &lt;split [100/39]&gt; Bootstrap0005
##  6 &lt;split [100/38]&gt; Bootstrap0006
##  7 &lt;split [100/43]&gt; Bootstrap0007
##  8 &lt;split [100/39]&gt; Bootstrap0008
##  9 &lt;split [100/31]&gt; Bootstrap0009
## 10 &lt;split [100/44]&gt; Bootstrap0010
## # … with 990 more rows</code></pre>
<p>Compute <span class="math inline">\(\hat{\alpha}\)</span> from each split:</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="resampling-methods.html#cb373-1" aria-hidden="true" tabindex="-1"></a>d1_boot_alpha <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb373-2"><a href="resampling-methods.html#cb373-2" aria-hidden="true" tabindex="-1"></a>  d1_boot<span class="sc">$</span>splits,</span>
<span id="cb373-3"><a href="resampling-methods.html#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(split) {</span>
<span id="cb373-4"><a href="resampling-methods.html#cb373-4" aria-hidden="true" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(split)</span>
<span id="cb373-5"><a href="resampling-methods.html#cb373-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sim_alpha</span>(<span class="fu">as.matrix</span>(xy))</span>
<span id="cb373-6"><a href="resampling-methods.html#cb373-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb373-7"><a href="resampling-methods.html#cb373-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Now reproduce the figure:</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="resampling-methods.html#cb374-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb374-2"><a href="resampling-methods.html#cb374-2" aria-hidden="true" tabindex="-1"></a>  d <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">population =</span> <span class="st">&quot;true&quot;</span>),</span>
<span id="cb374-3"><a href="resampling-methods.html#cb374-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">alpha =</span> d1_boot_alpha, <span class="at">population =</span> <span class="st">&quot;bootstrap resamples&quot;</span>)</span>
<span id="cb374-4"><a href="resampling-methods.html#cb374-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb374-5"><a href="resampling-methods.html#cb374-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population =</span> <span class="fu">fct_rev</span>(population))</span>
<span id="cb374-6"><a href="resampling-methods.html#cb374-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-7"><a href="resampling-methods.html#cb374-7" aria-hidden="true" tabindex="-1"></a>true_alpha <span class="ot">&lt;-</span> (sigma_y<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> sigma_xy) <span class="sc">/</span> (sigma_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> sigma_y<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> sigma_xy)</span>
<span id="cb374-8"><a href="resampling-methods.html#cb374-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb374-9"><a href="resampling-methods.html#cb374-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> alpha, <span class="at">fill =</span> population)) <span class="sc">+</span></span>
<span id="cb374-10"><a href="resampling-methods.html#cb374-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb374-11"><a href="resampling-methods.html#cb374-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> true_alpha,</span>
<span id="cb374-12"><a href="resampling-methods.html#cb374-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>light_coral, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb374-13"><a href="resampling-methods.html#cb374-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> population, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb374-14"><a href="resampling-methods.html#cb374-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(td_colors<span class="sc">$</span>nice<span class="sc">$</span>soft_orange,</span>
<span id="cb374-15"><a href="resampling-methods.html#cb374-15" aria-hidden="true" tabindex="-1"></a>                               td_colors<span class="sc">$</span>nice<span class="sc">$</span>strong_blue))</span>
<span id="cb374-16"><a href="resampling-methods.html#cb374-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb374-17"><a href="resampling-methods.html#cb374-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> alpha, <span class="at">x =</span> population)) <span class="sc">+</span></span>
<span id="cb374-18"><a href="resampling-methods.html#cb374-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> population), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb374-19"><a href="resampling-methods.html#cb374-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_alpha,</span>
<span id="cb374-20"><a href="resampling-methods.html#cb374-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>light_coral, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb374-21"><a href="resampling-methods.html#cb374-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(td_colors<span class="sc">$</span>nice<span class="sc">$</span>soft_orange,</span>
<span id="cb374-22"><a href="resampling-methods.html#cb374-22" aria-hidden="true" tabindex="-1"></a>                               td_colors<span class="sc">$</span>nice<span class="sc">$</span>strong_blue))</span>
<span id="cb374-23"><a href="resampling-methods.html#cb374-23" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">|</span> p2</span></code></pre></div>
<p><img src="_main_files/figure-html/figure5.10-1.png" width="672" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Note that the histogram looks very similar to the left-hand panel, which
displays the idealized histogram of the estimates of α obtained by generating 1,000 simulated data sets from the true population. In particular the
bootstrap estimate <span class="math inline">\(\text{SE}(\hat{\alpha})\)</span> from (5.8) is 0.087, very close to the estimate
of 0.083 obtained using 1,000 simulated data sets. The right-hand panel
displays the information in the center and left panels in a different way, via
boxplots of the estimates for <span class="math inline">\(\alpha\)</span> obtained by generating 1,000 simulated data
sets from the true population and using the bootstrap approach. Again, the
boxplots have similar spreads, indicating that the bootstrap approach can
be used to effectively estimate the variability associated with <span class="math inline">\(\hat{\alpha}\)</span>.</p>
</blockquote>
</div>
<div id="lab-cross-validation-and-the-bootstrap" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Lab: Cross-Validation and the Bootstrap</h2>
<div id="the-validation-set-approach" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> The Validation Set Approach</h3>
<p>Here are the MSE values as computed in <a href="resampling-methods.html#validation-set">5.1.1</a>:</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="resampling-methods.html#cb375-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_validation <span class="sc">%&gt;%</span></span>
<span id="cb375-2"><a href="resampling-methods.html#cb375-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(poly_df <span class="sc">&lt;=</span> <span class="dv">3</span>, rep <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb375-3"><a href="resampling-methods.html#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mse =</span> rmse<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   rep   poly_df  rmse   mse
##   &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 1           1  4.82  23.3
## 2 1           2  4.33  18.7
## 3 1           3  4.34  18.8</code></pre>
</div>
<div id="leave-one-out-cross-validation" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Leave-One-Out Cross-Validation</h3>
<p>Because LOOCV is deterministic (not random), the process in <a href="resampling-methods.html#loocv">5.1.2</a> produces the same MSE values:</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="resampling-methods.html#cb377-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_loo_cv</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    poly_df   mse
##      &lt;int&gt; &lt;dbl&gt;
##  1       1  24.2
##  2       2  19.2
##  3       3  19.3
##  4       4  19.4
##  5       5  19.0
##  6       6  19.0
##  7       7  18.8
##  8       8  19.0
##  9       9  19.1
## 10      10  19.5</code></pre>
</div>
<div id="k-fold-cross-validation" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> <span class="math inline">\(k\)</span>-fold Cross-Validation</h3>
<p>The MSE values as computed in <a href="resampling-methods.html#kfoldcv">5.1.3</a>:</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="resampling-methods.html#cb379-1" aria-hidden="true" tabindex="-1"></a>auto_poly_fits_10_fold_cv <span class="sc">%&gt;%</span></span>
<span id="cb379-2"><a href="resampling-methods.html#cb379-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(rep <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-3"><a href="resampling-methods.html#cb379-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mse =</span> rmse<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##    rep   poly_df  rmse   mse
##    &lt;chr&gt;   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 1           1  4.87  23.7
##  2 1           2  4.31  18.6
##  3 1           3  4.31  18.6
##  4 1           4  4.32  18.7
##  5 1           5  4.28  18.3
##  6 1           6  4.28  18.3
##  7 1           7  4.24  18.0
##  8 1           8  4.26  18.1
##  9 1           9  4.26  18.2
## 10 1          10  4.32  18.7</code></pre>
</div>
<div id="bootstrap" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> The Bootstrap</h3>
<div id="estimating-the-accuracy-of-a-statistic-of-interest" class="section level4 unnumbered">
<h4>Estimating the Accuracy of a Statistic of Interest</h4>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="resampling-methods.html#cb381-1" aria-hidden="true" tabindex="-1"></a>portfolio <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Portfolio</span>
<span id="cb381-2"><a href="resampling-methods.html#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(portfolio)</span></code></pre></div>
<pre><code>## Rows: 100
## Columns: 2
## $ X &lt;dbl&gt; -0.89525089, -1.56245433, -0.41708988, 1.04435573, -0.31556841, -1.7…
## $ Y &lt;dbl&gt; -0.2349235, -0.8851760, 0.2718880, -0.7341975, 0.8419834, -2.0371910…</code></pre>
<p>The <code>tidymodels</code> approach to bootstrap estimates, as in <a href="resampling-methods.html#bootstrap-lab">5.2</a>:</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="resampling-methods.html#cb383-1" aria-hidden="true" tabindex="-1"></a>portfolio_boot <span class="ot">&lt;-</span> <span class="fu">bootstraps</span>(portfolio, <span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb383-2"><a href="resampling-methods.html#cb383-2" aria-hidden="true" tabindex="-1"></a>portfolio_boot_alpha <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb383-3"><a href="resampling-methods.html#cb383-3" aria-hidden="true" tabindex="-1"></a>  portfolio_boot<span class="sc">$</span>splits,</span>
<span id="cb383-4"><a href="resampling-methods.html#cb383-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(split) {</span>
<span id="cb383-5"><a href="resampling-methods.html#cb383-5" aria-hidden="true" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(split)</span>
<span id="cb383-6"><a href="resampling-methods.html#cb383-6" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">var</span>(xy<span class="sc">$</span>Y) <span class="sc">-</span> <span class="fu">cov</span>(xy<span class="sc">$</span>X, xy<span class="sc">$</span>Y)) <span class="sc">/</span></span>
<span id="cb383-7"><a href="resampling-methods.html#cb383-7" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">var</span>(xy<span class="sc">$</span>X) <span class="sc">+</span> <span class="fu">var</span>(xy<span class="sc">$</span>Y) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">cov</span>(xy<span class="sc">$</span>X, xy<span class="sc">$</span>Y))</span>
<span id="cb383-8"><a href="resampling-methods.html#cb383-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb383-9"><a href="resampling-methods.html#cb383-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb383-10"><a href="resampling-methods.html#cb383-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(portfolio_boot_alpha); <span class="fu">sd</span>(portfolio_boot_alpha)</span></code></pre></div>
<pre><code>## [1] 0.5784967</code></pre>
<pre><code>## [1] 0.08952573</code></pre>
</div>
<div id="estimating-the-accuracy-of-a-regression-model" class="section level4 unnumbered">
<h4>Estimating the Accuracy of a Regression Model</h4>
<blockquote>
<p>The bootstrap approach can be used to assess the variability of the coefficient estimates and predictions from a statistical learning method. Here we use the bootstrap approach in order to assess the variability of the estimates for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, the intercept and slope terms for the linear regression model that uses horsepower to predict mpg in the <code>Auto</code> data set. We will compare the estimates obtained using the bootstrap to those obtained using the formulas for <span class="math inline">\(\text{SE}(\hat{\beta}_0)\)</span> and <span class="math inline">\(\text{SE}(\hat{\beta}_1)\)</span> described in Section 3.1.2.</p>
</blockquote>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="resampling-methods.html#cb386-1" aria-hidden="true" tabindex="-1"></a>auto_boot <span class="ot">&lt;-</span> <span class="fu">bootstraps</span>(auto, <span class="at">times =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p>By default, the <code>tune::fit_resamples()</code> function does not keep the model object from each fit.
Usually, all we care about is the performance metrics and (if we’re tuning) the best hyper parameters.
So in order to get the actual regression coefficients, I need to provide a <code>control_grid()</code> object to the <code>control</code> argument of <code>fit_resamples()</code> (see <a href="https://www.tidymodels.org/learn/models/coefficients">this article for more explanation</a>):</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="resampling-methods.html#cb387-1" aria-hidden="true" tabindex="-1"></a>get_lm_coefs <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb387-2"><a href="resampling-methods.html#cb387-2" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">%&gt;%</span> <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb387-3"><a href="resampling-methods.html#cb387-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb387-4"><a href="resampling-methods.html#cb387-4" aria-hidden="true" tabindex="-1"></a>tidy_ctrl <span class="ot">&lt;-</span> <span class="fu">control_grid</span>(<span class="at">extract =</span> get_lm_coefs)</span></code></pre></div>
<p>Now fit the resamples with this with control object:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="resampling-methods.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb388-2"><a href="resampling-methods.html#cb388-2" aria-hidden="true" tabindex="-1"></a>auto_boot_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb388-3"><a href="resampling-methods.html#cb388-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb388-4"><a href="resampling-methods.html#cb388-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(<span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)) <span class="sc">%&gt;%</span></span>
<span id="cb388-5"><a href="resampling-methods.html#cb388-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(auto_boot, <span class="at">control =</span> tidy_ctrl)</span>
<span id="cb388-6"><a href="resampling-methods.html#cb388-6" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 72.1 sec elapsed</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="resampling-methods.html#cb390-1" aria-hidden="true" tabindex="-1"></a>auto_boot_fit <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   splits            id            .metrics         .notes           .extracts   
##   &lt;list&gt;            &lt;chr&gt;         &lt;list&gt;           &lt;list&gt;           &lt;list&gt;      
## 1 &lt;split [392/152]&gt; Bootstrap0001 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1 ~
## 2 &lt;split [392/145]&gt; Bootstrap0002 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1 ~
## 3 &lt;split [392/152]&gt; Bootstrap0003 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1 ~
## 4 &lt;split [392/154]&gt; Bootstrap0004 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1 ~
## 5 &lt;split [392/139]&gt; Bootstrap0005 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1 ~
## 6 &lt;split [392/138]&gt; Bootstrap0006 &lt;tibble [2 x 4]&gt; &lt;tibble [0 x 1]&gt; &lt;tibble [1 ~</code></pre>
<p>The <code>.extracts</code> column contains the tidy model objects.
It is a bit clunky to work with – it is a list column with a list of tibbles, so requires <code>tidyr::unnest()</code> twice:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="resampling-methods.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A single `.extracts` element, which contains a tibble</span></span>
<span id="cb392-2"><a href="resampling-methods.html#cb392-2" aria-hidden="true" tabindex="-1"></a>auto_boot_fit<span class="sc">$</span>.extracts[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   .extracts        .config             
##   &lt;list&gt;           &lt;chr&gt;               
## 1 &lt;tibble [2 × 5]&gt; Preprocessor1_Model1</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="resampling-methods.html#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using `unnest` to get all `.extracts`</span></span>
<span id="cb394-2"><a href="resampling-methods.html#cb394-2" aria-hidden="true" tabindex="-1"></a>auto_boot_fit_coefs <span class="ot">&lt;-</span> auto_boot_fit <span class="sc">%&gt;%</span></span>
<span id="cb394-3"><a href="resampling-methods.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb394-4"><a href="resampling-methods.html#cb394-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb394-5"><a href="resampling-methods.html#cb394-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, term, estimate, std.error)</span>
<span id="cb394-6"><a href="resampling-methods.html#cb394-6" aria-hidden="true" tabindex="-1"></a>auto_boot_fit_coefs <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 4
##   id            term        estimate std.error
##   &lt;chr&gt;         &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;
## 1 Bootstrap0001 (Intercept)   39.4     0.695  
## 2 Bootstrap0001 horsepower    -0.154   0.00601
## 3 Bootstrap0002 (Intercept)   37.6     0.665  
## 4 Bootstrap0002 horsepower    -0.139   0.00587
## 5 Bootstrap0003 (Intercept)   39.6     0.688  
## 6 Bootstrap0003 horsepower    -0.154   0.00620</code></pre>
<p>Then taking the mean of the estimates, and applying equation 5.8 to get the standard error:</p>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="resampling-methods.html#cb396-1" aria-hidden="true" tabindex="-1"></a>auto_boot_fit_coefs <span class="sc">%&gt;%</span></span>
<span id="cb396-2"><a href="resampling-methods.html#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb396-3"><a href="resampling-methods.html#cb396-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb396-4"><a href="resampling-methods.html#cb396-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_estimate =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb396-5"><a href="resampling-methods.html#cb396-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_estimate =</span> <span class="fu">sd</span>(estimate),</span>
<span id="cb396-6"><a href="resampling-methods.html#cb396-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb396-7"><a href="resampling-methods.html#cb396-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb396-8"><a href="resampling-methods.html#cb396-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb396-9"><a href="resampling-methods.html#cb396-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="ygtskbpuab" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ygtskbpuab .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ygtskbpuab .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ygtskbpuab .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ygtskbpuab .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ygtskbpuab .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ygtskbpuab .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ygtskbpuab .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ygtskbpuab .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ygtskbpuab .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ygtskbpuab .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ygtskbpuab .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ygtskbpuab .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ygtskbpuab .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ygtskbpuab .gt_from_md > :first-child {
  margin-top: 0;
}

#ygtskbpuab .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ygtskbpuab .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ygtskbpuab .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ygtskbpuab .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ygtskbpuab .gt_row_group_first td {
  border-top-width: 2px;
}

#ygtskbpuab .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygtskbpuab .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ygtskbpuab .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ygtskbpuab .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ygtskbpuab .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygtskbpuab .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ygtskbpuab .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ygtskbpuab .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ygtskbpuab .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ygtskbpuab .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygtskbpuab .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ygtskbpuab .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ygtskbpuab .gt_left {
  text-align: left;
}

#ygtskbpuab .gt_center {
  text-align: center;
}

#ygtskbpuab .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ygtskbpuab .gt_font_normal {
  font-weight: normal;
}

#ygtskbpuab .gt_font_bold {
  font-weight: bold;
}

#ygtskbpuab .gt_font_italic {
  font-style: italic;
}

#ygtskbpuab .gt_super {
  font-size: 65%;
}

#ygtskbpuab .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#ygtskbpuab .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#ygtskbpuab .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ygtskbpuab .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#ygtskbpuab .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#ygtskbpuab .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">39.9855</td>
<td class="gt_row gt_right">0.8707</td></tr>
    <tr><td class="gt_row gt_left">horsepower</td>
<td class="gt_row gt_right">&minus;0.1583</td>
<td class="gt_row gt_right">0.0075</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Not exactly the same as those in the text due to the difference in the random bootstrap samples.
And here are the SE estimates using the formula from section 3.1.2:</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="resampling-methods.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)) <span class="sc">%&gt;%</span></span>
<span id="cb397-2"><a href="resampling-methods.html#cb397-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se_estimate =</span> std.error) <span class="sc">%&gt;%</span></span>
<span id="cb397-3"><a href="resampling-methods.html#cb397-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb397-4"><a href="resampling-methods.html#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="qtmzcvzhec" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qtmzcvzhec .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qtmzcvzhec .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qtmzcvzhec .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qtmzcvzhec .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qtmzcvzhec .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtmzcvzhec .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qtmzcvzhec .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qtmzcvzhec .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qtmzcvzhec .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qtmzcvzhec .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qtmzcvzhec .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qtmzcvzhec .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qtmzcvzhec .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qtmzcvzhec .gt_from_md > :first-child {
  margin-top: 0;
}

#qtmzcvzhec .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qtmzcvzhec .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qtmzcvzhec .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qtmzcvzhec .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qtmzcvzhec .gt_row_group_first td {
  border-top-width: 2px;
}

#qtmzcvzhec .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtmzcvzhec .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qtmzcvzhec .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qtmzcvzhec .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtmzcvzhec .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtmzcvzhec .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qtmzcvzhec .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qtmzcvzhec .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qtmzcvzhec .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qtmzcvzhec .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtmzcvzhec .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qtmzcvzhec .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qtmzcvzhec .gt_left {
  text-align: left;
}

#qtmzcvzhec .gt_center {
  text-align: center;
}

#qtmzcvzhec .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qtmzcvzhec .gt_font_normal {
  font-weight: normal;
}

#qtmzcvzhec .gt_font_bold {
  font-weight: bold;
}

#qtmzcvzhec .gt_font_italic {
  font-style: italic;
}

#qtmzcvzhec .gt_super {
  font-size: 65%;
}

#qtmzcvzhec .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#qtmzcvzhec .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qtmzcvzhec .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qtmzcvzhec .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#qtmzcvzhec .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#qtmzcvzhec .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">39.9359</td>
<td class="gt_row gt_right">0.7175</td></tr>
    <tr><td class="gt_row gt_left">horsepower</td>
<td class="gt_row gt_right">&minus;0.1578</td>
<td class="gt_row gt_right">0.0064</td></tr>
  </tbody>
  
  
</table>
</div>
<p>These estimates are similar, but you wouldn’t be considered close.</p>
<blockquote>
<p>Does this indicate a problem with the bootstrap? In fact, it suggests the opposite. Recall that the standard formulas given in Equation 3.8 on page 66 rely on certain assumptions. For example, they depend on the unknown parameter <span class="math inline">\(\sigma^2\)</span>, the noise variance. We then estimate <span class="math inline">\(\sigma^2\)</span> using the RSS. Now although the formulas for the standard errors do not rely on the linear model being correct, the estimate for <span class="math inline">\(\sigma^2\)</span> does. We see in
Figure 3.8 on page 91 that there is a non-linear relationship in the data, and so the residuals from a linear fit will be inflated, and so will <span class="math inline">\(\hat{\sigma}^2\)</span>. Secondly, the standard formulas assume (somewhat unrealistically) that the <span class="math inline">\(x_i\)</span> are fixed, and all the variability comes from the variation in the errors <span class="math inline">\(\epsilon_i\)</span>. The bootstrap approach does not rely on any of these assumptions, and so it is likely giving a more accurate estimate of the standard errors of <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> than is the <code>summary()</code> function.</p>
</blockquote>
<p>We can find better correspondence between bootstrap and regression estimates if we use the quadratic model because it better fits the data:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="resampling-methods.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb398-2"><a href="resampling-methods.html#cb398-2" aria-hidden="true" tabindex="-1"></a>auto_boot_quad_fit <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb398-3"><a href="resampling-methods.html#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb398-4"><a href="resampling-methods.html#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(</span>
<span id="cb398-5"><a href="resampling-methods.html#cb398-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto) <span class="sc">%&gt;%</span></span>
<span id="cb398-6"><a href="resampling-methods.html#cb398-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Need to set `raw` = TRUE to not use orthogonal polynomials</span></span>
<span id="cb398-7"><a href="resampling-methods.html#cb398-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">step_poly</span>(horsepower, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">raw =</span> <span class="cn">TRUE</span>))</span>
<span id="cb398-8"><a href="resampling-methods.html#cb398-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb398-9"><a href="resampling-methods.html#cb398-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(auto_boot, <span class="at">control =</span> tidy_ctrl)</span>
<span id="cb398-10"><a href="resampling-methods.html#cb398-10" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 76.58 sec elapsed</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="resampling-methods.html#cb400-1" aria-hidden="true" tabindex="-1"></a>auto_boot_quad_fit <span class="sc">%&gt;%</span></span>
<span id="cb400-2"><a href="resampling-methods.html#cb400-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb400-3"><a href="resampling-methods.html#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(.extracts) <span class="sc">%&gt;%</span></span>
<span id="cb400-4"><a href="resampling-methods.html#cb400-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb400-5"><a href="resampling-methods.html#cb400-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb400-6"><a href="resampling-methods.html#cb400-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_estimate =</span> <span class="fu">mean</span>(estimate),</span>
<span id="cb400-7"><a href="resampling-methods.html#cb400-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">se_estimate =</span> <span class="fu">sd</span>(estimate),</span>
<span id="cb400-8"><a href="resampling-methods.html#cb400-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span></span>
<span id="cb400-9"><a href="resampling-methods.html#cb400-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb400-10"><a href="resampling-methods.html#cb400-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb400-11"><a href="resampling-methods.html#cb400-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="uyasfyvmkp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#uyasfyvmkp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uyasfyvmkp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uyasfyvmkp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uyasfyvmkp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uyasfyvmkp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uyasfyvmkp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uyasfyvmkp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uyasfyvmkp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uyasfyvmkp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uyasfyvmkp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uyasfyvmkp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uyasfyvmkp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#uyasfyvmkp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uyasfyvmkp .gt_from_md > :first-child {
  margin-top: 0;
}

#uyasfyvmkp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uyasfyvmkp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uyasfyvmkp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#uyasfyvmkp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#uyasfyvmkp .gt_row_group_first td {
  border-top-width: 2px;
}

#uyasfyvmkp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uyasfyvmkp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#uyasfyvmkp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#uyasfyvmkp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uyasfyvmkp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uyasfyvmkp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uyasfyvmkp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uyasfyvmkp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uyasfyvmkp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uyasfyvmkp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uyasfyvmkp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uyasfyvmkp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#uyasfyvmkp .gt_left {
  text-align: left;
}

#uyasfyvmkp .gt_center {
  text-align: center;
}

#uyasfyvmkp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uyasfyvmkp .gt_font_normal {
  font-weight: normal;
}

#uyasfyvmkp .gt_font_bold {
  font-weight: bold;
}

#uyasfyvmkp .gt_font_italic {
  font-style: italic;
}

#uyasfyvmkp .gt_super {
  font-size: 65%;
}

#uyasfyvmkp .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#uyasfyvmkp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#uyasfyvmkp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#uyasfyvmkp .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#uyasfyvmkp .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#uyasfyvmkp .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">56.9755</td>
<td class="gt_row gt_right">2.1490</td></tr>
    <tr><td class="gt_row gt_left">horsepower_poly_1</td>
<td class="gt_row gt_right">&minus;0.4673</td>
<td class="gt_row gt_right">0.0340</td></tr>
    <tr><td class="gt_row gt_left">horsepower_poly_2</td>
<td class="gt_row gt_right">0.0012</td>
<td class="gt_row gt_right">0.0001</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="resampling-methods.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need to set `raw` = TRUE to not use orthogonal polynomials</span></span>
<span id="cb401-2"><a href="resampling-methods.html#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">lm</span>(mpg <span class="sc">~</span> <span class="fu">poly</span>(horsepower, <span class="dv">2</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> auto)) <span class="sc">%&gt;%</span></span>
<span id="cb401-3"><a href="resampling-methods.html#cb401-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se_estimate =</span> std.error) <span class="sc">%&gt;%</span></span>
<span id="cb401-4"><a href="resampling-methods.html#cb401-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb401-5"><a href="resampling-methods.html#cb401-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">decimals =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="zkvxoecmrv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zkvxoecmrv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zkvxoecmrv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zkvxoecmrv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zkvxoecmrv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zkvxoecmrv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zkvxoecmrv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zkvxoecmrv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zkvxoecmrv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zkvxoecmrv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zkvxoecmrv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zkvxoecmrv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zkvxoecmrv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zkvxoecmrv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zkvxoecmrv .gt_from_md > :first-child {
  margin-top: 0;
}

#zkvxoecmrv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zkvxoecmrv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zkvxoecmrv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zkvxoecmrv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zkvxoecmrv .gt_row_group_first td {
  border-top-width: 2px;
}

#zkvxoecmrv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkvxoecmrv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zkvxoecmrv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zkvxoecmrv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zkvxoecmrv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkvxoecmrv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zkvxoecmrv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zkvxoecmrv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zkvxoecmrv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zkvxoecmrv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkvxoecmrv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zkvxoecmrv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zkvxoecmrv .gt_left {
  text-align: left;
}

#zkvxoecmrv .gt_center {
  text-align: center;
}

#zkvxoecmrv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zkvxoecmrv .gt_font_normal {
  font-weight: normal;
}

#zkvxoecmrv .gt_font_bold {
  font-weight: bold;
}

#zkvxoecmrv .gt_font_italic {
  font-style: italic;
}

#zkvxoecmrv .gt_super {
  font-size: 65%;
}

#zkvxoecmrv .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#zkvxoecmrv .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#zkvxoecmrv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zkvxoecmrv .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#zkvxoecmrv .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#zkvxoecmrv .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">56.9001</td>
<td class="gt_row gt_right">1.8004</td></tr>
    <tr><td class="gt_row gt_left">poly(horsepower, 2, raw = TRUE)1</td>
<td class="gt_row gt_right">&minus;0.4662</td>
<td class="gt_row gt_right">0.0311</td></tr>
    <tr><td class="gt_row gt_left">poly(horsepower, 2, raw = TRUE)2</td>
<td class="gt_row gt_right">0.0012</td>
<td class="gt_row gt_right">0.0001</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="exercises-2" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Exercises</h2>
<div id="applied-2" class="section level3 unnumbered">
<h3>Applied</h3>
<div id="logistic-regression-with-default---validation-set" class="section level4 unnumbered">
<h4>5. Logistic regression with <code>default</code> - validation set</h4>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="resampling-methods.html#cb402-1" aria-hidden="true" tabindex="-1"></a>default <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Default</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Fit a logistic regression model that uses <code>income</code> and <code>balance</code> to predict <code>default</code>.</li>
</ol>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="resampling-methods.html#cb403-1" aria-hidden="true" tabindex="-1"></a>default_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb403-2"><a href="resampling-methods.html#cb403-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">logistic_reg</span>(<span class="at">mode =</span> <span class="st">&quot;classification&quot;</span>, <span class="at">engine =</span> <span class="st">&quot;glm&quot;</span>))</span>
<span id="cb403-3"><a href="resampling-methods.html#cb403-3" aria-hidden="true" tabindex="-1"></a>default_rec <span class="ot">&lt;-</span> <span class="fu">recipe</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance, <span class="at">data =</span> default)</span>
<span id="cb403-4"><a href="resampling-methods.html#cb403-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-5"><a href="resampling-methods.html#cb403-5" aria-hidden="true" tabindex="-1"></a>default_fit <span class="ot">&lt;-</span> default_workflow <span class="sc">%&gt;%</span></span>
<span id="cb403-6"><a href="resampling-methods.html#cb403-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(default_rec) <span class="sc">%&gt;%</span></span>
<span id="cb403-7"><a href="resampling-methods.html#cb403-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> default)</span>
<span id="cb403-8"><a href="resampling-methods.html#cb403-8" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_fit_parsnip</span>(default_fit)</span></code></pre></div>
<pre><code>## parsnip model object
## 
## 
## Call:  stats::glm(formula = ..y ~ ., family = stats::binomial, data = data)
## 
## Coefficients:
## (Intercept)       income      balance  
##  -1.154e+01    2.081e-05    5.647e-03  
## 
## Degrees of Freedom: 9999 Total (i.e. Null);  9997 Residual
## Null Deviance:       2921 
## Residual Deviance: 1579  AIC: 1585</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Using the validation set approach, estimate the test error of this model.</li>
</ol>
<p>Set seed and split:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="resampling-methods.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">940</span>)</span>
<span id="cb405-2"><a href="resampling-methods.html#cb405-2" aria-hidden="true" tabindex="-1"></a>default_splits <span class="ot">&lt;-</span> <span class="fu">validation_split</span>(default, <span class="at">prop =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p>Fit and evaluate the model with the hold out:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="resampling-methods.html#cb406-1" aria-hidden="true" tabindex="-1"></a>default_fit_validation <span class="ot">&lt;-</span> default_workflow <span class="sc">%&gt;%</span></span>
<span id="cb406-2"><a href="resampling-methods.html#cb406-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(default_rec) <span class="sc">%&gt;%</span></span>
<span id="cb406-3"><a href="resampling-methods.html#cb406-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(default_splits)</span>
<span id="cb406-4"><a href="resampling-methods.html#cb406-4" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(default_fit_validation)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric  .estimator  mean     n std_err .config             
##   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary     0.973     1      NA Preprocessor1_Model1
## 2 roc_auc  binary     0.949     1      NA Preprocessor1_Model1</code></pre>
<p>The accuracy of the model is
97.26%
and so the test error is
2.74%.</p>
<p>The <code>tidymodels</code> workflow made fitting and assessing this model very easy – just 5 lines of code.
For comparison purposes, here is how you could do it without <code>tidymodels</code> (excluding the data splitting part):</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="resampling-methods.html#cb408-1" aria-hidden="true" tabindex="-1"></a>default_train <span class="ot">&lt;-</span> <span class="fu">training</span>(default_splits<span class="sc">$</span>splits[[<span class="dv">1</span>]])</span>
<span id="cb408-2"><a href="resampling-methods.html#cb408-2" aria-hidden="true" tabindex="-1"></a>default_assess <span class="ot">&lt;-</span> <span class="fu">assessment</span>(default_splits<span class="sc">$</span>splits[[<span class="dv">1</span>]])</span>
<span id="cb408-3"><a href="resampling-methods.html#cb408-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-4"><a href="resampling-methods.html#cb408-4" aria-hidden="true" tabindex="-1"></a>default_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance, <span class="at">data =</span> default_train,</span>
<span id="cb408-5"><a href="resampling-methods.html#cb408-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb408-6"><a href="resampling-methods.html#cb408-6" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(default_glm, <span class="at">newdata =</span> default_assess, <span class="at">type.predict =</span> <span class="st">&quot;response&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb408-7"><a href="resampling-methods.html#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">default_pred =</span> <span class="fu">ifelse</span>(.fitted <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb408-8"><a href="resampling-methods.html#cb408-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">error_rate =</span> <span class="fu">mean</span>(default <span class="sc">!=</span> default_pred)) <span class="sc">%&gt;%</span></span>
<span id="cb408-9"><a href="resampling-methods.html#cb408-9" aria-hidden="true" tabindex="-1"></a>  .<span class="sc">$</span>error_rate <span class="sc">%&gt;%</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="at">accuracy =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<pre><code>## [1] &quot;2.74%&quot;</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Repeat the process in (b) three times, using three different splits of the observations. Comment on the results.</li>
</ol>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="resampling-methods.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">109</span>)</span>
<span id="cb410-2"><a href="resampling-methods.html#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb410-3"><a href="resampling-methods.html#cb410-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect_metrics</span>(default_fit_validation) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">rep =</span> <span class="dv">1</span>),</span>
<span id="cb410-4"><a href="resampling-methods.html#cb410-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb410-5"><a href="resampling-methods.html#cb410-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">function</span>(rep) {</span>
<span id="cb410-6"><a href="resampling-methods.html#cb410-6" aria-hidden="true" tabindex="-1"></a>      default_workflow <span class="sc">%&gt;%</span></span>
<span id="cb410-7"><a href="resampling-methods.html#cb410-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">add_recipe</span>(default_rec) <span class="sc">%&gt;%</span></span>
<span id="cb410-8"><a href="resampling-methods.html#cb410-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fit_resamples</span>(<span class="fu">validation_split</span>(default, <span class="at">prop =</span> <span class="fl">0.5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb410-9"><a href="resampling-methods.html#cb410-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">collect_metrics</span>() <span class="sc">%&gt;%</span></span>
<span id="cb410-10"><a href="resampling-methods.html#cb410-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">rep =</span> rep)</span>
<span id="cb410-11"><a href="resampling-methods.html#cb410-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb410-12"><a href="resampling-methods.html#cb410-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb410-13"><a href="resampling-methods.html#cb410-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb410-14"><a href="resampling-methods.html#cb410-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">&quot;accuracy&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb410-15"><a href="resampling-methods.html#cb410-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb410-16"><a href="resampling-methods.html#cb410-16" aria-hidden="true" tabindex="-1"></a>    rep,</span>
<span id="cb410-17"><a href="resampling-methods.html#cb410-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> scales<span class="sc">::</span><span class="fu">percent</span>(mean, <span class="at">accuracy =</span> <span class="fl">0.01</span>),</span>
<span id="cb410-18"><a href="resampling-methods.html#cb410-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">test_error =</span> scales<span class="sc">::</span><span class="fu">percent</span>(<span class="dv">1</span> <span class="sc">-</span> mean, <span class="at">accuracy =</span> <span class="fl">0.01</span>)</span>
<span id="cb410-19"><a href="resampling-methods.html#cb410-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb410-20"><a href="resampling-methods.html#cb410-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="zqpjldwoxf" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zqpjldwoxf .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zqpjldwoxf .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zqpjldwoxf .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zqpjldwoxf .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zqpjldwoxf .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqpjldwoxf .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zqpjldwoxf .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zqpjldwoxf .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zqpjldwoxf .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zqpjldwoxf .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zqpjldwoxf .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zqpjldwoxf .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zqpjldwoxf .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zqpjldwoxf .gt_from_md > :first-child {
  margin-top: 0;
}

#zqpjldwoxf .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zqpjldwoxf .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zqpjldwoxf .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#zqpjldwoxf .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#zqpjldwoxf .gt_row_group_first td {
  border-top-width: 2px;
}

#zqpjldwoxf .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqpjldwoxf .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#zqpjldwoxf .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#zqpjldwoxf .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqpjldwoxf .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqpjldwoxf .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zqpjldwoxf .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zqpjldwoxf .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zqpjldwoxf .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zqpjldwoxf .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqpjldwoxf .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zqpjldwoxf .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#zqpjldwoxf .gt_left {
  text-align: left;
}

#zqpjldwoxf .gt_center {
  text-align: center;
}

#zqpjldwoxf .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zqpjldwoxf .gt_font_normal {
  font-weight: normal;
}

#zqpjldwoxf .gt_font_bold {
  font-weight: bold;
}

#zqpjldwoxf .gt_font_italic {
  font-style: italic;
}

#zqpjldwoxf .gt_super {
  font-size: 65%;
}

#zqpjldwoxf .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#zqpjldwoxf .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#zqpjldwoxf .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#zqpjldwoxf .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#zqpjldwoxf .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#zqpjldwoxf .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rep</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">accuracy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">test_error</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">97.26%</td>
<td class="gt_row gt_left">2.74%</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">97.52%</td>
<td class="gt_row gt_left">2.48%</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">97.46%</td>
<td class="gt_row gt_left">2.54%</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_left">97.26%</td>
<td class="gt_row gt_left">2.74%</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The estimates are actually quite stable.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Add the dummy variable <code>student</code> to the logistic regression model. Comment on whether or not this leads to a reduction in the test error rate.</li>
</ol>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="resampling-methods.html#cb411-1" aria-hidden="true" tabindex="-1"></a>default_rec_student <span class="ot">&lt;-</span></span>
<span id="cb411-2"><a href="resampling-methods.html#cb411-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance <span class="sc">+</span> student, <span class="at">data =</span> default) <span class="sc">%&gt;%</span></span>
<span id="cb411-3"><a href="resampling-methods.html#cb411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(student)</span>
<span id="cb411-4"><a href="resampling-methods.html#cb411-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-5"><a href="resampling-methods.html#cb411-5" aria-hidden="true" tabindex="-1"></a>default_fit_validation_student <span class="ot">&lt;-</span> default_workflow <span class="sc">%&gt;%</span></span>
<span id="cb411-6"><a href="resampling-methods.html#cb411-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(default_rec_student) <span class="sc">%&gt;%</span></span>
<span id="cb411-7"><a href="resampling-methods.html#cb411-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit_resamples</span>(default_splits)</span>
<span id="cb411-8"><a href="resampling-methods.html#cb411-8" aria-hidden="true" tabindex="-1"></a><span class="fu">collect_metrics</span>(default_fit_validation_student)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   .metric  .estimator  mean     n std_err .config             
##   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary     0.972     1      NA Preprocessor1_Model1
## 2 roc_auc  binary     0.949     1      NA Preprocessor1_Model1</code></pre>
<p>Adding the <code>student</code> variable resulted in a test error rate of
2.78%
and so did not lead to a reduction compared to the original model.</p>
</div>
<div id="logistic-regression-with-default---standard-error-estimation" class="section level4 unnumbered">
<h4>6. Logistic regression with <code>default</code> - standard error estimation</h4>
<ol style="list-style-type: lower-alpha">
<li>Determine the estimated standard errors for the coefficients using <code>summary()</code> and <code>glm()</code>.</li>
</ol>
<p>Here it is in base R:</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="resampling-methods.html#cb413-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance, <span class="at">data =</span> default, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb413-2"><a href="resampling-methods.html#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = default ~ income + balance, family = &quot;binomial&quot;, 
##     data = default)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4725  -0.1444  -0.0574  -0.0211   3.7245  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.154e+01  4.348e-01 -26.545  &lt; 2e-16 ***
## income       2.081e-05  4.985e-06   4.174 2.99e-05 ***
## balance      5.647e-03  2.274e-04  24.836  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1579.0  on 9997  degrees of freedom
## AIC: 1585
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<p>In <code>tidymodels</code>, I can use the <code>extract_fit_engine()</code> function to get the same:</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="resampling-methods.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb415-2"><a href="resampling-methods.html#cb415-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance, <span class="at">data =</span> default) <span class="sc">%&gt;%</span></span>
<span id="cb415-3"><a href="resampling-methods.html#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb415-4"><a href="resampling-methods.html#cb415-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## stats::glm(formula = default ~ income + balance, family = stats::binomial, 
##     data = data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.4725  -0.1444  -0.0574  -0.0211   3.7245  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.154e+01  4.348e-01 -26.545  &lt; 2e-16 ***
## income       2.081e-05  4.985e-06   4.174 2.99e-05 ***
## balance      5.647e-03  2.274e-04  24.836  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 2920.6  on 9999  degrees of freedom
## Residual deviance: 1579.0  on 9997  degrees of freedom
## AIC: 1585
## 
## Number of Fisher Scoring iterations: 8</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Write a function that takes as input the <code>default</code> data set as well as the index of the observations, and that outputs the coefficient estimates for <code>income</code> and <code>balance</code> in the multiple logistic regression model.</li>
</ol>
<p>Instead of the workflow I used in <a href="resampling-methods.html#bootstrap-lab">5.2</a> (with <code>fit_resamples()</code>), I’ll show a different way.
First, a function that takes a <code>split</code> object (a bootstrap sample), fits the model and returns the tidy regression coefficients:</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="resampling-methods.html#cb417-1" aria-hidden="true" tabindex="-1"></a>get_tidy_default_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(split) {</span>
<span id="cb417-2"><a href="resampling-methods.html#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb417-3"><a href="resampling-methods.html#cb417-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fit</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance, <span class="at">data =</span> <span class="fu">as.data.frame</span>(split)) <span class="sc">%&gt;%</span></span>
<span id="cb417-4"><a href="resampling-methods.html#cb417-4" aria-hidden="true" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>()</span>
<span id="cb417-5"><a href="resampling-methods.html#cb417-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Get the bootstrap estimates for the standard errors.</li>
</ol>
<p>Now I use <code>purrr::map()</code> to fit the models using the function from (b):</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="resampling-methods.html#cb418-1" aria-hidden="true" tabindex="-1"></a>default_boot <span class="ot">&lt;-</span> <span class="fu">bootstraps</span>(default, <span class="at">times =</span> <span class="dv">100</span>)</span></code></pre></div>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="resampling-methods.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb419-2"><a href="resampling-methods.html#cb419-2" aria-hidden="true" tabindex="-1"></a>default_fits <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(</span>
<span id="cb419-3"><a href="resampling-methods.html#cb419-3" aria-hidden="true" tabindex="-1"></a>  default_boot<span class="sc">$</span>splits, get_tidy_default_fit,</span>
<span id="cb419-4"><a href="resampling-methods.html#cb419-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">&quot;split&quot;</span></span>
<span id="cb419-5"><a href="resampling-methods.html#cb419-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb419-6"><a href="resampling-methods.html#cb419-6" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 291.56 sec elapsed</code></pre>
<p>Then estimate the standard errors of the coefficients:</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="resampling-methods.html#cb421-1" aria-hidden="true" tabindex="-1"></a>default_fits <span class="sc">%&gt;%</span></span>
<span id="cb421-2"><a href="resampling-methods.html#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(term) <span class="sc">%&gt;%</span></span>
<span id="cb421-3"><a href="resampling-methods.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_estimate =</span> <span class="fu">mean</span>(estimate), <span class="at">se_estimate =</span> <span class="fu">sd</span>(estimate)) <span class="sc">%&gt;%</span></span>
<span id="cb421-4"><a href="resampling-methods.html#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb421-5"><a href="resampling-methods.html#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">n_sigfig =</span> <span class="dv">3</span>)</span></code></pre></div>
<div id="xybuvpvhkb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xybuvpvhkb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xybuvpvhkb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xybuvpvhkb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xybuvpvhkb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xybuvpvhkb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xybuvpvhkb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xybuvpvhkb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xybuvpvhkb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xybuvpvhkb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xybuvpvhkb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xybuvpvhkb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xybuvpvhkb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xybuvpvhkb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xybuvpvhkb .gt_from_md > :first-child {
  margin-top: 0;
}

#xybuvpvhkb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xybuvpvhkb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xybuvpvhkb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xybuvpvhkb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xybuvpvhkb .gt_row_group_first td {
  border-top-width: 2px;
}

#xybuvpvhkb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xybuvpvhkb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xybuvpvhkb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xybuvpvhkb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xybuvpvhkb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xybuvpvhkb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xybuvpvhkb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xybuvpvhkb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xybuvpvhkb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xybuvpvhkb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xybuvpvhkb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xybuvpvhkb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xybuvpvhkb .gt_left {
  text-align: left;
}

#xybuvpvhkb .gt_center {
  text-align: center;
}

#xybuvpvhkb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xybuvpvhkb .gt_font_normal {
  font-weight: normal;
}

#xybuvpvhkb .gt_font_bold {
  font-weight: bold;
}

#xybuvpvhkb .gt_font_italic {
  font-style: italic;
}

#xybuvpvhkb .gt_super {
  font-size: 65%;
}

#xybuvpvhkb .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#xybuvpvhkb .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xybuvpvhkb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xybuvpvhkb .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#xybuvpvhkb .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#xybuvpvhkb .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mean_estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">&minus;11.6</td>
<td class="gt_row gt_right">0.443</td></tr>
    <tr><td class="gt_row gt_left">balance</td>
<td class="gt_row gt_right">0.00566</td>
<td class="gt_row gt_right">0.000235</td></tr>
    <tr><td class="gt_row gt_left">income</td>
<td class="gt_row gt_right">0.0000210</td>
<td class="gt_row gt_right">0.00000492</td></tr>
  </tbody>
  
  
</table>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Comment on the estimated standard errors obtained using the <code>glm()</code> function and using your bootstrap function.</li>
</ol>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="resampling-methods.html#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(default <span class="sc">~</span> income <span class="sc">+</span> balance, <span class="at">data =</span> default, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb422-2"><a href="resampling-methods.html#cb422-2" aria-hidden="true" tabindex="-1"></a>  broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb422-3"><a href="resampling-methods.html#cb422-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(term, estimate, <span class="at">se_estimate =</span> std.error) <span class="sc">%&gt;%</span></span>
<span id="cb422-4"><a href="resampling-methods.html#cb422-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb422-5"><a href="resampling-methods.html#cb422-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">columns =</span> <span class="sc">-</span>term, <span class="at">n_sigfig =</span> <span class="dv">3</span>)</span></code></pre></div>
<div id="qotavlpmco" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qotavlpmco .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qotavlpmco .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qotavlpmco .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qotavlpmco .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qotavlpmco .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qotavlpmco .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qotavlpmco .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qotavlpmco .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qotavlpmco .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qotavlpmco .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qotavlpmco .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qotavlpmco .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qotavlpmco .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qotavlpmco .gt_from_md > :first-child {
  margin-top: 0;
}

#qotavlpmco .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qotavlpmco .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qotavlpmco .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qotavlpmco .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qotavlpmco .gt_row_group_first td {
  border-top-width: 2px;
}

#qotavlpmco .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qotavlpmco .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qotavlpmco .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qotavlpmco .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qotavlpmco .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qotavlpmco .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qotavlpmco .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qotavlpmco .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qotavlpmco .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qotavlpmco .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qotavlpmco .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qotavlpmco .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qotavlpmco .gt_left {
  text-align: left;
}

#qotavlpmco .gt_center {
  text-align: center;
}

#qotavlpmco .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qotavlpmco .gt_font_normal {
  font-weight: normal;
}

#qotavlpmco .gt_font_bold {
  font-weight: bold;
}

#qotavlpmco .gt_font_italic {
  font-style: italic;
}

#qotavlpmco .gt_super {
  font-size: 65%;
}

#qotavlpmco .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#qotavlpmco .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#qotavlpmco .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qotavlpmco .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#qotavlpmco .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#qotavlpmco .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">se_estimate</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">&minus;11.5</td>
<td class="gt_row gt_right">0.435</td></tr>
    <tr><td class="gt_row gt_left">income</td>
<td class="gt_row gt_right">0.0000208</td>
<td class="gt_row gt_right">0.00000499</td></tr>
    <tr><td class="gt_row gt_left">balance</td>
<td class="gt_row gt_right">0.00565</td>
<td class="gt_row gt_right">0.000227</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The estimates are essentially the same between the two methods.</p>
</div>
<div id="loocv-with-weekly" class="section level4 unnumbered">
<h4>7. LOOCV with <code>weekly</code></h4>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="resampling-methods.html#cb423-1" aria-hidden="true" tabindex="-1"></a>weekly <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Weekly</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Fit a logistic regression model that predicts <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code>.</li>
</ol>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="resampling-methods.html#cb424-1" aria-hidden="true" tabindex="-1"></a>direction_fit <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb424-2"><a href="resampling-methods.html#cb424-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2, <span class="at">data =</span> weekly)</span>
<span id="cb424-3"><a href="resampling-methods.html#cb424-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(direction_fit)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   0.221     0.0615      3.60 0.000319
## 2 Lag1         -0.0387    0.0262     -1.48 0.140   
## 3 Lag2          0.0602    0.0265      2.27 0.0232</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit the same model using all but the first observation.</li>
</ol>
<p>A shortcut to getting all but the first row of a data frame is <code>tail(df, -1)</code>:</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="resampling-methods.html#cb426-1" aria-hidden="true" tabindex="-1"></a>direction_fit_1 <span class="ot">&lt;-</span> <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb426-2"><a href="resampling-methods.html#cb426-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2, <span class="at">data =</span> <span class="fu">tail</span>(weekly, <span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb426-3"><a href="resampling-methods.html#cb426-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(direction_fit_1)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   0.223     0.0615      3.63 0.000283
## 2 Lag1         -0.0384    0.0262     -1.47 0.143   
## 3 Lag2          0.0608    0.0266      2.29 0.0220</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Use the model from (b) to predict the direction of the first observation. Was this observation correctly classified?</li>
</ol>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="resampling-methods.html#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(direction_fit_1, <span class="at">new_data =</span> <span class="fu">head</span>(weekly, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb428-2"><a href="resampling-methods.html#cb428-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Lag1, Lag2, Direction, .pred_class, .pred_Down, .pred_Up)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 6
##    Lag1  Lag2 Direction .pred_class .pred_Down .pred_Up
##   &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;            &lt;dbl&gt;    &lt;dbl&gt;
## 1 0.816  1.57 Down      Up               0.429    0.571</code></pre>
<p>It was predicted as “Up”, which is incorrect.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Write a for loop from <span class="math inline">\(i = 1\)</span> to <span class="math inline">\(i = n\)</span>, where <span class="math inline">\(n\)</span> is the number of observations in the data set, that fits a model using all but the <span class="math inline">\(i\)</span>th observation to prediction <code>Direction</code>. Then use that fit to predict the <code>Direction</code> of the held out observation.</li>
</ol>
<p>Instead of a for loop, I’ll use <code>purrr</code>:</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="resampling-methods.html#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb430-2"><a href="resampling-methods.html#cb430-2" aria-hidden="true" tabindex="-1"></a>direction_loocv_preds <span class="ot">&lt;-</span></span>
<span id="cb430-3"><a href="resampling-methods.html#cb430-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(</span>
<span id="cb430-4"><a href="resampling-methods.html#cb430-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(weekly),</span>
<span id="cb430-5"><a href="resampling-methods.html#cb430-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb430-6"><a href="resampling-methods.html#cb430-6" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Fit with `slice` to exclude the single row (`-.x`)</span></span>
<span id="cb430-7"><a href="resampling-methods.html#cb430-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fit</span>(Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2, <span class="at">data =</span> <span class="fu">slice</span>(weekly, <span class="sc">-</span>.x)) <span class="sc">%&gt;%</span></span>
<span id="cb430-8"><a href="resampling-methods.html#cb430-8" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Predict with `slice` to get just that row (`.x`)</span></span>
<span id="cb430-9"><a href="resampling-methods.html#cb430-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">augment</span>(<span class="at">new_data =</span> <span class="fu">slice</span>(weekly, .x)) <span class="sc">%&gt;%</span></span>
<span id="cb430-10"><a href="resampling-methods.html#cb430-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(Lag1, Lag2, Direction, <span class="fu">starts_with</span>(<span class="st">&quot;.pred&quot;</span>)),</span>
<span id="cb430-11"><a href="resampling-methods.html#cb430-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;i&quot;</span></span>
<span id="cb430-12"><a href="resampling-methods.html#cb430-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb430-13"><a href="resampling-methods.html#cb430-13" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 296.35 sec elapsed</code></pre>
<p>When running long computations in an iterative way (with a for loop or mapping with <code>purrr</code>), it is very easy to take advantage of parallel computing with <code>future</code> and <code>furrr</code>:</p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="resampling-methods.html#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(future)</span>
<span id="cb432-2"><a href="resampling-methods.html#cb432-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use all but one of my cores</span></span>
<span id="cb432-3"><a href="resampling-methods.html#cb432-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plan</span>(<span class="fu">multisession</span>(<span class="at">workers =</span> <span class="fu">availableCores</span>() <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb432-4"><a href="resampling-methods.html#cb432-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-5"><a href="resampling-methods.html#cb432-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb432-6"><a href="resampling-methods.html#cb432-6" aria-hidden="true" tabindex="-1"></a>direction_loocv_preds <span class="ot">&lt;-</span></span>
<span id="cb432-7"><a href="resampling-methods.html#cb432-7" aria-hidden="true" tabindex="-1"></a>  furrr<span class="sc">::</span><span class="fu">future_map_dfr</span>(</span>
<span id="cb432-8"><a href="resampling-methods.html#cb432-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(weekly),</span>
<span id="cb432-9"><a href="resampling-methods.html#cb432-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb432-10"><a href="resampling-methods.html#cb432-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fit</span>(Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2, <span class="at">data =</span> <span class="fu">slice</span>(weekly, <span class="sc">-</span>.x)) <span class="sc">%&gt;%</span></span>
<span id="cb432-11"><a href="resampling-methods.html#cb432-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">augment</span>(<span class="at">new_data =</span> <span class="fu">slice</span>(weekly, .x)) <span class="sc">%&gt;%</span></span>
<span id="cb432-12"><a href="resampling-methods.html#cb432-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(Lag1, Lag2, Direction, <span class="fu">starts_with</span>(<span class="st">&quot;.pred&quot;</span>)),</span>
<span id="cb432-13"><a href="resampling-methods.html#cb432-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.id =</span> <span class="st">&quot;i&quot;</span></span>
<span id="cb432-14"><a href="resampling-methods.html#cb432-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb432-15"><a href="resampling-methods.html#cb432-15" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 23.19 sec elapsed</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>Take the average of the <span class="math inline">\(n\)</span> numbers obtained in (d) in order to obtain the LOOCV estimate for the test error. Comment on the results.</li>
</ol>
<p>I can compute the error, as well as some other metrics, manually like this:</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="resampling-methods.html#cb434-1" aria-hidden="true" tabindex="-1"></a>direction_loocv_preds <span class="sc">%&gt;%</span></span>
<span id="cb434-2"><a href="resampling-methods.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb434-3"><a href="resampling-methods.html#cb434-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_correct =</span> <span class="fu">sum</span>(Direction <span class="sc">==</span> .pred_class),</span>
<span id="cb434-4"><a href="resampling-methods.html#cb434-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">accuracy =</span> n_correct <span class="sc">/</span> <span class="fu">n</span>(),</span>
<span id="cb434-5"><a href="resampling-methods.html#cb434-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_rate =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy,</span>
<span id="cb434-6"><a href="resampling-methods.html#cb434-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Defining &quot;Up&quot; as positive, compute sensitivity and specificity</span></span>
<span id="cb434-7"><a href="resampling-methods.html#cb434-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">sensitivity =</span> <span class="fu">sum</span>(Direction <span class="sc">==</span> <span class="st">&quot;Up&quot;</span> <span class="sc">&amp;</span> .pred_class <span class="sc">==</span> <span class="st">&quot;Up&quot;</span>) <span class="sc">/</span></span>
<span id="cb434-8"><a href="resampling-methods.html#cb434-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(Direction <span class="sc">==</span> <span class="st">&quot;Up&quot;</span>),</span>
<span id="cb434-9"><a href="resampling-methods.html#cb434-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">specificity =</span> <span class="fu">sum</span>(Direction <span class="sc">==</span> <span class="st">&quot;Down&quot;</span> <span class="sc">&amp;</span> .pred_class <span class="sc">==</span> <span class="st">&quot;Down&quot;</span>) <span class="sc">/</span></span>
<span id="cb434-10"><a href="resampling-methods.html#cb434-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(Direction <span class="sc">==</span> <span class="st">&quot;Down&quot;</span>),</span>
<span id="cb434-11"><a href="resampling-methods.html#cb434-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(accuracy, error_rate, sensitivity, specificity), scales<span class="sc">::</span>percent)</span>
<span id="cb434-12"><a href="resampling-methods.html#cb434-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb434-13"><a href="resampling-methods.html#cb434-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="yijtajtpbm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#yijtajtpbm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yijtajtpbm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yijtajtpbm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yijtajtpbm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yijtajtpbm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yijtajtpbm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yijtajtpbm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yijtajtpbm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yijtajtpbm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yijtajtpbm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yijtajtpbm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yijtajtpbm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#yijtajtpbm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yijtajtpbm .gt_from_md > :first-child {
  margin-top: 0;
}

#yijtajtpbm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yijtajtpbm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yijtajtpbm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yijtajtpbm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yijtajtpbm .gt_row_group_first td {
  border-top-width: 2px;
}

#yijtajtpbm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yijtajtpbm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yijtajtpbm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yijtajtpbm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yijtajtpbm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yijtajtpbm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yijtajtpbm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yijtajtpbm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yijtajtpbm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yijtajtpbm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yijtajtpbm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yijtajtpbm .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yijtajtpbm .gt_left {
  text-align: left;
}

#yijtajtpbm .gt_center {
  text-align: center;
}

#yijtajtpbm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yijtajtpbm .gt_font_normal {
  font-weight: normal;
}

#yijtajtpbm .gt_font_bold {
  font-weight: bold;
}

#yijtajtpbm .gt_font_italic {
  font-style: italic;
}

#yijtajtpbm .gt_super {
  font-size: 65%;
}

#yijtajtpbm .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#yijtajtpbm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#yijtajtpbm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yijtajtpbm .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#yijtajtpbm .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#yijtajtpbm .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n_correct</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">accuracy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">error_rate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sensitivity</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">specificity</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">599</td>
<td class="gt_row gt_left">55%</td>
<td class="gt_row gt_left">45%</td>
<td class="gt_row gt_left">93%</td>
<td class="gt_row gt_left">7%</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The <code>yardstick</code> package has a helpful <code>metrics()</code> function for quickly computing various metrics:</p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="resampling-methods.html#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(direction_loocv_preds, <span class="at">truth =</span> Direction, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary       0.550  
## 2 kap      binary       0.00451</code></pre>
<p>For classification, this returns by default the accuracy and the Kappa statistic.
The latter is a metric that compares the observed accuracy with a random chance classifier.
It may be familiar in the context of inter-rater reliability, which is an important aspect of test/scale/measurement validity.
Kappa values range from 0 to 1, with high values indicating better agreement.
The threshold for an acceptable value will vary by context, but the value here
(0.0045)
is undoubtedly poor.</p>
<p>I can define a custom <code>metric_set()</code> to get my desired classification metrics for this model:
<a href="moving-beyond-linearity.html#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="resampling-methods.html#cb437-1" aria-hidden="true" tabindex="-1"></a>classification_metrics <span class="ot">&lt;-</span> <span class="fu">metric_set</span>(accuracy, sensitivity, specificity)</span>
<span id="cb437-2"><a href="resampling-methods.html#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="fu">classification_metrics</span>(direction_loocv_preds,</span>
<span id="cb437-3"><a href="resampling-methods.html#cb437-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">truth =</span> Direction, <span class="at">estimate =</span> .pred_class) <span class="sc">%&gt;%</span></span>
<span id="cb437-4"><a href="resampling-methods.html#cb437-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> .metric, <span class="at">values_from =</span> .estimate) <span class="sc">%&gt;%</span></span>
<span id="cb437-5"><a href="resampling-methods.html#cb437-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb437-6"><a href="resampling-methods.html#cb437-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_rate =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy,</span>
<span id="cb437-7"><a href="resampling-methods.html#cb437-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(accuracy, error_rate, sensitivity, specificity), scales<span class="sc">::</span>percent)</span>
<span id="cb437-8"><a href="resampling-methods.html#cb437-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb437-9"><a href="resampling-methods.html#cb437-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="rmujnfjuun" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rmujnfjuun .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rmujnfjuun .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmujnfjuun .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rmujnfjuun .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rmujnfjuun .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmujnfjuun .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmujnfjuun .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rmujnfjuun .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rmujnfjuun .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rmujnfjuun .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rmujnfjuun .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rmujnfjuun .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rmujnfjuun .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rmujnfjuun .gt_from_md > :first-child {
  margin-top: 0;
}

#rmujnfjuun .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rmujnfjuun .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rmujnfjuun .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rmujnfjuun .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rmujnfjuun .gt_row_group_first td {
  border-top-width: 2px;
}

#rmujnfjuun .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmujnfjuun .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rmujnfjuun .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rmujnfjuun .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmujnfjuun .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmujnfjuun .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rmujnfjuun .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rmujnfjuun .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmujnfjuun .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmujnfjuun .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmujnfjuun .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmujnfjuun .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmujnfjuun .gt_left {
  text-align: left;
}

#rmujnfjuun .gt_center {
  text-align: center;
}

#rmujnfjuun .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rmujnfjuun .gt_font_normal {
  font-weight: normal;
}

#rmujnfjuun .gt_font_bold {
  font-weight: bold;
}

#rmujnfjuun .gt_font_italic {
  font-style: italic;
}

#rmujnfjuun .gt_super {
  font-size: 65%;
}

#rmujnfjuun .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#rmujnfjuun .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#rmujnfjuun .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rmujnfjuun .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#rmujnfjuun .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#rmujnfjuun .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">error_rate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">accuracy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">sensitivity</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">specificity</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">45%</td>
<td class="gt_row gt_left">55%</td>
<td class="gt_row gt_left">7%</td>
<td class="gt_row gt_left">93%</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Note that the labels are switched from my manual calculation: sensitivity is swapped for specificity.
This is because the “positive” level (called the <code>event_level</code> in <code>yardstick</code>) was manually chosen as “Up” by me, but automatically chosen as “Down” by <code>yardstick</code>.
I can switch this by changing the <code>event_level</code> argument in the <code>sensitivity()</code> and <code>specificity()</code> functions:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="resampling-methods.html#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sensitivity</span>(direction_loocv_preds, <span class="at">truth =</span> Direction, <span class="at">estimate =</span> .pred_class,</span>
<span id="cb438-2"><a href="resampling-methods.html#cb438-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">event_level =</span> <span class="st">&quot;second&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   .metric     .estimator .estimate
##   &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;
## 1 sensitivity binary         0.934</code></pre>
<p>But ideally this is something I would set before fitting the model – by setting “Up” as the first level of the <code>Direction</code> factor, <code>tidymodels</code> will interpret it as the “event” or “positive” level.</p>
</div>
<div id="cross-validation-on-simulated-data" class="section level4 unnumbered">
<h4>8. Cross-validation on simulated data</h4>
<ol style="list-style-type: lower-alpha">
<li>Generate a simulated data set. What is <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>? Write out the model used to generate the data in equation form.</li>
</ol>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="resampling-methods.html#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb440-2"><a href="resampling-methods.html#cb440-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb440-3"><a href="resampling-methods.html#cb440-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span></code></pre></div>
<p>The number of observations is <span class="math inline">\(n\)</span> = 100, and the number of predictors is <span class="math inline">\(p\)</span> = 1.</p>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X + \beta_2 X^2 + \epsilon \\
X &amp;\sim \text{Normal}(0, 1) \\
\epsilon &amp;\sim \text{Normal}(0, 1) \\
\beta_0 &amp;= 0 \\
\beta_1 &amp;= 1 \\
\beta_2 &amp;= -2
\end{align}
\]</span></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Create a scatterplot of <span class="math inline">\(X\)</span> against <span class="math inline">\(Y\)</span>.</li>
</ol>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="resampling-methods.html#cb441-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(x, y)</span>
<span id="cb441-2"><a href="resampling-methods.html#cb441-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb441-3"><a href="resampling-methods.html#cb441-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-240-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>This is obviously a very non-linear relationship, with a negative parabola shape.
A model without a polynomial term of <span class="math inline">\(X\)</span> will definitely be a poor fit.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Set a random seed, and then compute the LOOCV errors that result from fitting the following four models using least squares:</li>
</ol>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X + \epsilon \\
Y &amp;= \beta_0 + \beta_1 X + \beta_2 X^2 + \epsilon \\
Y &amp;= \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \epsilon \\
Y &amp;= \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \beta_4 X^4 + \epsilon
\end{align}
\]</span></p>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="resampling-methods.html#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">927</span>)</span>
<span id="cb442-2"><a href="resampling-methods.html#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tic</span>()</span>
<span id="cb442-3"><a href="resampling-methods.html#cb442-3" aria-hidden="true" tabindex="-1"></a>sim_fits_c <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d), <span class="at">poly_df =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb442-4"><a href="resampling-methods.html#cb442-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb442-5"><a href="resampling-methods.html#cb442-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> furrr<span class="sc">::</span><span class="fu">future_map2</span>(</span>
<span id="cb442-6"><a href="resampling-methods.html#cb442-6" aria-hidden="true" tabindex="-1"></a>      i, poly_df,</span>
<span id="cb442-7"><a href="resampling-methods.html#cb442-7" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb442-8"><a href="resampling-methods.html#cb442-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fit</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> .y), <span class="at">data =</span> <span class="fu">slice</span>(d, <span class="sc">-</span>.x))</span>
<span id="cb442-9"><a href="resampling-methods.html#cb442-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb442-10"><a href="resampling-methods.html#cb442-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_i =</span> furrr<span class="sc">::</span><span class="fu">future_map2_dbl</span>(</span>
<span id="cb442-11"><a href="resampling-methods.html#cb442-11" aria-hidden="true" tabindex="-1"></a>      i, fit,</span>
<span id="cb442-12"><a href="resampling-methods.html#cb442-12" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">augment</span>(.y, <span class="at">new_data =</span> <span class="fu">slice</span>(d, .x)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(.resid)</span>
<span id="cb442-13"><a href="resampling-methods.html#cb442-13" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb442-14"><a href="resampling-methods.html#cb442-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb442-15"><a href="resampling-methods.html#cb442-15" aria-hidden="true" tabindex="-1"></a><span class="fu">toc</span>()</span></code></pre></div>
<pre><code>## 18.86 sec elapsed</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="resampling-methods.html#cb444-1" aria-hidden="true" tabindex="-1"></a>sim_fits_c <span class="sc">%&gt;%</span></span>
<span id="cb444-2"><a href="resampling-methods.html#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(poly_df) <span class="sc">%&gt;%</span></span>
<span id="cb444-3"><a href="resampling-methods.html#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mse =</span> <span class="fu">sum</span>(resid_i<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb444-4"><a href="resampling-methods.html#cb444-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb444-5"><a href="resampling-methods.html#cb444-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(mse, <span class="at">decimals =</span> <span class="dv">2</span>)</span></code></pre></div>
<div id="xwcmvtolit" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xwcmvtolit .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xwcmvtolit .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwcmvtolit .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xwcmvtolit .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xwcmvtolit .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwcmvtolit .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xwcmvtolit .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xwcmvtolit .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xwcmvtolit .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xwcmvtolit .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xwcmvtolit .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xwcmvtolit .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xwcmvtolit .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xwcmvtolit .gt_from_md > :first-child {
  margin-top: 0;
}

#xwcmvtolit .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xwcmvtolit .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xwcmvtolit .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xwcmvtolit .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xwcmvtolit .gt_row_group_first td {
  border-top-width: 2px;
}

#xwcmvtolit .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwcmvtolit .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xwcmvtolit .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xwcmvtolit .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwcmvtolit .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwcmvtolit .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xwcmvtolit .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xwcmvtolit .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xwcmvtolit .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwcmvtolit .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwcmvtolit .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xwcmvtolit .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xwcmvtolit .gt_left {
  text-align: left;
}

#xwcmvtolit .gt_center {
  text-align: center;
}

#xwcmvtolit .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xwcmvtolit .gt_font_normal {
  font-weight: normal;
}

#xwcmvtolit .gt_font_bold {
  font-weight: bold;
}

#xwcmvtolit .gt_font_italic {
  font-style: italic;
}

#xwcmvtolit .gt_super {
  font-size: 65%;
}

#xwcmvtolit .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#xwcmvtolit .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xwcmvtolit .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xwcmvtolit .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#xwcmvtolit .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#xwcmvtolit .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">poly_df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mse</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">728.82</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">93.74</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">95.66</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">95.39</td></tr>
  </tbody>
  
  
</table>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Repeat (c) using another random seed. Are your results the same? Why?</li>
</ol>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="resampling-methods.html#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">213</span>)</span>
<span id="cb445-2"><a href="resampling-methods.html#cb445-2" aria-hidden="true" tabindex="-1"></a>sim_fits_d <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d), <span class="at">poly_df =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb445-3"><a href="resampling-methods.html#cb445-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb445-4"><a href="resampling-methods.html#cb445-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">fit =</span> furrr<span class="sc">::</span><span class="fu">future_map2</span>(</span>
<span id="cb445-5"><a href="resampling-methods.html#cb445-5" aria-hidden="true" tabindex="-1"></a>      i, poly_df,</span>
<span id="cb445-6"><a href="resampling-methods.html#cb445-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb445-7"><a href="resampling-methods.html#cb445-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">fit</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="at">degree =</span> .y), <span class="at">data =</span> <span class="fu">slice</span>(d, <span class="sc">-</span>.x))</span>
<span id="cb445-8"><a href="resampling-methods.html#cb445-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb445-9"><a href="resampling-methods.html#cb445-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">resid_i =</span> furrr<span class="sc">::</span><span class="fu">future_map2_dbl</span>(</span>
<span id="cb445-10"><a href="resampling-methods.html#cb445-10" aria-hidden="true" tabindex="-1"></a>      i, fit,</span>
<span id="cb445-11"><a href="resampling-methods.html#cb445-11" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">augment</span>(.y, <span class="at">new_data =</span> <span class="fu">slice</span>(d, .x)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(.resid)</span>
<span id="cb445-12"><a href="resampling-methods.html#cb445-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb445-13"><a href="resampling-methods.html#cb445-13" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="resampling-methods.html#cb446-1" aria-hidden="true" tabindex="-1"></a>sim_fits_d <span class="sc">%&gt;%</span></span>
<span id="cb446-2"><a href="resampling-methods.html#cb446-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(poly_df) <span class="sc">%&gt;%</span></span>
<span id="cb446-3"><a href="resampling-methods.html#cb446-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mse =</span> <span class="fu">sum</span>(resid_i<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb446-4"><a href="resampling-methods.html#cb446-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb446-5"><a href="resampling-methods.html#cb446-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(mse, <span class="at">decimals =</span> <span class="dv">2</span>)</span></code></pre></div>
<div id="xlpiawbpcp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#xlpiawbpcp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#xlpiawbpcp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xlpiawbpcp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#xlpiawbpcp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#xlpiawbpcp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xlpiawbpcp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#xlpiawbpcp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#xlpiawbpcp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#xlpiawbpcp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#xlpiawbpcp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#xlpiawbpcp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#xlpiawbpcp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#xlpiawbpcp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#xlpiawbpcp .gt_from_md > :first-child {
  margin-top: 0;
}

#xlpiawbpcp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#xlpiawbpcp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#xlpiawbpcp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#xlpiawbpcp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#xlpiawbpcp .gt_row_group_first td {
  border-top-width: 2px;
}

#xlpiawbpcp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlpiawbpcp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#xlpiawbpcp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#xlpiawbpcp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xlpiawbpcp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlpiawbpcp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#xlpiawbpcp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#xlpiawbpcp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#xlpiawbpcp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xlpiawbpcp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlpiawbpcp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#xlpiawbpcp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#xlpiawbpcp .gt_left {
  text-align: left;
}

#xlpiawbpcp .gt_center {
  text-align: center;
}

#xlpiawbpcp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#xlpiawbpcp .gt_font_normal {
  font-weight: normal;
}

#xlpiawbpcp .gt_font_bold {
  font-weight: bold;
}

#xlpiawbpcp .gt_font_italic {
  font-style: italic;
}

#xlpiawbpcp .gt_super {
  font-size: 65%;
}

#xlpiawbpcp .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#xlpiawbpcp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#xlpiawbpcp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#xlpiawbpcp .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#xlpiawbpcp .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#xlpiawbpcp .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">poly_df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mse</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_right">728.82</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_right">93.74</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_right">95.66</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_right">95.39</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Despite setting different random seeds, the results are exactly the same because none of the above code involved the generation of random numbers.
LOOCV is an entirely deterministic process – each observation is used a single time as the holdout/evaluation data set.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Which of the models had the smallest LOOCV error?</li>
</ol>
<p>The lowest MSE was the second model (<span class="math inline">\(Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \epsilon\)</span>) which is unsurprising because this is also the model used to generate the data.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Comment on the statistical significance of the coefficient estimates that result from fitting each of the models in (c) using least squares. Do these results agree with the conclusions drawn based on the cross-validation results?</li>
</ol>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="resampling-methods.html#cb447-1" aria-hidden="true" tabindex="-1"></a>sim_fits_c <span class="sc">%&gt;%</span></span>
<span id="cb447-2"><a href="resampling-methods.html#cb447-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># For this, use the model fits that excluded the first (i = 1) observation</span></span>
<span id="cb447-3"><a href="resampling-methods.html#cb447-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(i <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb447-4"><a href="resampling-methods.html#cb447-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit_tidy =</span> <span class="fu">map</span>(fit, tidy)) <span class="sc">%&gt;%</span></span>
<span id="cb447-5"><a href="resampling-methods.html#cb447-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(fit_tidy) <span class="sc">%&gt;%</span></span>
<span id="cb447-6"><a href="resampling-methods.html#cb447-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb447-7"><a href="resampling-methods.html#cb447-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">poly_df =</span> <span class="fu">paste0</span>(<span class="st">&quot;polynomial degree = &quot;</span>, poly_df),</span>
<span id="cb447-8"><a href="resampling-methods.html#cb447-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> <span class="fu">factor</span>(term,</span>
<span id="cb447-9"><a href="resampling-methods.html#cb447-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;beta_0&quot;</span>, <span class="st">&quot;beta_1&quot;</span>, <span class="st">&quot;beta_1&quot;</span>,</span>
<span id="cb447-10"><a href="resampling-methods.html#cb447-10" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;beta_2&quot;</span>, <span class="st">&quot;beta_3&quot;</span>, <span class="st">&quot;beta_4&quot;</span>)),</span>
<span id="cb447-11"><a href="resampling-methods.html#cb447-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">round</span>(estimate, <span class="dv">2</span>), <span class="at">std.error =</span> <span class="fu">round</span>(std.error, <span class="dv">2</span>),</span>
<span id="cb447-12"><a href="resampling-methods.html#cb447-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value)</span>
<span id="cb447-13"><a href="resampling-methods.html#cb447-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb447-14"><a href="resampling-methods.html#cb447-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(poly_df) <span class="sc">%&gt;%</span></span>
<span id="cb447-15"><a href="resampling-methods.html#cb447-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="skymurpgin" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#skymurpgin .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#skymurpgin .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#skymurpgin .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#skymurpgin .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#skymurpgin .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skymurpgin .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#skymurpgin .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#skymurpgin .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#skymurpgin .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#skymurpgin .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#skymurpgin .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#skymurpgin .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#skymurpgin .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#skymurpgin .gt_from_md > :first-child {
  margin-top: 0;
}

#skymurpgin .gt_from_md > :last-child {
  margin-bottom: 0;
}

#skymurpgin .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#skymurpgin .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#skymurpgin .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#skymurpgin .gt_row_group_first td {
  border-top-width: 2px;
}

#skymurpgin .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#skymurpgin .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#skymurpgin .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#skymurpgin .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skymurpgin .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#skymurpgin .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#skymurpgin .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#skymurpgin .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#skymurpgin .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#skymurpgin .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#skymurpgin .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#skymurpgin .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#skymurpgin .gt_left {
  text-align: left;
}

#skymurpgin .gt_center {
  text-align: center;
}

#skymurpgin .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#skymurpgin .gt_font_normal {
  font-weight: normal;
}

#skymurpgin .gt_font_bold {
  font-weight: bold;
}

#skymurpgin .gt_font_italic {
  font-style: italic;
}

#skymurpgin .gt_super {
  font-size: 65%;
}

#skymurpgin .gt_two_val_uncert {
  display: inline-block;
  line-height: 1em;
  text-align: right;
  font-size: 60%;
  vertical-align: -0.25em;
  margin-left: 0.1em;
}

#skymurpgin .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#skymurpgin .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#skymurpgin .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#skymurpgin .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#skymurpgin .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">polynomial degree = 1</td>
    </tr>
    <tr class="gt_row_group_first"><td class="gt_row gt_center">beta_0</td>
<td class="gt_row gt_right">-1.55</td>
<td class="gt_row gt_right">0.26</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_1</td>
<td class="gt_row gt_right">6.17</td>
<td class="gt_row gt_right">2.61</td>
<td class="gt_row gt_left">0.020</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">polynomial degree = 2</td>
    </tr>
    <tr class="gt_row_group_first"><td class="gt_row gt_center">beta_0</td>
<td class="gt_row gt_right">-1.55</td>
<td class="gt_row gt_right">0.10</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_1</td>
<td class="gt_row gt_right">6.17</td>
<td class="gt_row gt_right">0.96</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_2</td>
<td class="gt_row gt_right">-23.96</td>
<td class="gt_row gt_right">0.96</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">polynomial degree = 3</td>
    </tr>
    <tr class="gt_row_group_first"><td class="gt_row gt_center">beta_0</td>
<td class="gt_row gt_right">-1.55</td>
<td class="gt_row gt_right">0.10</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_1</td>
<td class="gt_row gt_right">6.17</td>
<td class="gt_row gt_right">0.97</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_2</td>
<td class="gt_row gt_right">-23.96</td>
<td class="gt_row gt_right">0.97</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_3</td>
<td class="gt_row gt_right">0.32</td>
<td class="gt_row gt_right">0.97</td>
<td class="gt_row gt_left">0.737</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">polynomial degree = 4</td>
    </tr>
    <tr class="gt_row_group_first"><td class="gt_row gt_center">beta_0</td>
<td class="gt_row gt_right">-1.55</td>
<td class="gt_row gt_right">0.10</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_1</td>
<td class="gt_row gt_right">6.17</td>
<td class="gt_row gt_right">0.96</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_2</td>
<td class="gt_row gt_right">-23.96</td>
<td class="gt_row gt_right">0.96</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_center">beta_3</td>
<td class="gt_row gt_right">0.32</td>
<td class="gt_row gt_right">0.96</td>
<td class="gt_row gt_left">0.736</td></tr>
    <tr><td class="gt_row gt_center">beta_4</td>
<td class="gt_row gt_right">1.24</td>
<td class="gt_row gt_right">0.96</td>
<td class="gt_row gt_left">0.201</td></tr>
  </tbody>
  
  
</table>
</div>
<p>This is aligned with the cross-validation results: the model with the 2nd degree polynomial (<span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>) has statistically significant coefficients.
The 3rd and 4th degree terms (<span class="math inline">\(\beta_3\)</span> and <span class="math inline">\(\beta_4\)</span>) are not significant in either model.</p>
</div>
<div id="bootstrap-with-boston" class="section level4 unnumbered">
<h4>9. Bootstrap with <code>boston</code></h4>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="resampling-methods.html#cb448-1" aria-hidden="true" tabindex="-1"></a>boston <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Boston</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Provide an estimate for the population mean of <code>medv</code>. Call this estimate <span class="math inline">\(\hat{\mu}\)</span>.</li>
</ol>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="resampling-methods.html#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(boston<span class="sc">$</span>medv)</span></code></pre></div>
<pre><code>## [1] 22.53281</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Provide an estimate for the standard error of <span class="math inline">\(\hat{\mu}\)</span>.</li>
</ol>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="resampling-methods.html#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(boston<span class="sc">$</span>medv) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(boston))</span></code></pre></div>
<pre><code>## [1] 0.4088611</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Now estimate the standard error of <span class="math inline">\(\hat{\mu}\)</span> using the bootstrap. How does this compare to your answer from (b)?</li>
</ol>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="resampling-methods.html#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">214</span>)</span>
<span id="cb453-2"><a href="resampling-methods.html#cb453-2" aria-hidden="true" tabindex="-1"></a>boston_boot <span class="ot">&lt;-</span> <span class="fu">bootstraps</span>(boston, <span class="at">times =</span> <span class="dv">1000</span>)</span>
<span id="cb453-3"><a href="resampling-methods.html#cb453-3" aria-hidden="true" tabindex="-1"></a>boston_boot_mu <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb453-4"><a href="resampling-methods.html#cb453-4" aria-hidden="true" tabindex="-1"></a>  boston_boot<span class="sc">$</span>splits, <span class="sc">~</span> <span class="fu">mean</span>(<span class="fu">as.data.frame</span>(.x)<span class="sc">$</span>medv)</span>
<span id="cb453-5"><a href="resampling-methods.html#cb453-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb453-6"><a href="resampling-methods.html#cb453-6" aria-hidden="true" tabindex="-1"></a>mean_mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(boston_boot_mu)</span>
<span id="cb453-7"><a href="resampling-methods.html#cb453-7" aria-hidden="true" tabindex="-1"></a>se_mu <span class="ot">&lt;-</span> <span class="fu">sd</span>(boston_boot_mu)</span>
<span id="cb453-8"><a href="resampling-methods.html#cb453-8" aria-hidden="true" tabindex="-1"></a>mean_mu; se_mu</span></code></pre></div>
<pre><code>## [1] 22.54254</code></pre>
<pre><code>## [1] 0.4066961</code></pre>
<p>For comparison, here is the implementation with the <code>boot</code> package:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="resampling-methods.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">214</span>)</span>
<span id="cb456-2"><a href="resampling-methods.html#cb456-2" aria-hidden="true" tabindex="-1"></a>medv_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(data, i) <span class="fu">mean</span>(data<span class="sc">$</span>medv[i])</span>
<span id="cb456-3"><a href="resampling-methods.html#cb456-3" aria-hidden="true" tabindex="-1"></a>boot<span class="sc">::</span><span class="fu">boot</span>(boston, <span class="at">statistic =</span> medv_mean, <span class="at">R =</span> <span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot::boot(data = boston, statistic = medv_mean, R = 1000)
## 
## 
## Bootstrap Statistics :
##     original      bias    std. error
## t1* 22.53281 0.009737747   0.4181119</code></pre>
<p>The results are slightly different, even with the same seed, because the inner workings of the functions use random numbers in different ways, but both are very close to the estimate from (b).</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Based on your bootstrap estimate from (c), provide a 95 % confidence interval for the mean of <code>medv</code>. Compare it to the results obtained using <code>t.test(boston$medv)</code>.</li>
</ol>
<p>Approximate interval using the bootstrap estimates:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="resampling-methods.html#cb458-1" aria-hidden="true" tabindex="-1"></a>mean_mu <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> se_mu; mean_mu <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> se_mu</span></code></pre></div>
<pre><code>## [1] 21.72915</code></pre>
<pre><code>## [1] 23.35594</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="resampling-methods.html#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(boston<span class="sc">$</span>medv)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  boston$medv
## t = 55.111, df = 505, p-value &lt; 2.2e-16
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  21.72953 23.33608
## sample estimates:
## mean of x 
##  22.53281</code></pre>
<p>The 95% confidence intervals are essentially equal.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Provide an estimate, <span class="math inline">\(\hat{\mu}_{\text{med}}\)</span>, for the median value of <code>medv</code> in the population.</li>
</ol>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="resampling-methods.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(boston<span class="sc">$</span>medv)</span></code></pre></div>
<pre><code>## [1] 21.2</code></pre>
<ol start="6" style="list-style-type: lower-alpha">
<li>We now would like to estimate the standard error of <span class="math inline">\(\hat{\mu}_{\text{med}}\)</span>. Unfortunately, there is no simple formula for computing the standard error of the median. Instead, estimate the standard error of the
median using the bootstrap.</li>
</ol>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="resampling-methods.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">25</span>)</span>
<span id="cb465-2"><a href="resampling-methods.html#cb465-2" aria-hidden="true" tabindex="-1"></a>boston_boot_median <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb465-3"><a href="resampling-methods.html#cb465-3" aria-hidden="true" tabindex="-1"></a>  boston_boot<span class="sc">$</span>splits, <span class="sc">~</span> <span class="fu">median</span>(<span class="fu">as.data.frame</span>(.x)<span class="sc">$</span>medv)</span>
<span id="cb465-4"><a href="resampling-methods.html#cb465-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb465-5"><a href="resampling-methods.html#cb465-5" aria-hidden="true" tabindex="-1"></a>mean_median <span class="ot">&lt;-</span> <span class="fu">mean</span>(boston_boot_median)</span>
<span id="cb465-6"><a href="resampling-methods.html#cb465-6" aria-hidden="true" tabindex="-1"></a>se_median <span class="ot">&lt;-</span> <span class="fu">sd</span>(boston_boot_median)</span>
<span id="cb465-7"><a href="resampling-methods.html#cb465-7" aria-hidden="true" tabindex="-1"></a>mean_median; se_median</span></code></pre></div>
<pre><code>## [1] 21.19575</code></pre>
<pre><code>## [1] 0.3749333</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>Provide an estimate, <span class="math inline">\(\hat{\mu}_{0.1}\)</span>, for the tenth percentile of <code>medv</code>.</li>
</ol>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="resampling-methods.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boston<span class="sc">$</span>medv, <span class="at">probs =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>##   10% 
## 12.75</code></pre>
<ol start="8" style="list-style-type: lower-alpha">
<li>Use the bootstrap to estimate the standard error of <span class="math inline">\(\hat{\mu}_{0.1}\)</span>.</li>
</ol>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="resampling-methods.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">6929</span>)</span>
<span id="cb470-2"><a href="resampling-methods.html#cb470-2" aria-hidden="true" tabindex="-1"></a>boston_boot_p10 <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(</span>
<span id="cb470-3"><a href="resampling-methods.html#cb470-3" aria-hidden="true" tabindex="-1"></a>  boston_boot<span class="sc">$</span>splits, <span class="sc">~</span> <span class="fu">quantile</span>(<span class="fu">as.data.frame</span>(.x)<span class="sc">$</span>medv, <span class="at">probs =</span> <span class="fl">0.1</span>)</span>
<span id="cb470-4"><a href="resampling-methods.html#cb470-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb470-5"><a href="resampling-methods.html#cb470-5" aria-hidden="true" tabindex="-1"></a>mean_p10 <span class="ot">&lt;-</span> <span class="fu">mean</span>(boston_boot_p10)</span>
<span id="cb470-6"><a href="resampling-methods.html#cb470-6" aria-hidden="true" tabindex="-1"></a>se_p10 <span class="ot">&lt;-</span> <span class="fu">sd</span>(boston_boot_p10)</span>
<span id="cb470-7"><a href="resampling-methods.html#cb470-7" aria-hidden="true" tabindex="-1"></a>mean_p10; se_p10</span></code></pre></div>
<pre><code>## [1] 12.78025</code></pre>
<pre><code>## [1] 0.4978406</code></pre>
</div>
</div>
</div>
<div id="reproducibility-2" class="section level2 unnumbered">
<h2>Reproducibility</h2>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="resampling-methods.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2022-06-14 10:39:16 AST&quot;</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="resampling-methods.html#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">&quot;git2r&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) {</span>
<span id="cb475-2"><a href="resampling-methods.html#cb475-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (git2r<span class="sc">::</span><span class="fu">in_repository</span>()) {</span>
<span id="cb475-3"><a href="resampling-methods.html#cb475-3" aria-hidden="true" tabindex="-1"></a>    git2r<span class="sc">::</span><span class="fu">repository</span>()</span>
<span id="cb475-4"><a href="resampling-methods.html#cb475-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb475-5"><a href="resampling-methods.html#cb475-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Local:    main C:/Users/tdunn/Documents/learning/islr-tidy
## Remote:   main @ origin (https://github.com/taylordunn/islr-tidy)
## Head:     [6bbaf6f] 2022-04-20: Finished chapter 7</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="resampling-methods.html#cb477-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
<pre><code>## ─ Session info ───────────────────────────────────────────────────────────────
##  setting  value                            
##  version  R version 4.2.0 (2022-04-22 ucrt)
##  os       Windows 10 x64                   
##  system   x86_64, mingw32                  
##  ui       RTerm                            
##  language (EN)                             
##  collate  English_Canada.utf8              
##  ctype    English_Canada.utf8              
##  tz       America/Curacao                  
##  date     2022-06-14                       
## 
## ─ Packages ───────────────────────────────────────────────────────────────────
##  package        * version    date       lib source                           
##  abind            1.4-5      2016-07-21 [1] CRAN (R 4.1.1)                   
##  assertthat       0.2.1      2019-03-21 [1] CRAN (R 4.1.0)                   
##  backports        1.2.1      2020-12-09 [1] CRAN (R 4.1.0)                   
##  base64enc        0.1-3      2015-07-28 [1] CRAN (R 4.1.0)                   
##  bayestestR       0.12.1     2022-05-02 [1] CRAN (R 4.1.3)                   
##  bit              4.0.4      2020-08-04 [1] CRAN (R 4.1.2)                   
##  bit64            4.0.5      2020-08-30 [1] CRAN (R 4.1.2)                   
##  bookdown         0.24       2021-09-02 [1] CRAN (R 4.1.1)                   
##  boot             1.3-28     2021-05-03 [2] CRAN (R 4.2.0)                   
##  broom          * 0.8.0      2022-04-13 [1] CRAN (R 4.1.3)                   
##  bslib            0.3.1      2021-10-06 [1] CRAN (R 4.2.0)                   
##  cachem           1.0.6      2021-08-19 [1] CRAN (R 4.1.1)                   
##  car              3.0-12     2021-11-06 [1] CRAN (R 4.1.2)                   
##  carData          3.0-4      2020-05-22 [1] CRAN (R 4.1.1)                   
##  cellranger       1.1.0      2016-07-27 [1] CRAN (R 4.1.0)                   
##  checkmate        2.0.0      2020-02-06 [1] CRAN (R 4.1.0)                   
##  class            7.3-20     2022-01-16 [2] CRAN (R 4.2.0)                   
##  cli              3.2.0      2022-02-14 [1] CRAN (R 4.1.3)                   
##  coda             0.19-4     2020-09-30 [1] CRAN (R 4.1.0)                   
##  codetools        0.2-18     2020-11-04 [2] CRAN (R 4.2.0)                   
##  colorspace       2.0-3      2022-02-21 [1] CRAN (R 4.1.3)                   
##  combinat         0.0-8      2012-10-29 [1] CRAN (R 4.1.1)                   
##  corrr          * 0.4.3      2020-11-24 [1] CRAN (R 4.1.0)                   
##  crayon           1.5.1      2022-03-26 [1] CRAN (R 4.1.3)                   
##  datawizard       0.4.0      2022-03-30 [1] CRAN (R 4.1.3)                   
##  DBI              1.1.2      2021-12-20 [1] CRAN (R 4.1.2)                   
##  dbplyr           2.1.1      2021-04-06 [1] CRAN (R 4.1.0)                   
##  DEoptimR         1.0-9      2021-05-24 [1] CRAN (R 4.1.0)                   
##  dials          * 0.1.1      2022-04-06 [1] CRAN (R 4.1.3)                   
##  DiceDesign       1.9        2021-02-13 [1] CRAN (R 4.1.0)                   
##  digest           0.6.29     2021-12-01 [1] CRAN (R 4.1.2)                   
##  discrim        * 0.2.0      2022-03-09 [1] CRAN (R 4.2.0)                   
##  distill          1.3        2021-10-13 [1] CRAN (R 4.1.2)                   
##  distributional   0.2.2      2021-02-02 [1] CRAN (R 4.1.2)                   
##  doParallel     * 1.0.16     2020-10-16 [1] CRAN (R 4.1.1)                   
##  downlit          0.4.0      2021-10-29 [1] CRAN (R 4.1.1)                   
##  dplyr          * 1.0.8      2022-02-08 [1] CRAN (R 4.1.3)                   
##  dunnr          * 0.2.5      2022-01-15 [1] Github (taylordunn/dunnr@c83b30e)
##  effectsize       0.4.5      2021-05-25 [1] CRAN (R 4.1.0)                   
##  ellipsis         0.3.2      2021-04-29 [1] CRAN (R 4.1.0)                   
##  emmeans          1.7.0      2021-09-29 [1] CRAN (R 4.1.2)                   
##  equatiomatic     0.2.0      2021-01-30 [1] CRAN (R 4.1.0)                   
##  estimability     1.3        2018-02-11 [1] CRAN (R 4.1.1)                   
##  evaluate         0.14       2019-05-28 [1] CRAN (R 4.1.0)                   
##  extrafont        0.17       2014-12-08 [1] CRAN (R 4.1.0)                   
##  extrafontdb      1.0        2012-06-11 [1] CRAN (R 4.1.0)                   
##  fansi            1.0.3      2022-03-24 [1] CRAN (R 4.1.3)                   
##  farver           2.1.0      2021-02-28 [1] CRAN (R 4.1.0)                   
##  fastmap          1.1.0      2021-01-25 [1] CRAN (R 4.1.0)                   
##  forcats        * 0.5.1      2021-01-27 [1] CRAN (R 4.1.0)                   
##  foreach        * 1.5.2      2022-02-02 [1] CRAN (R 4.1.3)                   
##  fs               1.5.2      2021-12-08 [1] CRAN (R 4.1.2)                   
##  furrr            0.2.3      2021-06-25 [1] CRAN (R 4.1.2)                   
##  future           1.24.0     2022-02-19 [1] CRAN (R 4.1.3)                   
##  future.apply     1.8.1      2021-08-10 [1] CRAN (R 4.1.3)                   
##  generics         0.1.2      2022-01-31 [1] CRAN (R 4.1.3)                   
##  GGally           2.1.2      2021-06-21 [1] CRAN (R 4.1.0)                   
##  ggdist         * 3.0.0      2021-07-19 [1] CRAN (R 4.1.2)                   
##  ggplot2        * 3.3.5      2021-06-25 [1] CRAN (R 4.1.0)                   
##  ggrepel          0.9.1      2021-01-15 [1] CRAN (R 4.1.0)                   
##  ggridges         0.5.3      2021-01-08 [1] CRAN (R 4.1.0)                   
##  git2r            0.30.1     2022-03-16 [1] CRAN (R 4.1.3)                   
##  globals          0.14.0     2020-11-22 [1] CRAN (R 4.1.0)                   
##  glue             1.6.2      2022-02-24 [1] CRAN (R 4.1.3)                   
##  gower            0.2.2      2020-06-23 [1] CRAN (R 4.1.0)                   
##  GPfit            1.0-8      2019-02-08 [1] CRAN (R 4.1.0)                   
##  gridExtra        2.3        2017-09-09 [1] CRAN (R 4.1.0)                   
##  gt             * 0.5.0      2022-04-21 [1] CRAN (R 4.1.3)                   
##  gtable           0.3.0      2019-03-25 [1] CRAN (R 4.1.0)                   
##  hardhat          0.2.0      2022-01-24 [1] CRAN (R 4.1.3)                   
##  haven            2.4.1      2021-04-23 [1] CRAN (R 4.1.0)                   
##  here           * 1.0.1      2020-12-13 [1] CRAN (R 4.1.0)                   
##  highr            0.9        2021-04-16 [1] CRAN (R 4.1.0)                   
##  hms              1.1.1      2021-09-26 [1] CRAN (R 4.1.2)                   
##  htmltools        0.5.2      2021-08-25 [1] CRAN (R 4.1.1)                   
##  httpuv           1.6.5      2022-01-05 [1] CRAN (R 4.1.2)                   
##  httr             1.4.2      2020-07-20 [1] CRAN (R 4.1.0)                   
##  igraph           1.2.11     2022-01-04 [1] CRAN (R 4.1.3)                   
##  infer          * 1.0.0      2021-08-13 [1] CRAN (R 4.1.1)                   
##  insight          0.17.0     2022-03-29 [1] CRAN (R 4.1.3)                   
##  ipred            0.9-12     2021-09-15 [1] CRAN (R 4.1.1)                   
##  ISLR2          * 1.3-1      2022-01-10 [1] CRAN (R 4.1.2)                   
##  iterators      * 1.0.14     2022-02-05 [1] CRAN (R 4.1.3)                   
##  jquerylib        0.1.4      2021-04-26 [1] CRAN (R 4.1.0)                   
##  jsonlite         1.8.0      2022-02-22 [1] CRAN (R 4.1.3)                   
##  kknn             1.3.1      2016-03-26 [1] CRAN (R 4.1.2)                   
##  klaR             0.6-15     2020-02-19 [1] CRAN (R 4.1.2)                   
##  knitr            1.37       2021-12-16 [1] CRAN (R 4.1.2)                   
##  labeling         0.4.2      2020-10-20 [1] CRAN (R 4.1.0)                   
##  labelled         2.8.0      2021-03-08 [1] CRAN (R 4.1.0)                   
##  later            1.3.0      2021-08-18 [1] CRAN (R 4.1.2)                   
##  lattice          0.20-45    2021-09-22 [2] CRAN (R 4.2.0)                   
##  lava             1.6.10     2021-09-02 [1] CRAN (R 4.1.3)                   
##  lhs              1.1.1      2020-10-05 [1] CRAN (R 4.1.0)                   
##  lifecycle        1.0.1      2021-09-24 [1] CRAN (R 4.1.1)                   
##  listenv          0.8.0      2019-12-05 [1] CRAN (R 4.1.0)                   
##  lubridate        1.8.0      2021-10-07 [1] CRAN (R 4.1.1)                   
##  magrittr         2.0.2      2022-01-26 [1] CRAN (R 4.1.3)                   
##  MASS             7.3-56     2022-03-23 [2] CRAN (R 4.2.0)                   
##  Matrix           1.4-1      2022-03-23 [2] CRAN (R 4.2.0)                   
##  memoise          2.0.1      2021-11-26 [1] CRAN (R 4.1.2)                   
##  MetBrewer        0.1.0      2022-01-05 [1] CRAN (R 4.1.2)                   
##  mgcv             1.8-40     2022-03-29 [1] CRAN (R 4.1.3)                   
##  mime             0.12       2021-09-28 [1] CRAN (R 4.1.1)                   
##  miniUI           0.1.1.1    2018-05-18 [1] CRAN (R 4.1.1)                   
##  modeldata      * 0.1.1      2021-07-14 [1] CRAN (R 4.1.0)                   
##  modelr           0.1.8      2020-05-19 [1] CRAN (R 4.1.0)                   
##  munsell          0.5.0      2018-06-12 [1] CRAN (R 4.1.0)                   
##  mvtnorm        * 1.1-3      2021-10-08 [1] CRAN (R 4.1.1)                   
##  nlme             3.1-157    2022-03-25 [2] CRAN (R 4.2.0)                   
##  nnet             7.3-17     2022-01-16 [2] CRAN (R 4.2.0)                   
##  parallelly       1.30.0     2021-12-17 [1] CRAN (R 4.1.2)                   
##  parameters       0.14.0     2021-05-29 [1] CRAN (R 4.1.0)                   
##  parsnip        * 0.2.1      2022-03-17 [1] CRAN (R 4.1.3)                   
##  patchwork      * 1.1.1      2020-12-17 [1] CRAN (R 4.1.0)                   
##  performance      0.9.0      2022-03-30 [1] CRAN (R 4.1.3)                   
##  pillar           1.7.0      2022-02-01 [1] CRAN (R 4.1.2)                   
##  pkgconfig        2.0.3      2019-09-22 [1] CRAN (R 4.1.0)                   
##  plyr             1.8.7      2022-03-24 [1] CRAN (R 4.1.3)                   
##  poissonreg     * 0.2.0      2022-03-09 [1] CRAN (R 4.1.3)                   
##  pROC             1.17.0.1   2021-01-13 [1] CRAN (R 4.1.0)                   
##  prodlim          2019.11.13 2019-11-17 [1] CRAN (R 4.1.0)                   
##  promises         1.2.0.1    2021-02-11 [1] CRAN (R 4.1.0)                   
##  purrr          * 0.3.4      2020-04-17 [1] CRAN (R 4.1.2)                   
##  qqplotr          0.0.5      2021-04-23 [1] CRAN (R 4.1.0)                   
##  questionr        0.7.5      2021-10-06 [1] CRAN (R 4.1.2)                   
##  R6               2.5.1      2021-08-19 [1] CRAN (R 4.1.1)                   
##  RColorBrewer     1.1-3      2022-04-03 [1] CRAN (R 4.1.3)                   
##  Rcpp             1.0.8.3    2022-03-17 [1] CRAN (R 4.1.3)                   
##  readr          * 2.1.1      2021-11-30 [1] CRAN (R 4.1.2)                   
##  readxl           1.3.1      2019-03-13 [1] CRAN (R 4.1.0)                   
##  recipes        * 0.2.0      2022-02-18 [1] CRAN (R 4.1.3)                   
##  repr             1.1.3      2021-01-21 [1] CRAN (R 4.1.1)                   
##  reprex           2.0.0      2021-04-02 [1] CRAN (R 4.1.0)                   
##  reshape          0.8.8      2018-10-23 [1] CRAN (R 4.1.0)                   
##  rlang            1.0.2      2022-03-04 [1] CRAN (R 4.1.3)                   
##  rmarkdown        2.11       2021-09-14 [1] CRAN (R 4.1.1)                   
##  robustbase       0.93-8     2021-06-02 [1] CRAN (R 4.1.0)                   
##  rpart            4.1.16     2022-01-24 [2] CRAN (R 4.2.0)                   
##  rprojroot        2.0.2      2020-11-15 [1] CRAN (R 4.1.0)                   
##  rsample        * 0.1.1      2021-11-08 [1] CRAN (R 4.1.3)                   
##  rstudioapi       0.13       2020-11-12 [1] CRAN (R 4.1.0)                   
##  Rttf2pt1         1.3.8      2020-01-10 [1] CRAN (R 4.1.1)                   
##  rvest            1.0.0      2021-03-09 [1] CRAN (R 4.1.0)                   
##  sass             0.4.0      2021-05-12 [1] CRAN (R 4.1.0)                   
##  scales         * 1.2.0      2022-04-13 [1] CRAN (R 4.1.3)                   
##  see              0.6.4      2021-05-29 [1] CRAN (R 4.1.0)                   
##  sessioninfo      1.1.1      2018-11-05 [1] CRAN (R 4.1.0)                   
##  shiny            1.6.0      2021-01-25 [1] CRAN (R 4.1.0)                   
##  skimr            2.1.3      2021-03-07 [1] CRAN (R 4.1.1)                   
##  stringi          1.7.6      2021-11-29 [1] CRAN (R 4.1.2)                   
##  stringr        * 1.4.0      2019-02-10 [1] CRAN (R 4.1.0)                   
##  survival         3.3-1      2022-03-03 [2] CRAN (R 4.2.0)                   
##  tibble         * 3.1.6      2021-11-07 [1] CRAN (R 4.1.1)                   
##  tictoc         * 1.0.1      2021-04-19 [1] CRAN (R 4.1.1)                   
##  tidymodels     * 0.2.0      2022-03-19 [1] CRAN (R 4.1.3)                   
##  tidyr          * 1.2.0      2022-02-01 [1] CRAN (R 4.1.3)                   
##  tidyselect       1.1.2      2022-02-21 [1] CRAN (R 4.1.3)                   
##  tidyverse      * 1.3.1      2021-04-15 [1] CRAN (R 4.1.3)                   
##  timeDate         3043.102   2018-02-21 [1] CRAN (R 4.1.0)                   
##  tune           * 0.2.0      2022-03-19 [1] CRAN (R 4.1.3)                   
##  tzdb             0.2.0      2021-10-27 [1] CRAN (R 4.1.2)                   
##  usethis          2.1.5      2021-12-09 [1] CRAN (R 4.1.2)                   
##  utf8             1.2.2      2021-07-24 [1] CRAN (R 4.1.0)                   
##  vctrs            0.4.1      2022-04-13 [1] CRAN (R 4.1.3)                   
##  vroom            1.5.7      2021-11-30 [1] CRAN (R 4.1.2)                   
##  withr            2.5.0      2022-03-03 [1] CRAN (R 4.1.3)                   
##  workflows      * 0.2.6      2022-03-18 [1] CRAN (R 4.1.3)                   
##  workflowsets   * 0.2.1      2022-03-15 [1] CRAN (R 4.1.3)                   
##  xfun             0.29       2021-12-14 [1] CRAN (R 4.1.2)                   
##  xml2             1.3.3      2021-11-30 [1] CRAN (R 4.1.2)                   
##  xtable           1.8-4      2019-04-21 [1] CRAN (R 4.1.0)                   
##  yaml             2.2.1      2020-02-01 [1] CRAN (R 4.1.0)                   
##  yardstick      * 0.0.9      2021-11-22 [1] CRAN (R 4.1.3)                   
## 
## [1] C:/Users/tdunn/Documents/R/win-library/4.1
## [2] C:/Program Files/R/R-4.2.0/library</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="classification.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-model-selection-and-regularization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
