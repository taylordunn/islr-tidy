<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Linear Regression | An Introduction to Statistical Learning with the tidyverse and tidymodels</title>
  <meta name="description" content="Working through ISLR with the tidyverse and tidymodels" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Linear Regression | An Introduction to Statistical Learning with the tidyverse and tidymodels" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Working through ISLR with the tidyverse and tidymodels" />
  <meta name="github-repo" content="taylordunn/islr-tidy" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Linear Regression | An Introduction to Statistical Learning with the tidyverse and tidymodels" />
  
  <meta name="twitter:description" content="Working through ISLR with the tidyverse and tidymodels" />
  

<meta name="author" content="Taylor Dunn" />


<meta name="date" content="2022-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistical-learning.html"/>
<link rel="next" href="classification.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Who, what, and why?</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#an-overview-of-statistical-learning"><i class="fa fa-check"></i>An Overview of Statistical Learning</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#wage-data"><i class="fa fa-check"></i>Wage Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#a-brief-history-of-statistical-learning"><i class="fa fa-check"></i>A Brief History of Statistical Learning</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#this-book"><i class="fa fa-check"></i>This Book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="statistical-learning.html"><a href="statistical-learning.html"><i class="fa fa-check"></i><b>2</b> Statistical Learning</a>
<ul>
<li class="chapter" data-level="2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#what-is-statistical-learning"><i class="fa fa-check"></i><b>2.1</b> What Is Statistical Learning?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="statistical-learning.html"><a href="statistical-learning.html#why-estimate-f"><i class="fa fa-check"></i><b>2.1.1</b> Why Estimate <span class="math inline">\(f\)</span>?</a></li>
<li class="chapter" data-level="2.1.2" data-path="statistical-learning.html"><a href="statistical-learning.html#how-do-we-estimate-f"><i class="fa fa-check"></i><b>2.1.2</b> How Do We Estimate f?</a></li>
<li class="chapter" data-level="2.1.3" data-path="statistical-learning.html"><a href="statistical-learning.html#the-trade-off-between-prediction-accuracy-and-model-interpretability"><i class="fa fa-check"></i><b>2.1.3</b> The Trade-Off Between Prediction Accuracy and Model Interpretability</a></li>
<li class="chapter" data-level="2.1.4" data-path="statistical-learning.html"><a href="statistical-learning.html#supervised-versus-unsupervised-learning"><i class="fa fa-check"></i><b>2.1.4</b> Supervised Versus Unsupervised Learning</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#assessing-model-accuracy"><i class="fa fa-check"></i><b>2.2</b> Assessing Model Accuracy</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="statistical-learning.html"><a href="statistical-learning.html#measuring-the-quality-of-fit"><i class="fa fa-check"></i><b>2.2.1</b> Measuring the Quality of Fit</a></li>
<li class="chapter" data-level="2.2.2" data-path="statistical-learning.html"><a href="statistical-learning.html#the-bias-variance-trade-off"><i class="fa fa-check"></i><b>2.2.2</b> The Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="2.2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#the-classification-setting"><i class="fa fa-check"></i><b>2.2.3</b> The Classification Setting</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="statistical-learning.html"><a href="statistical-learning.html#lab-introduction-to-r"><i class="fa fa-check"></i><b>2.3</b> Lab: Introduction to R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-coefficients"><i class="fa fa-check"></i><b>3.1.1</b> Estimating the Coefficients</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-coefficient-estimates"><i class="fa fa-check"></i><b>3.1.2</b> Assessing the Accuracy of the Coefficient Estimates</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-regression.html"><a href="linear-regression.html#assessing-the-accuracy-of-the-model"><i class="fa fa-check"></i><b>3.1.3</b> Assessing the Accuracy of the Model</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>3.2</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="linear-regression.html"><a href="linear-regression.html#estimating-the-regression-coefficients"><i class="fa fa-check"></i><b>3.2.1</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-regression.html"><a href="linear-regression.html#some-important-questions"><i class="fa fa-check"></i><b>3.2.2</b> Some Important Questions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-regression.html"><a href="linear-regression.html#other-considerations-in-the-regression-model"><i class="fa fa-check"></i><b>3.3</b> Other Considerations in the Regression Model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="linear-regression.html"><a href="linear-regression.html#qualitative-predictors"><i class="fa fa-check"></i><b>3.3.1</b> Qualitative Predictors</a></li>
<li class="chapter" data-level="3.3.2" data-path="linear-regression.html"><a href="linear-regression.html#extensions-of-the-linear-model"><i class="fa fa-check"></i><b>3.3.2</b> Extensions of the Linear Model</a></li>
<li class="chapter" data-level="3.3.3" data-path="linear-regression.html"><a href="linear-regression.html#potential-problems"><i class="fa fa-check"></i><b>3.3.3</b> Potential Problems</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="linear-regression.html"><a href="linear-regression.html#the-marketing-plan"><i class="fa fa-check"></i><b>3.4</b> The Marketing Plan</a></li>
<li class="chapter" data-level="3.5" data-path="linear-regression.html"><a href="linear-regression.html#comparison-of-linear-regression-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>3.5</b> Comparison of Linear Regression with <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="3.6" data-path="linear-regression.html"><a href="linear-regression.html#lab-linear-regression"><i class="fa fa-check"></i><b>3.6</b> Lab: Linear Regression</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="linear-regression.html"><a href="linear-regression.html#libraries"><i class="fa fa-check"></i><b>3.6.1</b> Libraries</a></li>
<li class="chapter" data-level="3.6.2" data-path="linear-regression.html"><a href="linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="3.6.3" data-path="linear-regression.html"><a href="linear-regression.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.3</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="3.6.4" data-path="linear-regression.html"><a href="linear-regression.html#interaction-terms"><i class="fa fa-check"></i><b>3.6.4</b> Interaction Terms</a></li>
<li class="chapter" data-level="3.6.5" data-path="linear-regression.html"><a href="linear-regression.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>3.6.5</b> Non-linear Transformations of the Predictors</a></li>
<li class="chapter" data-level="3.6.6" data-path="linear-regression.html"><a href="linear-regression.html#qualitative-predictors-1"><i class="fa fa-check"></i><b>3.6.6</b> Qualitative Predictors</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="linear-regression.html"><a href="linear-regression.html#exercises"><i class="fa fa-check"></i><b>3.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#applied"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#reproducibility"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="classification.html"><a href="classification.html"><i class="fa fa-check"></i><b>4</b> Classification</a>
<ul>
<li class="chapter" data-level="4.1" data-path="classification.html"><a href="classification.html#an-overview-of-classification"><i class="fa fa-check"></i><b>4.1</b> An Overview of Classification</a></li>
<li class="chapter" data-level="4.2" data-path="classification.html"><a href="classification.html#why-not-linear-regression"><i class="fa fa-check"></i><b>4.2</b> Why Not Linear Regression?</a></li>
<li class="chapter" data-level="4.3" data-path="classification.html"><a href="classification.html#logistic-regression"><i class="fa fa-check"></i><b>4.3</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="classification.html"><a href="classification.html#the-logistic-model"><i class="fa fa-check"></i><b>4.3.1</b> The Logistic Model</a></li>
<li class="chapter" data-level="4.3.2" data-path="classification.html"><a href="classification.html#estimating-the-regression-coefficients-1"><i class="fa fa-check"></i><b>4.3.2</b> Estimating the Regression Coefficients</a></li>
<li class="chapter" data-level="4.3.3" data-path="classification.html"><a href="classification.html#making-predictions"><i class="fa fa-check"></i><b>4.3.3</b> Making Predictions</a></li>
<li class="chapter" data-level="4.3.4" data-path="classification.html"><a href="classification.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>4.3.4</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="4.3.5" data-path="classification.html"><a href="classification.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>4.3.5</b> Multinomial Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="classification.html"><a href="classification.html#generative-models-for-classification"><i class="fa fa-check"></i><b>4.4</b> Generative Models for Classification</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis-for-p-1"><i class="fa fa-check"></i><b>4.4.1</b> Linear Discriminant Analysis for <span class="math inline">\(p = 1\)</span></a></li>
<li class="chapter" data-level="4.4.2" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis-for-p-1-1"><i class="fa fa-check"></i><b>4.4.2</b> Linear Discriminant Analysis for <span class="math inline">\(p &gt; 1\)</span></a></li>
<li class="chapter" data-level="4.4.3" data-path="classification.html"><a href="classification.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>4.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="4.4.4" data-path="classification.html"><a href="classification.html#naive-bayes"><i class="fa fa-check"></i><b>4.4.4</b> Naive Bayes</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="classification.html"><a href="classification.html#a-comparison-of-classification-methods"><i class="fa fa-check"></i><b>4.5</b> A Comparison of Classification Methods</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="classification.html"><a href="classification.html#an-analytical-comparison"><i class="fa fa-check"></i><b>4.5.1</b> An Analytical Comparison</a></li>
<li class="chapter" data-level="4.5.2" data-path="classification.html"><a href="classification.html#an-empirical-comparison"><i class="fa fa-check"></i><b>4.5.2</b> An Empirical Comparison</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="classification.html"><a href="classification.html#generalized-linear-models"><i class="fa fa-check"></i><b>4.6</b> Generalized Linear Models</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="classification.html"><a href="classification.html#linear-regression-on-the-bikeshare-data"><i class="fa fa-check"></i><b>4.6.1</b> Linear Regression on the Bikeshare Data</a></li>
<li class="chapter" data-level="4.6.2" data-path="classification.html"><a href="classification.html#poisson-regression-on-bikeshare-data"><i class="fa fa-check"></i><b>4.6.2</b> Poisson Regression on Bikeshare Data</a></li>
<li class="chapter" data-level="4.6.3" data-path="classification.html"><a href="classification.html#generalized-linear-models-in-greater-generality"><i class="fa fa-check"></i><b>4.6.3</b> Generalized Linear Models in Greater Generality</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="classification.html"><a href="classification.html#lab-classification-methods"><i class="fa fa-check"></i><b>4.7</b> Lab: Classification Methods</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="classification.html"><a href="classification.html#the-stock-market-data"><i class="fa fa-check"></i><b>4.7.1</b> The Stock Market Data</a></li>
<li class="chapter" data-level="4.7.2" data-path="classification.html"><a href="classification.html#logistic-regression-1"><i class="fa fa-check"></i><b>4.7.2</b> Logistic Regression</a></li>
<li class="chapter" data-level="4.7.3" data-path="classification.html"><a href="classification.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>4.7.3</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="4.7.4" data-path="classification.html"><a href="classification.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>4.7.4</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="4.7.5" data-path="classification.html"><a href="classification.html#naive-bayes-1"><i class="fa fa-check"></i><b>4.7.5</b> Naive Bayes</a></li>
<li class="chapter" data-level="4.7.6" data-path="classification.html"><a href="classification.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>4.7.6</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="4.7.7" data-path="classification.html"><a href="classification.html#poisson-regression"><i class="fa fa-check"></i><b>4.7.7</b> Poisson Regression</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="classification.html"><a href="classification.html#exercises-1"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#applied-1"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="classification.html"><a href="classification.html#reproducibility-1"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="resampling-methods.html"><a href="resampling-methods.html"><i class="fa fa-check"></i><b>5</b> Resampling Methods</a>
<ul>
<li class="chapter" data-level="5.1" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation"><i class="fa fa-check"></i><b>5.1</b> Cross Validation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="resampling-methods.html"><a href="resampling-methods.html#validation-set"><i class="fa fa-check"></i><b>5.1.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="5.1.2" data-path="resampling-methods.html"><a href="resampling-methods.html#loocv"><i class="fa fa-check"></i><b>5.1.2</b> Leave-One-Out Cross Validation</a></li>
<li class="chapter" data-level="5.1.3" data-path="resampling-methods.html"><a href="resampling-methods.html#kfoldcv"><i class="fa fa-check"></i><b>5.1.3</b> <span class="math inline">\(k\)</span>-fold Cross-Validation</a></li>
<li class="chapter" data-level="5.1.4" data-path="resampling-methods.html"><a href="resampling-methods.html#bias-variance-trade-off-for-k-fold-cross-validation"><i class="fa fa-check"></i><b>5.1.4</b> Bias-Variance Trade-Off for <span class="math inline">\(k\)</span>-Fold Cross-Validation</a></li>
<li class="chapter" data-level="5.1.5" data-path="resampling-methods.html"><a href="resampling-methods.html#cross-validation-on-classification-problems"><i class="fa fa-check"></i><b>5.1.5</b> Cross-Validation on Classification Problems</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap-lab"><i class="fa fa-check"></i><b>5.2</b> The Bootstrap</a></li>
<li class="chapter" data-level="5.3" data-path="resampling-methods.html"><a href="resampling-methods.html#lab-cross-validation-and-the-bootstrap"><i class="fa fa-check"></i><b>5.3</b> Lab: Cross-Validation and the Bootstrap</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="resampling-methods.html"><a href="resampling-methods.html#the-validation-set-approach"><i class="fa fa-check"></i><b>5.3.1</b> The Validation Set Approach</a></li>
<li class="chapter" data-level="5.3.2" data-path="resampling-methods.html"><a href="resampling-methods.html#leave-one-out-cross-validation"><i class="fa fa-check"></i><b>5.3.2</b> Leave-One-Out Cross-Validation</a></li>
<li class="chapter" data-level="5.3.3" data-path="resampling-methods.html"><a href="resampling-methods.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>5.3.3</b> <span class="math inline">\(k\)</span>-fold Cross-Validation</a></li>
<li class="chapter" data-level="5.3.4" data-path="resampling-methods.html"><a href="resampling-methods.html#bootstrap"><i class="fa fa-check"></i><b>5.3.4</b> The Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="resampling-methods.html"><a href="resampling-methods.html#exercises-2"><i class="fa fa-check"></i><b>5.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="resampling-methods.html"><a href="resampling-methods.html#applied-2"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="resampling-methods.html"><a href="resampling-methods.html#reproducibility-2"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html"><i class="fa fa-check"></i><b>6</b> Linear Model Selection and Regularization</a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#subset-selection"><i class="fa fa-check"></i><b>6.1</b> Subset Selection</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#best-subset-selection"><i class="fa fa-check"></i><b>6.1.1</b> Best Subset Selection</a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#stepwise-selection"><i class="fa fa-check"></i><b>6.1.2</b> Stepwise Selection</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#choosing-the-optimal-model"><i class="fa fa-check"></i><b>6.1.3</b> Choosing the Optimal Model</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#shrinkage-methods"><i class="fa fa-check"></i><b>6.2</b> Shrinkage Methods</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#ridge-regression"><i class="fa fa-check"></i><b>6.2.1</b> Ridge Regression</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#the-lasso"><i class="fa fa-check"></i><b>6.2.2</b> The Lasso</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#selecting-the-tuning-parameter"><i class="fa fa-check"></i><b>6.2.3</b> Selecting the Tuning Parameter</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#dimension-reduction-methods"><i class="fa fa-check"></i><b>6.3</b> Dimension Reduction Methods</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#principal-components-regression"><i class="fa fa-check"></i><b>6.3.1</b> Principal Components Regression</a></li>
<li class="chapter" data-level="6.3.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#partial-least-squares"><i class="fa fa-check"></i><b>6.3.2</b> Partial Least Squares</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#considerations-in-high-dimensions"><i class="fa fa-check"></i><b>6.4</b> Considerations in High Dimensions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#high-dimensional-data"><i class="fa fa-check"></i><b>6.4.1</b> High-Dimensional Data</a></li>
<li class="chapter" data-level="6.4.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#what-goes-wrong-in-high-dimensions"><i class="fa fa-check"></i><b>6.4.2</b> What Goes Wrong in High Dimensions?</a></li>
<li class="chapter" data-level="6.4.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#regression-in-high-dimensions"><i class="fa fa-check"></i><b>6.4.3</b> Regression in High Dimensions</a></li>
<li class="chapter" data-level="6.4.4" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#interpreting-results-in-high-dimensions"><i class="fa fa-check"></i><b>6.4.4</b> Interpreting Results in High Dimensions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#lab-linear-models-and-regularization-methods"><i class="fa fa-check"></i><b>6.5</b> Lab: Linear Models and Regularization Methods</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#subset-selection-methods"><i class="fa fa-check"></i><b>6.5.1</b> Subset Selection Methods</a></li>
<li class="chapter" data-level="6.5.2" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#ridge-regression-and-the-lasso"><i class="fa fa-check"></i><b>6.5.2</b> Ridge Regression and the Lasso</a></li>
<li class="chapter" data-level="6.5.3" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#pcr-and-pls-regression"><i class="fa fa-check"></i><b>6.5.3</b> PCR and PLS Regression</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#exercises-3"><i class="fa fa-check"></i><b>6.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#applied-3"><i class="fa fa-check"></i>Applied</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-model-selection-and-regularization.html"><a href="linear-model-selection-and-regularization.html#reproducibility-3"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html"><i class="fa fa-check"></i><b>7</b> Moving Beyond Linearity</a>
<ul>
<li class="chapter" data-level="7.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#polynomial-regression"><i class="fa fa-check"></i><b>7.1</b> Polynomial Regression</a></li>
<li class="chapter" data-level="7.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#step-functions"><i class="fa fa-check"></i><b>7.2</b> Step Functions</a></li>
<li class="chapter" data-level="7.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#basis-functions"><i class="fa fa-check"></i><b>7.3</b> Basis Functions</a></li>
<li class="chapter" data-level="7.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#regression-splines"><i class="fa fa-check"></i><b>7.4</b> Regression Splines</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#piecewise-polynomials"><i class="fa fa-check"></i><b>7.4.1</b> Piecewise Polynomials</a></li>
<li class="chapter" data-level="7.4.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#constraints-and-splines"><i class="fa fa-check"></i><b>7.4.2</b> Constraints and Splines</a></li>
<li class="chapter" data-level="7.4.3" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#the-spline-basis-representation"><i class="fa fa-check"></i><b>7.4.3</b> The Spline Basis Representation</a></li>
<li class="chapter" data-level="7.4.4" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#choosing-the-number-and-locations-of-the-knots"><i class="fa fa-check"></i><b>7.4.4</b> Choosing the Number and Locations of the Knots</a></li>
<li class="chapter" data-level="7.4.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#comparison-to-polynomial-regression"><i class="fa fa-check"></i><b>7.4.5</b> Comparison to Polynomial Regression</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#smoothing-splines"><i class="fa fa-check"></i><b>7.5</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#an-overview-of-smoothing-splines"><i class="fa fa-check"></i><b>7.5.1</b> An Overview of Smoothing Splines</a></li>
<li class="chapter" data-level="7.5.2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#choosing-the-smoothing-parameter-lambda"><i class="fa fa-check"></i><b>7.5.2</b> Choosing the Smoothing Parameter <span class="math inline">\(\lambda\)</span></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html#reproducibility-4"><i class="fa fa-check"></i>Reproducibility</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning with the tidyverse and tidymodels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Linear Regression</h1>
<div id="simple-linear-regression" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Simple Linear Regression</h2>
<p>A straightforward approach of predicting a quantitative <span class="math inline">\(Y\)</span> from a single predictor <span class="math inline">\(X\)</span>, assuming an approximately linear relationship:</p>
<p><span class="math display">\[
Y \approx \beta_0 + \beta_1 X
\]</span></p>
<div id="estimating-the-coefficients" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Estimating the Coefficients</h3>
<p>Our goal is to obtain estimates of the coefficients <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> such that the linear model fits the data well.
There are a number of ways of evaluating fit to data, but by far the most common approach is the least squares criterion.
We define the residual sum of squares (RSS) as</p>
<p><span class="math display">\[
\text{RSS} = e_1^2 + e_2^2 + \dots + e_n^2
\]</span></p>
<p>where <span class="math inline">\(e_i = y_i - \hat{y}\)</span> is the <span class="math inline">\(i\)</span>th (out of <span class="math inline">\(n\)</span>) residual.
The least squares approach chooses <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> to minimize the RSS.
Using some calculus, one can show that</p>
<p><span class="math display">\[
\begin{align}
\hat{\beta}_1 &amp;= \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sum (x_i - \bar{x})^2}\\
\hat{\beta}_0 &amp;= \bar{y} - \hat{\beta}_1 \bar{x}
\end{align}
\]</span></p>
<p>To re-create Figure 3.1, import the <code>Advertising</code> data set:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linear-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-2"><a href="linear-regression.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb5-3"><a href="linear-regression.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="linear-regression.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Load my R package and set the ggplot theme</span></span>
<span id="cb5-5"><a href="linear-regression.html#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dunnr)</span>
<span id="cb5-6"><a href="linear-regression.html#cb5-6" aria-hidden="true" tabindex="-1"></a>extrafont<span class="sc">::</span><span class="fu">loadfonts</span>(<span class="at">device =</span> <span class="st">&quot;win&quot;</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-7"><a href="linear-regression.html#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_td</span>())</span>
<span id="cb5-8"><a href="linear-regression.html#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set_geom_fonts</span>()</span>
<span id="cb5-9"><a href="linear-regression.html#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set_palette</span>()</span>
<span id="cb5-10"><a href="linear-regression.html#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="linear-regression.html#cb5-11" aria-hidden="true" tabindex="-1"></a>advertising <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;Advertising.csv&quot;</span>))</span>
<span id="cb5-12"><a href="linear-regression.html#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(advertising)</span></code></pre></div>
<pre><code>## Rows: 200
## Columns: 5
## $ ...1      &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1~
## $ TV        &lt;dbl&gt; 230.1, 44.5, 17.2, 151.5, 180.8, 8.7, 57.5, 120.2, 8.6, 199.~
## $ radio     &lt;dbl&gt; 37.8, 39.3, 45.9, 41.3, 10.8, 48.9, 32.8, 19.6, 2.1, 2.6, 5.~
## $ newspaper &lt;dbl&gt; 69.2, 45.1, 69.3, 58.5, 58.4, 75.0, 23.5, 11.6, 1.0, 21.2, 2~
## $ sales     &lt;dbl&gt; 22.1, 10.4, 9.3, 18.5, 12.9, 7.2, 11.8, 13.2, 4.8, 10.6, 8.6~</code></pre>
<p>Fit the simple linear model and draw the residuals to the line of best fit:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="linear-regression.html#cb7-1" aria-hidden="true" tabindex="-1"></a>lm_sales_tv <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV, <span class="at">data =</span> advertising)</span>
<span id="cb7-2"><a href="linear-regression.html#cb7-2" aria-hidden="true" tabindex="-1"></a>advertising <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="linear-regression.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(</span>
<span id="cb7-4"><a href="linear-regression.html#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_sales =</span> <span class="fu">predict</span>(lm_sales_tv, <span class="at">data =</span> advertising)</span>
<span id="cb7-5"><a href="linear-regression.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="linear-regression.html#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TV)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="linear-regression.html#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> sales, <span class="at">ymax =</span> pred_sales)) <span class="sc">+</span></span>
<span id="cb7-8"><a href="linear-regression.html#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> sales), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="linear-regression.html#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="fu">coef</span>(lm_sales_tv)[<span class="dv">1</span>], <span class="at">slope =</span> <span class="fu">coef</span>(lm_sales_tv)[<span class="dv">2</span>],</span>
<span id="cb7-10"><a href="linear-regression.html#cb7-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/figure3.3-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>We recover the same regression coefficients: <span class="math inline">\(\beta_0\)</span> = 7.03 and <span class="math inline">\(\beta_1\)</span> = 0.048.</p>
</div>
<div id="assessing-the-accuracy-of-the-coefficient-estimates" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Assessing the Accuracy of the Coefficient Estimates</h3>
<blockquote>
<p>The analogy between linear regression and estimation of the mean of a
random variable is an apt one based on the concept of bias. If we use the bias sample mean <span class="math inline">\(\hat{\mu}\)</span> to estimate <span class="math inline">\(\mu\)</span>, this estimate is unbiased, in the sense that unbiased on average, we expect <span class="math inline">\(\hat{\mu}\)</span> to equal <span class="math inline">\(\mu\)</span>. What exactly does this mean? It means
that on the basis of one particular set of observations <span class="math inline">\(y_1,\dots, y_n\)</span>, <span class="math inline">\(\hat{\mu}\)</span> might
overestimate <span class="math inline">\(\mu\)</span>, and on the basis of another set of observations, <span class="math inline">\(\hat{\mu}\)</span> might
underestimate <span class="math inline">\(\mu\)</span>. But if we could average a huge number of estimates of
<span class="math inline">\(\mu\)</span> obtained from a huge number of sets of observations, then this average
would exactly equal <span class="math inline">\(\mu\)</span>. Hence, an unbiased estimator does not systematically
over- or under-estimate the true parameter.</p>
</blockquote>
<blockquote>
<p>A natural question is as follows: how accurate
is the sample mean <span class="math inline">\(\hat{\mu}\)</span> as an estimate of <span class="math inline">\(\mu\)</span>? We have established that the
average of <span class="math inline">\(\hat{\mu}\)</span>â€™s over many data sets will be very close to <span class="math inline">\(\mu\)</span>, but that a
single estimate <span class="math inline">\(\hat{\mu}\)</span> may be a substantial underestimate or overestimate of <span class="math inline">\(\mu\)</span>.
How far off will that single estimate of <span class="math inline">\(\hat{\mu}\)</span> be? In general, we answer this
question by computing the standard error of <span class="math inline">\(\hat{\mu}\)</span>, written as SE(<span class="math inline">\(\hat{\mu}\)</span>).</p>
</blockquote>
<p><span class="math display">\[
\text{Var}(\hat{\mu}) = \text{SE}(\hat{\mu})^2 = \frac{\sigma^2}{n}
\]</span></p>
<blockquote>
<p>where <span class="math inline">\(\sigma\)</span> is the standard deviation of each of the realizations <span class="math inline">\(y_i\)</span> of <span class="math inline">\(Y\)</span>.
Roughly speaking, the standard error tells us the average amount that this estimate <span class="math inline">\(\hat{\mu}\)</span> differs from the actual value of <span class="math inline">\(\mu\)</span>.</p>
</blockquote>
<blockquote>
<p>To compute the standard errors associated with <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>, we use the following formulas:</p>
</blockquote>
<p><span class="math display">\[
\begin{align}
\text{SE}(\hat{\beta}_0)^2 &amp;= \sigma^2 \left[ \frac{1}{n} + \frac{\bar{x}^2}{\sum (x_i - \bar{x})^2}\right] \\
\text{SE}(\hat{\beta}_1)^2 &amp;= \frac{\sigma^2}{\sum (x_i - \bar{x})^2}
\end{align}
\]</span></p>
<blockquote>
<p>where <span class="math inline">\(\sigma^2 = \text{Var}(\epsilon)\)</span>.</p>
</blockquote>
<blockquote>
<p>In general, <span class="math inline">\(\sigma^2\)</span> is not known, but can be estimated from the data.
This estimate of <span class="math inline">\(\sigma\)</span> is known as the residual standard error, and is given by the formula <span class="math inline">\(\text{RSE} = \sqrt{\text{RSS}/(n-2)}\)</span>.</p>
</blockquote>
<p>For linear regression, we get approximate 95% confidence intervals for the coefficients as:</p>
<p><span class="math display">\[
\begin{align}
\hat{\beta}_1 \pm 2 \text{SE}(\hat{\beta}_1) \\
\hat{\beta}_0 \pm 2 \text{SE}(\hat{\beta}_0).
\end{align}
\]</span></p>
<p>These approximations assume that the errors are Gaussian, and the factor of 2 will vary depending on the number of observations <span class="math inline">\(n\)</span>.
The true value of this factor is the 2.5% and 97.5% quantile of a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-2\)</span> degrees of freedom.
We can show this with the <code>stats::qt</code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linear-regression.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb8-2"><a href="linear-regression.html#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb8-3"><a href="linear-regression.html#cb8-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="linear-regression.html#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-5"><a href="linear-regression.html#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">qt_low =</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.025</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>),</span>
<span id="cb8-6"><a href="linear-regression.html#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">qt_high =</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb8-7"><a href="linear-regression.html#cb8-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="linear-regression.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>()</span></code></pre></div>
<div id="wgfkpoxazn" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#wgfkpoxazn .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wgfkpoxazn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wgfkpoxazn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wgfkpoxazn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wgfkpoxazn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgfkpoxazn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wgfkpoxazn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wgfkpoxazn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wgfkpoxazn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wgfkpoxazn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wgfkpoxazn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wgfkpoxazn .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#wgfkpoxazn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wgfkpoxazn .gt_from_md > :first-child {
  margin-top: 0;
}

#wgfkpoxazn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wgfkpoxazn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wgfkpoxazn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#wgfkpoxazn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgfkpoxazn .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#wgfkpoxazn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wgfkpoxazn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wgfkpoxazn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wgfkpoxazn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wgfkpoxazn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wgfkpoxazn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#wgfkpoxazn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wgfkpoxazn .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#wgfkpoxazn .gt_left {
  text-align: left;
}

#wgfkpoxazn .gt_center {
  text-align: center;
}

#wgfkpoxazn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wgfkpoxazn .gt_font_normal {
  font-weight: normal;
}

#wgfkpoxazn .gt_font_bold {
  font-weight: bold;
}

#wgfkpoxazn .gt_font_italic {
  font-style: italic;
}

#wgfkpoxazn .gt_super {
  font-size: 65%;
}

#wgfkpoxazn .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">n</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">qt_low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">qt_high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">10</td>
<td class="gt_row gt_right">-2.306004</td>
<td class="gt_row gt_right">2.306004</td></tr>
    <tr><td class="gt_row gt_right">50</td>
<td class="gt_row gt_right">-2.010635</td>
<td class="gt_row gt_right">2.010635</td></tr>
    <tr><td class="gt_row gt_right">100</td>
<td class="gt_row gt_right">-1.984467</td>
<td class="gt_row gt_right">1.984467</td></tr>
    <tr><td class="gt_row gt_right">500</td>
<td class="gt_row gt_right">-1.964739</td>
<td class="gt_row gt_right">1.964739</td></tr>
    <tr><td class="gt_row gt_right">1000</td>
<td class="gt_row gt_right">-1.962344</td>
<td class="gt_row gt_right">1.962344</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The quickest way to get the 95% confidence intervals for the coefficients is with <code>stats::confint()</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="linear-regression.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lm_sales_tv)</span></code></pre></div>
<pre><code>##                  2.5 %     97.5 %
## (Intercept) 6.12971927 7.93546783
## TV          0.04223072 0.05284256</code></pre>
<p>Computing them manually requires the standard errors of the coefficients.
For this, I prefer <code>broom::tidy</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="linear-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb11-2"><a href="linear-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_tv)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   7.03     0.458        15.4 1.41e-35
## 2 TV            0.0475   0.00269      17.7 1.47e-42</code></pre>
<p>Here is how you would calculate the SEs manually:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="linear-regression.html#cb13-1" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(advertising)</span>
<span id="cb13-2"><a href="linear-regression.html#cb13-2" aria-hidden="true" tabindex="-1"></a>bar_x <span class="ot">&lt;-</span> <span class="fu">mean</span>(advertising<span class="sc">$</span>TV)</span>
<span id="cb13-3"><a href="linear-regression.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual sum of squares</span></span>
<span id="cb13-4"><a href="linear-regression.html#cb13-4" aria-hidden="true" tabindex="-1"></a>lm_sales_tv_rss <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">resid</span>(lm_sales_tv)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-5"><a href="linear-regression.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Residual standard error (our estimate of sigma, the variance of errors)</span></span>
<span id="cb13-6"><a href="linear-regression.html#cb13-6" aria-hidden="true" tabindex="-1"></a>lm_sales_tv_rse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(lm_sales_tv_rss <span class="sc">/</span> (n_obs <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb13-7"><a href="linear-regression.html#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Intercept SE</span></span>
<span id="cb13-8"><a href="linear-regression.html#cb13-8" aria-hidden="true" tabindex="-1"></a>beta0_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(</span>
<span id="cb13-9"><a href="linear-regression.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  lm_sales_tv_rse<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span></span>
<span id="cb13-10"><a href="linear-regression.html#cb13-10" aria-hidden="true" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">/</span> n_obs) <span class="sc">+</span> bar_x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="fu">sum</span>((advertising<span class="sc">$</span>TV <span class="sc">-</span> bar_x)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb13-11"><a href="linear-regression.html#cb13-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-12"><a href="linear-regression.html#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Slope SE</span></span>
<span id="cb13-13"><a href="linear-regression.html#cb13-13" aria-hidden="true" tabindex="-1"></a>beta1_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(</span>
<span id="cb13-14"><a href="linear-regression.html#cb13-14" aria-hidden="true" tabindex="-1"></a>  lm_sales_tv_rse<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="fu">sum</span>((advertising<span class="sc">$</span>TV <span class="sc">-</span> bar_x)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-15"><a href="linear-regression.html#cb13-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-16"><a href="linear-regression.html#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(beta0_se, beta1_se)</span></code></pre></div>
<pre><code>## [1] 0.457842940 0.002690607</code></pre>
<p>Then get the 95% confidence intervals:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="linear-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_tv) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="linear-regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb15-3"><a href="linear-regression.html#cb15-3" aria-hidden="true" tabindex="-1"></a>    term, estimate, <span class="at">mult_fact =</span> <span class="fl">2.0</span>,</span>
<span id="cb15-4"><a href="linear-regression.html#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> estimate <span class="sc">-</span> mult_fact <span class="sc">*</span> std.error,</span>
<span id="cb15-5"><a href="linear-regression.html#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> estimate <span class="sc">+</span> mult_fact <span class="sc">*</span> std.error</span>
<span id="cb15-6"><a href="linear-regression.html#cb15-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term        estimate mult_fact ci_lower ci_upper
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   7.03           2   6.12     7.95  
## 2 TV            0.0475         2   0.0422   0.0529</code></pre>
<p>Note that the intervals donâ€™t exactly match those in the text.
The true multiplication factor of the SEs for this data with 200 observations is 1.9720175:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="linear-regression.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_tv) <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="linear-regression.html#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb17-3"><a href="linear-regression.html#cb17-3" aria-hidden="true" tabindex="-1"></a>    term, estimate, <span class="at">mult_fact =</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n_obs<span class="dv">-2</span>),</span>
<span id="cb17-4"><a href="linear-regression.html#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_lower =</span> estimate <span class="sc">-</span> mult_fact <span class="sc">*</span> std.error,</span>
<span id="cb17-5"><a href="linear-regression.html#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ci_upper =</span> estimate <span class="sc">+</span> mult_fact <span class="sc">*</span> std.error</span>
<span id="cb17-6"><a href="linear-regression.html#cb17-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 x 5
##   term        estimate mult_fact ci_lower ci_upper
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)   7.03        1.97   6.13     7.94  
## 2 TV            0.0475      1.97   0.0422   0.0528</code></pre>
<p>To test the null hypothesis that there is no relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, we copmute a <span class="math inline">\(t\)</span>-statistic as:</p>
<p><span class="math display">\[
t = \frac{\hat{\beta}_1 - 0}{\text{SE}(\hat{\beta}_1)}
\]</span></p>
<p>where we have written out the <span class="math inline">\(- 0\)</span> to explicitly indicate the alternative hypothesis that <span class="math inline">\(\beta_1\)</span> is different from 0.
If the null is true, then we expect that the above formula will have a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-2\)</span> degrees of freedom.
Then taking the <span class="math inline">\(t\)</span> value returned by our model, we compute the probability of observing a value equal to or greater than that value assuming <span class="math inline">\(\beta_1 = 0\)</span>.
This probability is the <span class="math inline">\(p\)</span>-value.</p>
<p>The <span class="math inline">\(t\)</span>-statistics are returned by <code>broom::tidy</code> as the <code>statistic</code> variable.
It also returns the <span class="math inline">\(p\)</span>-values, which we can manually compute as well with <code>stats::pt</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="linear-regression.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_tv) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="linear-regression.html#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-3"><a href="linear-regression.html#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value_manual =</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span>statistic, <span class="at">df =</span> n_obs <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb19-4"><a href="linear-regression.html#cb19-4" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   term        estimate std.error statistic  p.value p.value_manual
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;
## 1 (Intercept)   7.03     0.458        15.4 1.41e-35       1.41e-35
## 2 TV            0.0475   0.00269      17.7 1.47e-42       1.47e-42</code></pre>
</div>
<div id="assessing-the-accuracy-of-the-model" class="section level3" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Assessing the Accuracy of the Model</h3>
<blockquote>
<p>The quality of a linear regression fit is typically assessed
using two related quantities: the residual standard error (RSE) and the <span class="math inline">\(R^2\)</span> statistic.</p>
</blockquote>
<p>The <code>broom::glance</code> function gives summary statistics of a model:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="linear-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_sales_tv)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 12
##   r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.612         0.610  3.26      312. 1.47e-42     1  -519. 1044. 1054.
## # ... with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<div id="residual-standard-error" class="section level4 unnumbered">
<h4>Residual Standard Error</h4>
<p>The residual standard error (RSE) is <code>sigma</code>, variance explained <span class="math inline">\(R^2\)</span> is <code>r.squared</code>, and the <span class="math inline">\(F\)</span>-statistic is <code>statistic</code>.
With this, we can re-create Table 3.2:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="linear-regression.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb23-2"><a href="linear-regression.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_sales_tv) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="linear-regression.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">Residual standard error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(sigma, <span class="dv">2</span>),</span>
<span id="cb23-4"><a href="linear-regression.html#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">R2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="st">`</span><span class="at">F-statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(statistic, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="linear-regression.html#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb23-6"><a href="linear-regression.html#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Quantity&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-7"><a href="linear-regression.html#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ktznibneqp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ktznibneqp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ktznibneqp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ktznibneqp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ktznibneqp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ktznibneqp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ktznibneqp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ktznibneqp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ktznibneqp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ktznibneqp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ktznibneqp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ktznibneqp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ktznibneqp .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ktznibneqp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ktznibneqp .gt_from_md > :first-child {
  margin-top: 0;
}

#ktznibneqp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ktznibneqp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ktznibneqp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ktznibneqp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ktznibneqp .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ktznibneqp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ktznibneqp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ktznibneqp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ktznibneqp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ktznibneqp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ktznibneqp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ktznibneqp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ktznibneqp .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ktznibneqp .gt_left {
  text-align: left;
}

#ktznibneqp .gt_center {
  text-align: center;
}

#ktznibneqp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ktznibneqp .gt_font_normal {
  font-weight: normal;
}

#ktznibneqp .gt_font_bold {
  font-weight: bold;
}

#ktznibneqp .gt_font_italic {
  font-style: italic;
}

#ktznibneqp .gt_super {
  font-size: 65%;
}

#ktznibneqp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Quantity</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Residual standard error</td>
<td class="gt_row gt_left">3.26</td></tr>
    <tr><td class="gt_row gt_left">R2</td>
<td class="gt_row gt_left">0.612</td></tr>
    <tr><td class="gt_row gt_left">F-statistic</td>
<td class="gt_row gt_left">312.1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="r2-statistic" class="section level4 unnumbered">
<h4><span class="math inline">\(R^2\)</span> Statistic</h4>
<blockquote>
<p>The RSE provides an absolute measure of lack of fit of the model (3.5)
to the data. But since it is measured in the units of <span class="math inline">\(Y\)</span>, it is not always
clear what constitutes a good RSE. The <span class="math inline">\(R^2\)</span> statistic provides an alternative
measure of fit. It takes the form of a proportionâ€”the proportion of variance
explained â€”- and so it always takes on a value between 0 and 1, and is
independent of the scale of <span class="math inline">\(Y\)</span>.</p>
</blockquote>
<p><span class="math display">\[
R^2 = \frac{\text{TSS} - \text{RSS}}{\text{TSS}} = 1 - \frac{\text{RSS}}{\text{TSS}}
\]</span></p>
<blockquote>
<p>where <span class="math inline">\(\text{TSS} = \sum (y_i - \bar{y})^2\)</span> is the total sum of squares.</p>
</blockquote>
<p>The easiest way to think of it in linear regression terms, is as a measure of improvement by the sloped line over a horizontal line (the mean of <span class="math inline">\(Y\)</span>) through the data.</p>
<p>The correlation between variables:</p>
<p><span class="math display">\[
\text{Cor}(X, Y) = \frac{\sum (x_i - \bar{x})(y_i - \bar{y})}{\sqrt{\sum (x_i - \bar{x})^2} \sqrt{\sum (y_i - \bar{y})^2}}
\]</span></p>
<p>is exactly the same in the linear regression setting, <span class="math inline">\(R^2 = r^2\)</span>.
In multivariable regression (the next section), this is (usually) not the case, in which case we use <span class="math inline">\(R^2\)</span>.</p>
</div>
</div>
</div>
<div id="multiple-linear-regression" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Multiple Linear Regression</h2>
<blockquote>
<p>Simple linear regression is a useful approach for predicting a response on the
basis of a single predictor variable. However, in practice we often have more
than one predictor.</p>
</blockquote>
<blockquote>
<p>One option is to run three separate simple linear regressions, â€¦
However, the approach of fitting a separate simple linear regression model
for each predictor is not entirely satisfactoryâ€¦
Instead of fitting a separate simple linear regression model for each predictor, a better approach is to extend the simple linear regression model
(3.5) so that it can directly accommodate multiple predictors.</p>
</blockquote>
<p>The model with <span class="math inline">\(p\)</span> predictors takes the form:</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p + \epsilon.
\]</span></p>
<p>We interpret the slope <span class="math inline">\(\beta_j\)</span> as the average effect on <span class="math inline">\(Y\)</span> by a one unit increase in <span class="math inline">\(X_j\)</span> while holding all other predictors fixed.</p>
<div id="estimating-the-regression-coefficients" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Estimating the Regression Coefficients</h3>
<p>The parameters are estimated using the same least squares approach as simple linear regression: choose <span class="math inline">\(\beta_0 \dots \beta_p\)</span> to minimize RSS.
However, the formula to estimate these parameters have more complicated forms that are harder to interpret than in simple regression.</p>
<p>Re-create Table 3.4 by regressing <code>sales</code> on <code>TV</code>, <code>radio</code>, and <code>newspaper</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="linear-regression.html#cb24-1" aria-hidden="true" tabindex="-1"></a>lm_sales_mult <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> advertising)</span>
<span id="cb24-2"><a href="linear-regression.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Since I will be reproducing this table often, write a function</span></span>
<span id="cb24-3"><a href="linear-regression.html#cb24-3" aria-hidden="true" tabindex="-1"></a>tidy_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(mod, <span class="at">coef_round =</span> <span class="dv">3</span>, <span class="at">se_round =</span> <span class="dv">4</span>, <span class="at">t_round =</span> <span class="dv">2</span>) {</span>
<span id="cb24-4"><a href="linear-regression.html#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(mod) <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="linear-regression.html#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transmute</span>(</span>
<span id="cb24-6"><a href="linear-regression.html#cb24-6" aria-hidden="true" tabindex="-1"></a>      term,</span>
<span id="cb24-7"><a href="linear-regression.html#cb24-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">coefficient =</span> <span class="fu">round</span>(estimate, coef_round),</span>
<span id="cb24-8"><a href="linear-regression.html#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">std.error =</span> <span class="fu">round</span>(std.error, se_round),</span>
<span id="cb24-9"><a href="linear-regression.html#cb24-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">t-statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(statistic, t_round),</span>
<span id="cb24-10"><a href="linear-regression.html#cb24-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">p-value</span><span class="st">`</span> <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value)</span>
<span id="cb24-11"><a href="linear-regression.html#cb24-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-12"><a href="linear-regression.html#cb24-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-13"><a href="linear-regression.html#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_sales_mult) <span class="sc">%&gt;%</span></span>
<span id="cb24-14"><a href="linear-regression.html#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="gsmniuquyu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gsmniuquyu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gsmniuquyu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gsmniuquyu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gsmniuquyu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gsmniuquyu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsmniuquyu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gsmniuquyu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gsmniuquyu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gsmniuquyu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gsmniuquyu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gsmniuquyu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gsmniuquyu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gsmniuquyu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gsmniuquyu .gt_from_md > :first-child {
  margin-top: 0;
}

#gsmniuquyu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gsmniuquyu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gsmniuquyu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#gsmniuquyu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsmniuquyu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#gsmniuquyu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gsmniuquyu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gsmniuquyu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gsmniuquyu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gsmniuquyu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gsmniuquyu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#gsmniuquyu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gsmniuquyu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#gsmniuquyu .gt_left {
  text-align: left;
}

#gsmniuquyu .gt_center {
  text-align: center;
}

#gsmniuquyu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gsmniuquyu .gt_font_normal {
  font-weight: normal;
}

#gsmniuquyu .gt_font_bold {
  font-weight: bold;
}

#gsmniuquyu .gt_font_italic {
  font-style: italic;
}

#gsmniuquyu .gt_super {
  font-size: 65%;
}

#gsmniuquyu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.939</td>
<td class="gt_row gt_right">0.3119</td>
<td class="gt_row gt_right">9.42</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">TV</td>
<td class="gt_row gt_right">0.046</td>
<td class="gt_row gt_right">0.0014</td>
<td class="gt_row gt_right">32.81</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio</td>
<td class="gt_row gt_right">0.189</td>
<td class="gt_row gt_right">0.0086</td>
<td class="gt_row gt_right">21.89</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">newspaper</td>
<td class="gt_row gt_right">-0.001</td>
<td class="gt_row gt_right">0.0059</td>
<td class="gt_row gt_right">-0.18</td>
<td class="gt_row gt_left">0.860</td></tr>
  </tbody>
  
  
</table>
</div>
<p>To understand why there is no relationship between <code>sales</code> and <code>newspaper</code>, consider the correlation between the variables:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="linear-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrr)</span>
<span id="cb25-2"><a href="linear-regression.html#cb25-2" aria-hidden="true" tabindex="-1"></a>advertising <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="linear-regression.html#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(TV, radio, newspaper, sales) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="linear-regression.html#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="linear-regression.html#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">&quot;var&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="linear-regression.html#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>var, round, <span class="dv">4</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="linear-regression.html#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">&quot;var&quot;</span>)</span></code></pre></div>
<div id="bfqebtemfv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#bfqebtemfv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bfqebtemfv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bfqebtemfv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bfqebtemfv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bfqebtemfv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfqebtemfv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bfqebtemfv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bfqebtemfv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bfqebtemfv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bfqebtemfv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bfqebtemfv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bfqebtemfv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#bfqebtemfv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bfqebtemfv .gt_from_md > :first-child {
  margin-top: 0;
}

#bfqebtemfv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bfqebtemfv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bfqebtemfv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#bfqebtemfv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqebtemfv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#bfqebtemfv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bfqebtemfv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bfqebtemfv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bfqebtemfv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bfqebtemfv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bfqebtemfv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#bfqebtemfv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bfqebtemfv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#bfqebtemfv .gt_left {
  text-align: left;
}

#bfqebtemfv .gt_center {
  text-align: center;
}

#bfqebtemfv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bfqebtemfv .gt_font_normal {
  font-weight: normal;
}

#bfqebtemfv .gt_font_bold {
  font-weight: bold;
}

#bfqebtemfv .gt_font_italic {
  font-style: italic;
}

#bfqebtemfv .gt_super {
  font-size: 65%;
}

#bfqebtemfv .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">TV</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">radio</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">newspaper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">sales</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left gt_stub">TV</td>
<td class="gt_row gt_right">1.0000</td>
<td class="gt_row gt_right">0.0548</td>
<td class="gt_row gt_right">0.0566</td>
<td class="gt_row gt_right">0.7822</td></tr>
    <tr><td class="gt_row gt_left gt_stub">radio</td>
<td class="gt_row gt_right">0.0548</td>
<td class="gt_row gt_right">1.0000</td>
<td class="gt_row gt_right">0.3541</td>
<td class="gt_row gt_right">0.5762</td></tr>
    <tr><td class="gt_row gt_left gt_stub">newspaper</td>
<td class="gt_row gt_right">0.0566</td>
<td class="gt_row gt_right">0.3541</td>
<td class="gt_row gt_right">1.0000</td>
<td class="gt_row gt_right">0.2283</td></tr>
    <tr><td class="gt_row gt_left gt_stub">sales</td>
<td class="gt_row gt_right">0.7822</td>
<td class="gt_row gt_right">0.5762</td>
<td class="gt_row gt_right">0.2283</td>
<td class="gt_row gt_right">1.0000</td></tr>
  </tbody>
  
  
</table>
</div>
<p>High correlation between <code>radio</code> and <code>newspaper</code> suggest that the former is driving the relationship with <code>sales</code>.</p>
</div>
<div id="some-important-questions" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Some Important Questions</h3>
<div id="one-is-there-a-relationship-between-the-response-and-predictors" class="section level4 unnumbered">
<h4>One: Is There a Relationship Between the Response and Predictors?</h4>
<p>Consider the hypothesis test:</p>
<p><span class="math display">\[
\begin{align}
H_0:&amp; \beta_1 = \beta_2 = \dots = \beta_p = 0 \\
H_a:&amp; \text{at least one of } \beta_j \text{ is non-zero.}
\end{align}
\]</span>
This is performed by computing the <span class="math inline">\(F\)</span>-statistic:</p>
<p><span class="math display">\[
F = \frac{(\text{TSS} - \text{RSS})/p}{\text{RSS}/(n - p - 1)}
\]</span></p>
<p>The denominator should be familiar from simple linear regression: it is the RSS divided by the degrees of freedom, so our estimate of <span class="math inline">\(\sigma^2\)</span>.
Likewise, the expected value of the numerator is also <span class="math inline">\(\sigma^2\)</span> provided that <span class="math inline">\(H_0\)</span> is true.
Hence, when there is no relationship between response and predictors, we expect <span class="math inline">\(F \approx 1\)</span>, and <span class="math inline">\(F &gt; 1\)</span> when <span class="math inline">\(H_a\)</span> is true.</p>
<p>Instead of computing manually, use <code>broom::glance</code> to re-create Table 3.6:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="linear-regression.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_sales_mult) <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="linear-regression.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="st">`</span><span class="at">Residual standard error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(sigma, <span class="dv">2</span>),</span>
<span id="cb26-3"><a href="linear-regression.html#cb26-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">R2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="st">`</span><span class="at">F-statistic</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(statistic, <span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="linear-regression.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.character)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="linear-regression.html#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;Quantity&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;Value&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="linear-regression.html#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="vvqirzecbt" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vvqirzecbt .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vvqirzecbt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vvqirzecbt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vvqirzecbt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vvqirzecbt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvqirzecbt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vvqirzecbt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vvqirzecbt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vvqirzecbt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vvqirzecbt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vvqirzecbt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vvqirzecbt .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vvqirzecbt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vvqirzecbt .gt_from_md > :first-child {
  margin-top: 0;
}

#vvqirzecbt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vvqirzecbt .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vvqirzecbt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#vvqirzecbt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvqirzecbt .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#vvqirzecbt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvqirzecbt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vvqirzecbt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vvqirzecbt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvqirzecbt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vvqirzecbt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#vvqirzecbt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vvqirzecbt .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#vvqirzecbt .gt_left {
  text-align: left;
}

#vvqirzecbt .gt_center {
  text-align: center;
}

#vvqirzecbt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vvqirzecbt .gt_font_normal {
  font-weight: normal;
}

#vvqirzecbt .gt_font_bold {
  font-weight: bold;
}

#vvqirzecbt .gt_font_italic {
  font-style: italic;
}

#vvqirzecbt .gt_super {
  font-size: 65%;
}

#vvqirzecbt .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Quantity</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Residual standard error</td>
<td class="gt_row gt_left">1.69</td></tr>
    <tr><td class="gt_row gt_left">R2</td>
<td class="gt_row gt_left">0.897</td></tr>
    <tr><td class="gt_row gt_left">F-statistic</td>
<td class="gt_row gt_left">570.3</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The value of 570 is far larger than 1, which is compelling evidence against the null <span class="math inline">\(H_0\)</span>.
The <span class="math inline">\(F\)</span>-statistic follows the <span class="math inline">\(F\)</span>-distribution (assuming <span class="math inline">\(H_0\)</span> is true and the errors <span class="math inline">\(\epsilon_i\)</span> are normally distributed), so we can get a <span class="math inline">\(p\)</span>-value using the values of <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>.
Or automatically with <code>glance</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="linear-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_sales_mult) <span class="sc">%&gt;%</span> <span class="fu">select</span>(statistic, p.value)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   statistic  p.value
##       &lt;dbl&gt;    &lt;dbl&gt;
## 1      570. 1.58e-96</code></pre>
<p>Another way to do this is to explicitly fit the null model (no predictors, intercept only), and perform an analysis of variance with the two models using <code>anova</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="linear-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a>lm_sales_null <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> advertising)</span>
<span id="cb29-2"><a href="linear-regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_sales_null, lm_sales_mult)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: sales ~ 1
## Model 2: sales ~ TV + radio + newspaper
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    199 5417.1                                  
## 2    196  556.8  3    4860.3 570.27 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This approach can also be used to test that a particular subset of <span class="math inline">\(q\)</span> coefficients are zero:</p>
<p><span class="math display">\[
H_0: \beta_{p-q+1} = \beta_{p-q+2} = \dots = \beta_p = 0 \\
\]</span></p>
<p>In this case, we fit a second model that uses all the variables except those <span class="math inline">\(q\)</span>, with a residual sum of squares we call <span class="math inline">\(\text{RSS}_0\)</span>.
Then the appropriate <span class="math inline">\(F\)</span>_statistic is:</p>
<p><span class="math display">\[
F = \frac{(\text{RSS}_0 - \text{RSS})/q}{\text{RSS}/(n-p-1)}
\]</span></p>
<p>It turns out the multivariable model already does this for <span class="math inline">\(q = 1\)</span>.
The square of each <span class="math inline">\(t\)</span>-statistic is the exact same as the <span class="math inline">\(F\)</span>-statistic we would get by removing that variable:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="linear-regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_mult)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)  2.94      0.312       9.42  1.27e-17
## 2 TV           0.0458    0.00139    32.8   1.51e-81
## 3 radio        0.189     0.00861    21.9   1.51e-54
## 4 newspaper   -0.00104   0.00587    -0.177 8.60e- 1</code></pre>
<p>For example, the <span class="math inline">\(t\)</span>-statistic for <code>TV</code> is 32.81.
Use <code>anova</code> to compare models with and without `TV:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="linear-regression.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(</span>
<span id="cb33-2"><a href="linear-regression.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(sales <span class="sc">~</span> radio <span class="sc">+</span> newspaper, <span class="at">data =</span> advertising),</span>
<span id="cb33-3"><a href="linear-regression.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  lm_sales_mult</span>
<span id="cb33-4"><a href="linear-regression.html#cb33-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: sales ~ radio + newspaper
## Model 2: sales ~ TV + radio + newspaper
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1    197 3614.8                                  
## 2    196  556.8  1      3058 1076.4 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The <span class="math inline">\(F\)</span>-statistic here is the square of the <span class="math inline">\(t\)</span>-statistic: 1076.4.</p>
</div>
<div id="two-deciding-on-important-variables" class="section level4 unnumbered">
<h4>Two: Deciding on Important Variables</h4>
<blockquote>
<p>The task of determining which predictors are
associated with the response, in order to fit a single model involving only
those predictors, is referred to as variable selection.</p>
</blockquote>
<blockquote>
<p>Ideally, we would like to perform variable selection by trying out a lot of
different models, each containing a different subset of the predictors. For
instance, if <span class="math inline">\(p = 2\)</span>, then we can consider four models: (1) a model containing no variables, (2) a model containing <span class="math inline">\(X_1\)</span> only, (3) a model containing
<span class="math inline">\(X_2\)</span> only, and (4) a model containing both <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>. We can then select the best model out of all of the models that we have considered. How
do we determine which model is best? Various statistics can be used to
judge the quality of a model. These include Mallowâ€™s <span class="math inline">\(C_p\)</span>, Akaike information criterion (AIC), Bayesian information criterion (BIC), and adjusted <span class="math inline">\(R^2\)</span>.
These are discussed in more detail in Chapter 6. We can also determine which model is best by plotting various model outputs, such as the residuals, in order to search for patterns.</p>
</blockquote>
<p>There are a lot of reasons to avoid the stepwise variable selection methods detailed here (forward, backward and mixed).
See <a href="https://www.stata.com/support/faqs/statistics/stepwise-regression-problems/">this article</a> and <span class="citation"><a href="#ref-Smith2018" role="doc-biblioref">Smith</a> (<a href="#ref-Smith2018" role="doc-biblioref">2018</a>)</span>, for example.</p>
</div>
<div id="three-model-fit" class="section level4 unnumbered">
<h4>Three: Model Fit</h4>
<p>Most commonly, we use RSE and <span class="math inline">\(R^2\)</span> to quantify model fit.
In simple regression, <span class="math inline">\(R^2\)</span> is the square of the correlation between response and predictor.
In multiple linear regression, it equals the square of the correlation between response and the fitted linear model: <span class="math inline">\(R^2 = \text{Cor}(Y, \hat{Y})^2\)</span>.</p>
<blockquote>
<p>It turns out that <span class="math inline">\(R^2\)</span> will always increase when
more variables are added to the model, even if those variables are only
weakly associated with the response. This is due to the fact that adding
another variable always results in a decrease in the residual sum of squares
on the training data (though not necessarily the testing data).</p>
</blockquote>
</div>
<div id="four-predictions" class="section level4 unnumbered">
<h4>Four: Predictions</h4>
<p>With a fit regression model, it is straightforward to make predictions of the response <span class="math inline">\(Y\)</span>.
There are three sources of uncertainty in these predictions:</p>
<ol style="list-style-type: decimal">
<li>The coefficient estimates <span class="math inline">\(\hat{\beta}_i\)</span> are estimates of the true <span class="math inline">\(\beta_i\)</span>. This inaccuracy is part of the reducible error.</li>
<li>Assuming a linear model of <span class="math inline">\(f(X)\)</span> is almost always an approximation of reality, so it is an additional form of reducible error we call model bias.</li>
<li>The random error term <span class="math inline">\(\epsilon\)</span>, which is irreducible. To quantify how much <span class="math inline">\(Y\)</span> will vary from <span class="math inline">\(\hat{Y}\)</span>, we use prediction intervals, which are always wider than confidence intervals because they incorporate both reducible error (in our estimate for <span class="math inline">\(f(X)\)</span>) and irreducible error.</li>
</ol>
</div>
</div>
</div>
<div id="other-considerations-in-the-regression-model" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Other Considerations in the Regression Model</h2>
<div id="qualitative-predictors" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Qualitative Predictors</h3>
<div id="predictors-with-only-two-levels" class="section level4 unnumbered">
<h4>Predictors with Only Two Levels</h4>
<p>With only two levels in the predictor, we use models that look like this:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \epsilon_i = 
\begin{cases}
\beta_0 + \beta_1 + \epsilon_i, &amp; \text{if } i\text{th person owns a house} \\
\beta_0 + \epsilon_i, &amp; \text{if } i\text{th person does not}.
\end{cases}
\]</span></p>
<p>Load the <code>credit</code> data set and regress credit card balance on home ownership:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="linear-regression.html#cb35-1" aria-hidden="true" tabindex="-1"></a>credit <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Credit</span>
<span id="cb35-2"><a href="linear-regression.html#cb35-2" aria-hidden="true" tabindex="-1"></a>lm_balance_own <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Own, <span class="at">data =</span> credit)</span>
<span id="cb35-3"><a href="linear-regression.html#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="linear-regression.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_balance_own, <span class="at">coef_round =</span> <span class="dv">2</span>, <span class="at">se_round =</span> <span class="dv">2</span>, <span class="at">t_round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="linear-regression.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="gjizqnnmyk" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#gjizqnnmyk .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gjizqnnmyk .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gjizqnnmyk .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gjizqnnmyk .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gjizqnnmyk .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjizqnnmyk .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gjizqnnmyk .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gjizqnnmyk .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gjizqnnmyk .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gjizqnnmyk .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gjizqnnmyk .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gjizqnnmyk .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#gjizqnnmyk .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gjizqnnmyk .gt_from_md > :first-child {
  margin-top: 0;
}

#gjizqnnmyk .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gjizqnnmyk .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gjizqnnmyk .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#gjizqnnmyk .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjizqnnmyk .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#gjizqnnmyk .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gjizqnnmyk .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gjizqnnmyk .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gjizqnnmyk .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gjizqnnmyk .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gjizqnnmyk .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#gjizqnnmyk .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gjizqnnmyk .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#gjizqnnmyk .gt_left {
  text-align: left;
}

#gjizqnnmyk .gt_center {
  text-align: center;
}

#gjizqnnmyk .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gjizqnnmyk .gt_font_normal {
  font-weight: normal;
}

#gjizqnnmyk .gt_font_bold {
  font-weight: bold;
}

#gjizqnnmyk .gt_font_italic {
  font-style: italic;
}

#gjizqnnmyk .gt_super {
  font-size: 65%;
}

#gjizqnnmyk .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">509.80</td>
<td class="gt_row gt_right">33.13</td>
<td class="gt_row gt_right">15.389</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">OwnYes</td>
<td class="gt_row gt_right">19.73</td>
<td class="gt_row gt_right">46.05</td>
<td class="gt_row gt_right">0.429</td>
<td class="gt_row gt_left">0.669</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="qualitative-predictors-with-more-than-two-levels" class="section level4 unnumbered">
<h4>Qualitative Predictors with More than Two Levels</h4>
<p>And with region (three levels):</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \epsilon_i = 
\begin{cases}
\beta_0 + \beta_1 + \epsilon_i, &amp; \text{if } i\text{th person is from the South} \\
\beta_0 + \beta_2 + \epsilon_i, &amp; \text{if } i\text{th person is from the West} \\
\beta_0 + \epsilon_i, &amp; \text{if } i\text{th person is from the East}.
\end{cases}
\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="linear-regression.html#cb36-1" aria-hidden="true" tabindex="-1"></a>lm_balance_region <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Region, <span class="at">data =</span> credit)</span>
<span id="cb36-2"><a href="linear-regression.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_balance_region, <span class="at">coef_round =</span> <span class="dv">2</span>, <span class="at">se_round =</span> <span class="dv">2</span>, <span class="at">t_round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="linear-regression.html#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="qnfeipzvnw" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qnfeipzvnw .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qnfeipzvnw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qnfeipzvnw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qnfeipzvnw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qnfeipzvnw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnfeipzvnw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qnfeipzvnw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qnfeipzvnw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qnfeipzvnw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qnfeipzvnw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qnfeipzvnw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qnfeipzvnw .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qnfeipzvnw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qnfeipzvnw .gt_from_md > :first-child {
  margin-top: 0;
}

#qnfeipzvnw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qnfeipzvnw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qnfeipzvnw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qnfeipzvnw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnfeipzvnw .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qnfeipzvnw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qnfeipzvnw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qnfeipzvnw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qnfeipzvnw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qnfeipzvnw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qnfeipzvnw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qnfeipzvnw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qnfeipzvnw .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qnfeipzvnw .gt_left {
  text-align: left;
}

#qnfeipzvnw .gt_center {
  text-align: center;
}

#qnfeipzvnw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qnfeipzvnw .gt_font_normal {
  font-weight: normal;
}

#qnfeipzvnw .gt_font_bold {
  font-weight: bold;
}

#qnfeipzvnw .gt_font_italic {
  font-style: italic;
}

#qnfeipzvnw .gt_super {
  font-size: 65%;
}

#qnfeipzvnw .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">531.00</td>
<td class="gt_row gt_right">46.32</td>
<td class="gt_row gt_right">11.464</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">RegionSouth</td>
<td class="gt_row gt_right">-12.50</td>
<td class="gt_row gt_right">56.68</td>
<td class="gt_row gt_right">-0.221</td>
<td class="gt_row gt_left">0.826</td></tr>
    <tr><td class="gt_row gt_left">RegionWest</td>
<td class="gt_row gt_right">-18.69</td>
<td class="gt_row gt_right">65.02</td>
<td class="gt_row gt_right">-0.287</td>
<td class="gt_row gt_left">0.774</td></tr>
  </tbody>
  
  
</table>
</div>
<p>To run the <span class="math inline">\(F\)</span>-test, use <code>anova()</code>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="linear-regression.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_balance_region)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Balance
##            Df   Sum Sq Mean Sq F value Pr(&gt;F)
## Region      2    18454    9227  0.0434 0.9575
## Residuals 397 84321458  212397</code></pre>
<p>which tells us that we cannot reject the null that there is no relationship between <code>balance</code> and <code>region</code>.</p>
</div>
</div>
<div id="extensions-of-the-linear-model" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Extensions of the Linear Model</h3>
<blockquote>
<p>The standard linear regression model (3.19) provides interpretable results
and works quite well on many real-world problems. However, it makes several highly restrictive assumptions that are often violated in practice. Two
of the most important assumptions state that the relationship between the
predictors and response are additive and linear.</p>
</blockquote>
<div id="removing-the-additive-assumption" class="section level4 unnumbered">
<h4>Removing the Additive Assumption</h4>
<p>This assumption is that the association between a predictor <span class="math inline">\(X_j\)</span> and the response <span class="math inline">\(Y\)</span> does not depend on the values of other predictors.</p>
<p>In our advertising example, suppose that spending money on radio actually increases the effectiveness of TV advertising, i.e.Â the the slope term for <code>TV</code> actually increases as <code>radio</code> increases.
In marketing, this is synergy.
In statistics, this is an interaction effect.
The models with and without an interaction effect are:</p>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon \\
Y &amp;= \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_1 X_2 + \epsilon
\end{align}
\]</span></p>
<p>The effect on <code>sales</code>, with an interaction term between <code>TV</code> and <code>radio</code>:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="linear-regression.html#cb39-1" aria-hidden="true" tabindex="-1"></a>lm_sales_inter <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> radio <span class="sc">*</span> TV, <span class="at">data =</span> advertising)</span>
<span id="cb39-2"><a href="linear-regression.html#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_sales_inter, <span class="at">coef_round =</span> <span class="dv">4</span>, <span class="at">se_round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="linear-regression.html#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="eckhlavfqd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#eckhlavfqd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eckhlavfqd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eckhlavfqd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eckhlavfqd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eckhlavfqd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eckhlavfqd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eckhlavfqd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eckhlavfqd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eckhlavfqd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eckhlavfqd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eckhlavfqd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eckhlavfqd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#eckhlavfqd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eckhlavfqd .gt_from_md > :first-child {
  margin-top: 0;
}

#eckhlavfqd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eckhlavfqd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eckhlavfqd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#eckhlavfqd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eckhlavfqd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#eckhlavfqd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eckhlavfqd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eckhlavfqd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eckhlavfqd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eckhlavfqd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eckhlavfqd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#eckhlavfqd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eckhlavfqd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#eckhlavfqd .gt_left {
  text-align: left;
}

#eckhlavfqd .gt_center {
  text-align: center;
}

#eckhlavfqd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eckhlavfqd .gt_font_normal {
  font-weight: normal;
}

#eckhlavfqd .gt_font_bold {
  font-weight: bold;
}

#eckhlavfqd .gt_font_italic {
  font-style: italic;
}

#eckhlavfqd .gt_super {
  font-size: 65%;
}

#eckhlavfqd .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">6.7502</td>
<td class="gt_row gt_right">0.248</td>
<td class="gt_row gt_right">27.23</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio</td>
<td class="gt_row gt_right">0.0289</td>
<td class="gt_row gt_right">0.009</td>
<td class="gt_row gt_right">3.24</td>
<td class="gt_row gt_left">0.001</td></tr>
    <tr><td class="gt_row gt_left">TV</td>
<td class="gt_row gt_right">0.0191</td>
<td class="gt_row gt_right">0.002</td>
<td class="gt_row gt_right">12.70</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio:TV</td>
<td class="gt_row gt_right">0.0011</td>
<td class="gt_row gt_right">0.000</td>
<td class="gt_row gt_right">20.73</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Compare the model with and without the interaction term:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="linear-regression.html#cb40-1" aria-hidden="true" tabindex="-1"></a>lm_sales_radio_tv <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> radio <span class="sc">+</span> TV, <span class="at">data =</span> advertising)</span>
<span id="cb40-2"><a href="linear-regression.html#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="linear-regression.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_sales_radio_tv) <span class="sc">%&gt;%</span></span>
<span id="cb40-4"><a href="linear-regression.html#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;additive&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-5"><a href="linear-regression.html#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb40-6"><a href="linear-regression.html#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>(lm_sales_inter) <span class="sc">%&gt;%</span></span>
<span id="cb40-7"><a href="linear-regression.html#cb40-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;interaction&quot;</span>)</span>
<span id="cb40-8"><a href="linear-regression.html#cb40-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-9"><a href="linear-regression.html#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model, r.squared, AIC, BIC) <span class="sc">%&gt;%</span></span>
<span id="cb40-10"><a href="linear-regression.html#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="pbrvvzhovv" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pbrvvzhovv .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pbrvvzhovv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbrvvzhovv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pbrvvzhovv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pbrvvzhovv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbrvvzhovv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pbrvvzhovv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pbrvvzhovv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pbrvvzhovv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pbrvvzhovv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pbrvvzhovv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pbrvvzhovv .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pbrvvzhovv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pbrvvzhovv .gt_from_md > :first-child {
  margin-top: 0;
}

#pbrvvzhovv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pbrvvzhovv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pbrvvzhovv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pbrvvzhovv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbrvvzhovv .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pbrvvzhovv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pbrvvzhovv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pbrvvzhovv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pbrvvzhovv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pbrvvzhovv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbrvvzhovv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pbrvvzhovv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pbrvvzhovv .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pbrvvzhovv .gt_left {
  text-align: left;
}

#pbrvvzhovv .gt_center {
  text-align: center;
}

#pbrvvzhovv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pbrvvzhovv .gt_font_normal {
  font-weight: normal;
}

#pbrvvzhovv .gt_font_bold {
  font-weight: bold;
}

#pbrvvzhovv .gt_font_italic {
  font-style: italic;
}

#pbrvvzhovv .gt_super {
  font-size: 65%;
}

#pbrvvzhovv .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">r.squared</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">AIC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">BIC</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">additive</td>
<td class="gt_row gt_right">0.8971943</td>
<td class="gt_row gt_right">780.3941</td>
<td class="gt_row gt_right">793.5874</td></tr>
    <tr><td class="gt_row gt_left">interaction</td>
<td class="gt_row gt_right">0.9677905</td>
<td class="gt_row gt_right">550.2778</td>
<td class="gt_row gt_right">566.7694</td></tr>
  </tbody>
  
  
</table>
</div>
<p>What if the interaction term was highly insignificant, but the associated main effects were not?
The hierarchical principle states that if we include an interaction in a model, we should also include the main effects, even if the <span class="math inline">\(p\)</span>-values of their coefficients are not significant.</p>
<p>The concept of interactions applies just as well to qualitative variables.
Re-create Figure 3.7, comparing the balance model with and without an interaction term of <code>Income</code> and <code>Student</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="linear-regression.html#cb41-1" aria-hidden="true" tabindex="-1"></a>lm_balance_income_student <span class="ot">&lt;-</span></span>
<span id="cb41-2"><a href="linear-regression.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(Balance <span class="sc">~</span> Income <span class="sc">+</span> Student, <span class="at">data =</span> credit)</span>
<span id="cb41-3"><a href="linear-regression.html#cb41-3" aria-hidden="true" tabindex="-1"></a>lm_balance_income_student_inter <span class="ot">&lt;-</span></span>
<span id="cb41-4"><a href="linear-regression.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(Balance <span class="sc">~</span> Income <span class="sc">*</span> Student, <span class="at">data =</span> credit)</span>
<span id="cb41-5"><a href="linear-regression.html#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="linear-regression.html#cb41-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Income =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="linear-regression.html#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crossing</span>(<span class="at">Student =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>)))</span>
<span id="cb41-8"><a href="linear-regression.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="fu">augment</span>(lm_balance_income_student, <span class="at">newdata =</span> d) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="linear-regression.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;additive&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-10"><a href="linear-regression.html#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb41-11"><a href="linear-regression.html#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(lm_balance_income_student_inter, <span class="at">newdata =</span> d) <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="linear-regression.html#cb41-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;interaction&quot;</span>)</span>
<span id="cb41-13"><a href="linear-regression.html#cb41-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-14"><a href="linear-regression.html#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Income, <span class="at">y =</span> .fitted, <span class="at">color =</span> Student)) <span class="sc">+</span></span>
<span id="cb41-15"><a href="linear-regression.html#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb41-16"><a href="linear-regression.html#cb41-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>model, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb41-17"><a href="linear-regression.html#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb41-18"><a href="linear-regression.html#cb41-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Balance&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/figure3.7-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>This suggests that the positive relationship between <code>Income</code> and <code>Balance</code> is smaller for students.</p>
</div>
<div id="non-linear-relationships" class="section level4 unnumbered">
<h4>Non-linear Relationships</h4>
<p>This assumption is that there is a linear relationship between response and predictors, but in some cases, the true relationship may be non-linear.
A simple way to account for non-linearity is to use polynomial regression.</p>
<p>Fit <code>mpg</code> to <code>horsepower</code> as a linear term, quadratic term, and up to the fifth degree:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="linear-regression.html#cb42-1" aria-hidden="true" tabindex="-1"></a>auto <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Auto</span>
<span id="cb42-2"><a href="linear-regression.html#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="linear-regression.html#cb42-3" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)</span>
<span id="cb42-4"><a href="linear-regression.html#cb42-4" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> horsepower <span class="sc">+</span> <span class="fu">I</span>(horsepower<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> auto)</span>
<span id="cb42-5"><a href="linear-regression.html#cb42-5" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp5 <span class="ot">&lt;-</span></span>
<span id="cb42-6"><a href="linear-regression.html#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(</span>
<span id="cb42-7"><a href="linear-regression.html#cb42-7" aria-hidden="true" tabindex="-1"></a>    mpg <span class="sc">~</span> horsepower <span class="sc">+</span> <span class="fu">I</span>(horsepower<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(horsepower<span class="sc">^</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb42-8"><a href="linear-regression.html#cb42-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">I</span>(horsepower<span class="sc">^</span><span class="dv">4</span>) <span class="sc">+</span> <span class="fu">I</span>(horsepower<span class="sc">^</span><span class="dv">5</span>),</span>
<span id="cb42-9"><a href="linear-regression.html#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> auto</span>
<span id="cb42-10"><a href="linear-regression.html#cb42-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-11"><a href="linear-regression.html#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="linear-regression.html#cb42-12" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">horsepower =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">250</span>, <span class="fl">0.1</span>))</span>
<span id="cb42-13"><a href="linear-regression.html#cb42-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-14"><a href="linear-regression.html#cb42-14" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb42-15"><a href="linear-regression.html#cb42-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm_mpg_hp, <span class="at">newdata =</span> d) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Linear&quot;</span>),</span>
<span id="cb42-16"><a href="linear-regression.html#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm_mpg_hp2, <span class="at">newdata =</span> d) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Degree 2&quot;</span>),</span>
<span id="cb42-17"><a href="linear-regression.html#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(lm_mpg_hp5, <span class="at">newdata =</span> d) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Degree 5&quot;</span>)</span>
<span id="cb42-18"><a href="linear-regression.html#cb42-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb42-19"><a href="linear-regression.html#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> horsepower, <span class="at">y =</span> .fitted, <span class="at">color =</span> model)) <span class="sc">+</span></span>
<span id="cb42-20"><a href="linear-regression.html#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb42-21"><a href="linear-regression.html#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">y =</span> mpg), <span class="at">data =</span> auto, <span class="at">color =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">size =</span> <span class="dv">3</span></span>
<span id="cb42-22"><a href="linear-regression.html#cb42-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb42-23"><a href="linear-regression.html#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb42-24"><a href="linear-regression.html#cb42-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">230</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">52</span>)) <span class="sc">+</span></span>
<span id="cb42-25"><a href="linear-regression.html#cb42-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_facet_borders</span>() <span class="sc">+</span></span>
<span id="cb42-26"><a href="linear-regression.html#cb42-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb42-27"><a href="linear-regression.html#cb42-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;mpg&quot;</span>, <span class="at">color =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/figure3.8-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>And compare model assessment statistics:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="linear-regression.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glance</span>(lm_mpg_hp) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Linear&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="linear-regression.html#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb43-3"><a href="linear-regression.html#cb43-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>(lm_mpg_hp2) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Degree 2&quot;</span>)</span>
<span id="cb43-4"><a href="linear-regression.html#cb43-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="linear-regression.html#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb43-6"><a href="linear-regression.html#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glance</span>(lm_mpg_hp5) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;Degree 5&quot;</span>)</span>
<span id="cb43-7"><a href="linear-regression.html#cb43-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="linear-regression.html#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(model, r.squared, AIC, BIC) <span class="sc">%&gt;%</span></span>
<span id="cb43-9"><a href="linear-regression.html#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>model, round, <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-10"><a href="linear-regression.html#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="tdvvxtimcr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tdvvxtimcr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tdvvxtimcr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdvvxtimcr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tdvvxtimcr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tdvvxtimcr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdvvxtimcr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tdvvxtimcr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tdvvxtimcr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tdvvxtimcr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tdvvxtimcr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tdvvxtimcr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tdvvxtimcr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#tdvvxtimcr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tdvvxtimcr .gt_from_md > :first-child {
  margin-top: 0;
}

#tdvvxtimcr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tdvvxtimcr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tdvvxtimcr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#tdvvxtimcr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdvvxtimcr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#tdvvxtimcr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tdvvxtimcr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tdvvxtimcr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tdvvxtimcr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tdvvxtimcr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdvvxtimcr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#tdvvxtimcr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tdvvxtimcr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#tdvvxtimcr .gt_left {
  text-align: left;
}

#tdvvxtimcr .gt_center {
  text-align: center;
}

#tdvvxtimcr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tdvvxtimcr .gt_font_normal {
  font-weight: normal;
}

#tdvvxtimcr .gt_font_bold {
  font-weight: bold;
}

#tdvvxtimcr .gt_font_italic {
  font-style: italic;
}

#tdvvxtimcr .gt_super {
  font-size: 65%;
}

#tdvvxtimcr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">r.squared</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">AIC</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">BIC</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Linear</td>
<td class="gt_row gt_right">0.606</td>
<td class="gt_row gt_right">2363.324</td>
<td class="gt_row gt_right">2375.237</td></tr>
    <tr><td class="gt_row gt_left">Degree 2</td>
<td class="gt_row gt_right">0.688</td>
<td class="gt_row gt_right">2274.354</td>
<td class="gt_row gt_right">2290.239</td></tr>
    <tr><td class="gt_row gt_left">Degree 5</td>
<td class="gt_row gt_right">0.697</td>
<td class="gt_row gt_right">2268.663</td>
<td class="gt_row gt_right">2296.462</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<div id="potential-problems" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Potential Problems</h3>
<div id="non-linearity-of-the-data" class="section level4 unnumbered">
<h4>1. Non-linearity of the Data</h4>
<p>If the true relationship between response and predictors is far from linear, then we can should be able to see this in residual plots.
In R, we can call the generic <code>plot()</code> function on the model objects to quickly get these plots:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="linear-regression.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_mpg_hp, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/figure3.9-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="linear-regression.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_mpg_hp2, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/figure3.9-2.png" width="384" style="display: block; margin: auto;" /></p>
<p>Ideally these residual plots will show no discernible pattern.
Above, there is a clear U-shape in the linear model indicating non-linearity in the data.
This appears to be improved by the quadratic term.</p>
</div>
<div id="correlation-of-error-terms" class="section level4 unnumbered">
<h4>2. Correlation of Error Terms</h4>
<blockquote>
<p>An important assumption of the linear regression model is that the error
terms, <span class="math inline">\(\epsilon\)</span>, are uncorrelated. What does this mean? For instance,
if the errors are uncorrelated, then the fact that <span class="math inline">\(\epsilon_i\)</span> is positive provides
little or no information about the sign of <span class="math inline">\(\epsilon_{i+1}\)</span>. The standard errors that
are computed for the estimated regression coefficients or the fitted values
are based on the assumption of uncorrelated error terms. If in fact there is
correlation among the error terms, then the estimated standard errors will
tend to underestimate the true standard errors. As a result, confidence and
prediction intervals will be narrower than they should be. For example,
a 95% confidence interval may in reality have a much lower probability
than 0.95 of containing the true value of the parameter. In addition, p-values associated with the model will be lower than they should be; this
could cause us to erroneously conclude that a parameter is statistically
significant. In short, if the error terms are correlated, we may have an
unwarranted sense of confidence in our model.</p>
</blockquote>
<p>The extreme example in the text is an accidental doubling of the data, which we can try out with the <code>advertising</code> multiple regression model:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="linear-regression.html#cb46-1" aria-hidden="true" tabindex="-1"></a>lm_sales_mult_double <span class="ot">&lt;-</span> <span class="fu">lm</span>(sales <span class="sc">~</span> TV <span class="sc">+</span> radio <span class="sc">+</span> newspaper,</span>
<span id="cb46-2"><a href="linear-regression.html#cb46-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> <span class="fu">bind_rows</span>(advertising, advertising))</span>
<span id="cb46-3"><a href="linear-regression.html#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb46-4"><a href="linear-regression.html#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">data =</span> <span class="st">&quot;original&quot;</span>, <span class="fu">tidy_custom</span>(lm_sales_mult)),</span>
<span id="cb46-5"><a href="linear-regression.html#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">data =</span> <span class="st">&quot;double&quot;</span>, <span class="fu">tidy_custom</span>(lm_sales_mult_double))</span>
<span id="cb46-6"><a href="linear-regression.html#cb46-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="linear-regression.html#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb46-8"><a href="linear-regression.html#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="qqlahmsvcr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qqlahmsvcr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qqlahmsvcr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qqlahmsvcr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qqlahmsvcr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qqlahmsvcr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qqlahmsvcr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qqlahmsvcr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qqlahmsvcr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qqlahmsvcr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qqlahmsvcr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qqlahmsvcr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qqlahmsvcr .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qqlahmsvcr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qqlahmsvcr .gt_from_md > :first-child {
  margin-top: 0;
}

#qqlahmsvcr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qqlahmsvcr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qqlahmsvcr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qqlahmsvcr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qqlahmsvcr .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qqlahmsvcr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qqlahmsvcr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qqlahmsvcr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qqlahmsvcr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qqlahmsvcr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qqlahmsvcr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qqlahmsvcr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qqlahmsvcr .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qqlahmsvcr .gt_left {
  text-align: left;
}

#qqlahmsvcr .gt_center {
  text-align: center;
}

#qqlahmsvcr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qqlahmsvcr .gt_font_normal {
  font-weight: normal;
}

#qqlahmsvcr .gt_font_bold {
  font-weight: bold;
}

#qqlahmsvcr .gt_font_italic {
  font-style: italic;
}

#qqlahmsvcr .gt_super {
  font-size: 65%;
}

#qqlahmsvcr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="5" class="gt_group_heading">original</td>
    </tr>
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.939</td>
<td class="gt_row gt_right">0.3119</td>
<td class="gt_row gt_right">9.42</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">TV</td>
<td class="gt_row gt_right">0.046</td>
<td class="gt_row gt_right">0.0014</td>
<td class="gt_row gt_right">32.81</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio</td>
<td class="gt_row gt_right">0.189</td>
<td class="gt_row gt_right">0.0086</td>
<td class="gt_row gt_right">21.89</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">newspaper</td>
<td class="gt_row gt_right">-0.001</td>
<td class="gt_row gt_right">0.0059</td>
<td class="gt_row gt_right">-0.18</td>
<td class="gt_row gt_left">0.860</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="5" class="gt_group_heading">double</td>
    </tr>
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.939</td>
<td class="gt_row gt_right">0.2194</td>
<td class="gt_row gt_right">13.39</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">TV</td>
<td class="gt_row gt_right">0.046</td>
<td class="gt_row gt_right">0.0010</td>
<td class="gt_row gt_right">46.63</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio</td>
<td class="gt_row gt_right">0.189</td>
<td class="gt_row gt_right">0.0061</td>
<td class="gt_row gt_right">31.12</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">newspaper</td>
<td class="gt_row gt_right">-0.001</td>
<td class="gt_row gt_right">0.0041</td>
<td class="gt_row gt_right">-0.25</td>
<td class="gt_row gt_left">0.802</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="non-constant-variance-of-error-terms" class="section level4 unnumbered">
<h4>3. Non-constant Variance of Error Terms</h4>
<p>Another important assumption is that the error terms have constant variance, <span class="math inline">\(\text{Var}(\epsilon_i) = \sigma^2\)</span>.
If they do not, we say there is heteroscedasticity, which we can see in the residual plot as a funnel shape.
For example:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="linear-regression.html#cb47-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb47-2"><a href="linear-regression.html#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">300</span>, <span class="at">mean =</span> <span class="dv">20</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb47-3"><a href="linear-regression.html#cb47-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="linear-regression.html#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="linear-regression.html#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb47-6"><a href="linear-regression.html#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> x <span class="sc">*</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> x <span class="sc">/</span> <span class="dv">20</span>)</span>
<span id="cb47-7"><a href="linear-regression.html#cb47-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-8"><a href="linear-regression.html#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> d), <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="outliers" class="section level4 unnumbered">
<h4>4. Outliers</h4>
<blockquote>
<p>An outlier is a point for which <span class="math inline">\(y_i\)</span> is far from the value predicted by the model. Outliers can arise for a variety of reasons, such as incorrect recording
of an observation during data collection.</p>
</blockquote>
<p>We can typically see outliers in the residuals plots:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="linear-regression.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_mpg_hp, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-22-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>In this case, point numbers 334, 323, and 330 were identified as outliers.
It is hard to say when a residual is a problem that should be addressed.
We can also plot the studentized (or standardized) residuals, which are computed by dividing each residual by its estimated standard error:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="linear-regression.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_mpg_hp, <span class="dv">5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-23-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Here we see a few outliers with standardized residuals above 2.</p>
</div>
<div id="high-leverage-points" class="section level4 unnumbered">
<h4>5. High Leverage Points</h4>
<p>Outliers are unusual response values <span class="math inline">\(y_i\)</span>, while observations with high leverage have unusual values for <span class="math inline">\(x_i\)</span>.
In the above plot, the points 117 and 94 were identified as high leverage, as well as having fairly high residuals.
These data would be worth investigating further.</p>
</div>
<div id="collinearity" class="section level4 unnumbered">
<h4>6. Collinearity</h4>
<p>Collinearity refers to the situation in which two or more predictor variables are closely related to one another.
In the <code>credit</code> data, we see collinearity between the <code>limit</code> and <code>rating</code> variables:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="linear-regression.html#cb50-1" aria-hidden="true" tabindex="-1"></a>credit <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="linear-regression.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Limit, Age, Rating) <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="linear-regression.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Age, Rating)) <span class="sc">%&gt;%</span></span>
<span id="cb50-4"><a href="linear-regression.html#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Limit, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb50-5"><a href="linear-regression.html#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-6"><a href="linear-regression.html#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/figure3.14-1.png" width="480" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The presence of collinearity can pose problems in
the regression context, since it can be difficult to separate out the individual effects of collinear variables on the response. In other words, since
<code>limit</code> and <code>rating</code> tend to increase or decrease together, it can be difficult to
determine how each one separately is associated with the response, <code>balance</code>.</p>
</blockquote>
<blockquote>
<p>Since collinearity reduces the accuracy of the estimates of the regression
coefficients, it causes the standard error for <span class="math inline">\(\hat{\beta}_j\)</span> to grow. Recall that the
<span class="math inline">\(t\)</span>-statistic for each predictor is calculated by dividing <span class="math inline">\(\hat{\beta}_j\)</span> by its standard
error. Consequently, collinearity results in a decline in the <span class="math inline">\(t\)</span>-statistic. As a
result, in the presence of collinearity, we may fail to reject <span class="math inline">\(H_0: \beta_j = 0\)</span>. This
means that the power of the hypothesis test â€“ the probability of correctly detecting a non-zero coefficient â€“ is reduced by collinearity.</p>
</blockquote>
<p>Fit the two models and summarize in a table:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="linear-regression.html#cb51-1" aria-hidden="true" tabindex="-1"></a>lm_balance_age_limit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Age <span class="sc">+</span> Limit, <span class="at">data =</span> credit)</span>
<span id="cb51-2"><a href="linear-regression.html#cb51-2" aria-hidden="true" tabindex="-1"></a>lm_balance_rating_limit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Balance <span class="sc">~</span> Rating <span class="sc">+</span> Limit, <span class="at">data =</span> credit)</span>
<span id="cb51-3"><a href="linear-regression.html#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="linear-regression.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb51-5"><a href="linear-regression.html#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">mod =</span> <span class="st">&quot;Model 1&quot;</span>, <span class="fu">tidy_custom</span>(lm_balance_age_limit)),</span>
<span id="cb51-6"><a href="linear-regression.html#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">mod =</span> <span class="st">&quot;Model 2&quot;</span>, <span class="fu">tidy_custom</span>(lm_balance_rating_limit))</span>
<span id="cb51-7"><a href="linear-regression.html#cb51-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="linear-regression.html#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(mod) <span class="sc">%&gt;%</span></span>
<span id="cb51-9"><a href="linear-regression.html#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">&quot;term&quot;</span>)</span></code></pre></div>
<div id="ilwlhztyrb" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ilwlhztyrb .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ilwlhztyrb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilwlhztyrb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ilwlhztyrb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ilwlhztyrb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilwlhztyrb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ilwlhztyrb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ilwlhztyrb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ilwlhztyrb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ilwlhztyrb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ilwlhztyrb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ilwlhztyrb .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ilwlhztyrb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ilwlhztyrb .gt_from_md > :first-child {
  margin-top: 0;
}

#ilwlhztyrb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ilwlhztyrb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ilwlhztyrb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ilwlhztyrb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilwlhztyrb .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ilwlhztyrb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ilwlhztyrb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ilwlhztyrb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ilwlhztyrb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ilwlhztyrb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilwlhztyrb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ilwlhztyrb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ilwlhztyrb .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ilwlhztyrb .gt_left {
  text-align: left;
}

#ilwlhztyrb .gt_center {
  text-align: center;
}

#ilwlhztyrb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ilwlhztyrb .gt_font_normal {
  font-weight: normal;
}

#ilwlhztyrb .gt_font_bold {
  font-weight: bold;
}

#ilwlhztyrb .gt_font_italic {
  font-style: italic;
}

#ilwlhztyrb .gt_super {
  font-size: 65%;
}

#ilwlhztyrb .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="5" class="gt_group_heading">Model 1</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">(Intercept)</td>
<td class="gt_row gt_right">-173.411</td>
<td class="gt_row gt_right">43.8284</td>
<td class="gt_row gt_right">-3.96</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">Age</td>
<td class="gt_row gt_right">-2.291</td>
<td class="gt_row gt_right">0.6725</td>
<td class="gt_row gt_right">-3.41</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">Limit</td>
<td class="gt_row gt_right">0.173</td>
<td class="gt_row gt_right">0.0050</td>
<td class="gt_row gt_right">34.50</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="5" class="gt_group_heading">Model 2</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">(Intercept)</td>
<td class="gt_row gt_right">-377.537</td>
<td class="gt_row gt_right">45.2542</td>
<td class="gt_row gt_right">-8.34</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">Rating</td>
<td class="gt_row gt_right">2.202</td>
<td class="gt_row gt_right">0.9523</td>
<td class="gt_row gt_right">2.31</td>
<td class="gt_row gt_left">0.021</td></tr>
    <tr><td class="gt_row gt_left gt_stub">Limit</td>
<td class="gt_row gt_right">0.025</td>
<td class="gt_row gt_right">0.0638</td>
<td class="gt_row gt_right">0.38</td>
<td class="gt_row gt_left">0.701</td></tr>
  </tbody>
  
  
</table>
</div>
<p>A simple way to detect collinearity is to look at the correlation matrix of predictors.
However, when there is multicollinearity (more than 2 variables correlated), we wonâ€™t see anything wrong in the pairwise correlation matrix.
A better way is to compute the variance inflation factor (VIF).
The VIF of a parameter if the ratio of <span class="math inline">\(\text{Var}(\hat{\beta}_j)\)</span> when fitting the full model divided by the variance when fit on its own.
VIF values which exceed 5 or 10 indicate a problematic amount of collinearity.
It can be computed using the formula:</p>
<p><span class="math display">\[
\text{VIF}(\hat{\beta}_j) = \frac{1}{1 - R^2_{X_j | X_-j}}
\]</span>
where <span class="math inline">\(R^2_{X_j | X_-j}\)</span> is the <span class="math inline">\(R^2\)</span> from a regression of <span class="math inline">\(X_j\)</span> onto all other predictors.</p>
<p>Compute it manually with the predictor <code>rating</code> regressed on <code>age</code> and <code>limit</code>:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="linear-regression.html#cb52-1" aria-hidden="true" tabindex="-1"></a>rating_r2 <span class="ot">&lt;-</span></span>
<span id="cb52-2"><a href="linear-regression.html#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(</span>
<span id="cb52-3"><a href="linear-regression.html#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lm</span>(Rating <span class="sc">~</span> Age <span class="sc">+</span> Limit, <span class="at">data =</span> credit)</span>
<span id="cb52-4"><a href="linear-regression.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">$</span>r.squared</span>
<span id="cb52-5"><a href="linear-regression.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> rating_r2), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 160.67</code></pre>
<p>To calculate VIFs, there are R functions such as <code>car::vif</code> which can be used, but it is fairly simple to calculate by hand:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="linear-regression.html#cb54-1" aria-hidden="true" tabindex="-1"></a>lm_rating_age_limit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Rating <span class="sc">~</span> Age <span class="sc">+</span> Limit, <span class="at">data =</span> credit)</span>
<span id="cb54-2"><a href="linear-regression.html#cb54-2" aria-hidden="true" tabindex="-1"></a>lm_age_rating_limit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age <span class="sc">~</span> Rating <span class="sc">+</span> Limit, <span class="at">data =</span> credit)</span>
<span id="cb54-3"><a href="linear-regression.html#cb54-3" aria-hidden="true" tabindex="-1"></a>lm_limit_age_rating <span class="ot">&lt;-</span> <span class="fu">lm</span>(Limit <span class="sc">~</span> Age <span class="sc">+</span> Rating, <span class="at">data =</span> credit)</span>
<span id="cb54-4"><a href="linear-regression.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb54-5"><a href="linear-regression.html#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>Predictor, <span class="sc">~</span><span class="st">`</span><span class="at">R^2</span><span class="st">`</span>,</span>
<span id="cb54-6"><a href="linear-regression.html#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Age&quot;</span>, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(lm_age_rating_limit)<span class="sc">$</span>r.squared),</span>
<span id="cb54-7"><a href="linear-regression.html#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Rating&quot;</span>, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(lm_rating_age_limit)<span class="sc">$</span>r.squared),</span>
<span id="cb54-8"><a href="linear-regression.html#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Limit&quot;</span>, <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">summary</span>(lm_limit_age_rating)<span class="sc">$</span>r.squared)</span>
<span id="cb54-9"><a href="linear-regression.html#cb54-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="linear-regression.html#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">R^2</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">R^2</span><span class="st">`</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="linear-regression.html#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="pjryitzlvm" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#pjryitzlvm .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pjryitzlvm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pjryitzlvm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pjryitzlvm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pjryitzlvm .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjryitzlvm .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pjryitzlvm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pjryitzlvm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pjryitzlvm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pjryitzlvm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pjryitzlvm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pjryitzlvm .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#pjryitzlvm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pjryitzlvm .gt_from_md > :first-child {
  margin-top: 0;
}

#pjryitzlvm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pjryitzlvm .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pjryitzlvm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#pjryitzlvm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjryitzlvm .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#pjryitzlvm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pjryitzlvm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pjryitzlvm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pjryitzlvm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pjryitzlvm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pjryitzlvm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#pjryitzlvm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pjryitzlvm .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#pjryitzlvm .gt_left {
  text-align: left;
}

#pjryitzlvm .gt_center {
  text-align: center;
}

#pjryitzlvm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pjryitzlvm .gt_font_normal {
  font-weight: normal;
}

#pjryitzlvm .gt_font_bold {
  font-weight: bold;
}

#pjryitzlvm .gt_font_italic {
  font-style: italic;
}

#pjryitzlvm .gt_super {
  font-size: 65%;
}

#pjryitzlvm .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Predictor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R^2</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">Age</td>
<td class="gt_row gt_right">1.01</td></tr>
    <tr><td class="gt_row gt_left">Rating</td>
<td class="gt_row gt_right">160.67</td></tr>
    <tr><td class="gt_row gt_left">Limit</td>
<td class="gt_row gt_right">160.59</td></tr>
  </tbody>
  
  
</table>
</div>
<p>When dealing with high collinearity, such as with <code>rating</code> and <code>limit</code> here, the first solution is to drop one of the variables from the regression.
This should be okay because the dropped variable is likely redundant.
Another solution would be to combine the collinear variables together into a single predictor, e.g.Â taking the average of standardized <code>limit</code> and <code>rating</code>.</p>
</div>
</div>
</div>
<div id="the-marketing-plan" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> The Marketing Plan</h2>
<ol style="list-style-type: decimal">
<li>Is there a relationship between sales and advertising budget:</li>
</ol>
<p>From the multiple regression <span class="math inline">\(F\)</span>-test (Table 3.6), <span class="math inline">\(F =\)</span> 570.27 (<span class="math inline">\(p\)</span> &lt;0.001).
There is clear evidence of a relationship.</p>
<ol start="2" style="list-style-type: decimal">
<li>How strong is the relationship?</li>
</ol>
<p>Calculate the RSE from the model:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="linear-regression.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually calculated RSE</span></span>
<span id="cb55-2"><a href="linear-regression.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(</span>
<span id="cb55-3"><a href="linear-regression.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">resid</span>(lm_sales_mult)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span></span>
<span id="cb55-4"><a href="linear-regression.html#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Degrees of freedom: n - p - 1</span></span>
<span id="cb55-5"><a href="linear-regression.html#cb55-5" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">nrow</span>(advertising) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb55-6"><a href="linear-regression.html#cb55-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## [1] 1.68551</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="linear-regression.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The helper functon RSE is easier</span></span>
<span id="cb57-2"><a href="linear-regression.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sigma</span>(lm_sales_mult)</span></code></pre></div>
<pre><code>## [1] 1.68551</code></pre>
<p>On the scale of the response, with a mean (SD) of 14 (5.2), the RSE indicates a percentage error of about:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="linear-regression.html#cb59-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sigma</span>(lm_sales_mult) <span class="sc">/</span> <span class="fu">mean</span>(advertising<span class="sc">$</span>sales)) <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="linear-regression.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  scales<span class="sc">::</span><span class="fu">percent</span>()</span></code></pre></div>
<pre><code>## [1] &quot;12%&quot;</code></pre>
<p>The <span class="math inline">\(R^2\)</span> value is 0.8972106, indicating approximately 90% of the variance in <code>sales</code> is explained by the three predictors.</p>
<ol start="3" style="list-style-type: decimal">
<li>Which media are associated with sales?</li>
</ol>
<p>Though a simplified view of association, we say that <code>TV</code> and <code>radio</code> are significantly associated with <code>sales</code> due to their low <span class="math inline">\(p\)</span>-values, and that <code>newspaper</code> is not.</p>
<ol start="4" style="list-style-type: decimal">
<li>How large is the association between each medium and sales?</li>
</ol>
<p>Compute 95% confidence intervals from SEs for each predictor:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="linear-regression.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_mult, <span class="at">conf.int =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="linear-regression.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb61-3"><a href="linear-regression.html#cb61-3" aria-hidden="true" tabindex="-1"></a>    term, <span class="fu">across</span>(<span class="fu">c</span>(estimate, conf.low, conf.high), round, <span class="dv">3</span>)</span>
<span id="cb61-4"><a href="linear-regression.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb61-5"><a href="linear-regression.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="vzhmihwryc" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#vzhmihwryc .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vzhmihwryc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vzhmihwryc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vzhmihwryc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vzhmihwryc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vzhmihwryc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vzhmihwryc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vzhmihwryc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vzhmihwryc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vzhmihwryc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vzhmihwryc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vzhmihwryc .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#vzhmihwryc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vzhmihwryc .gt_from_md > :first-child {
  margin-top: 0;
}

#vzhmihwryc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vzhmihwryc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vzhmihwryc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#vzhmihwryc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vzhmihwryc .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#vzhmihwryc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vzhmihwryc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vzhmihwryc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vzhmihwryc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vzhmihwryc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vzhmihwryc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#vzhmihwryc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vzhmihwryc .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#vzhmihwryc .gt_left {
  text-align: left;
}

#vzhmihwryc .gt_center {
  text-align: center;
}

#vzhmihwryc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vzhmihwryc .gt_font_normal {
  font-weight: normal;
}

#vzhmihwryc .gt_font_bold {
  font-weight: bold;
}

#vzhmihwryc .gt_font_italic {
  font-style: italic;
}

#vzhmihwryc .gt_super {
  font-size: 65%;
}

#vzhmihwryc .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.939</td>
<td class="gt_row gt_right">2.324</td>
<td class="gt_row gt_right">3.554</td></tr>
    <tr><td class="gt_row gt_left">TV</td>
<td class="gt_row gt_right">0.046</td>
<td class="gt_row gt_right">0.043</td>
<td class="gt_row gt_right">0.049</td></tr>
    <tr><td class="gt_row gt_left">radio</td>
<td class="gt_row gt_right">0.189</td>
<td class="gt_row gt_right">0.172</td>
<td class="gt_row gt_right">0.206</td></tr>
    <tr><td class="gt_row gt_left">newspaper</td>
<td class="gt_row gt_right">-0.001</td>
<td class="gt_row gt_right">-0.013</td>
<td class="gt_row gt_right">0.011</td></tr>
  </tbody>
  
  
</table>
</div>
<p><code>TV</code> and <code>radio</code> CIs are both narrow and donâ€™t include zero.
The interval for <code>newspaper</code> does include zero.
Look for collinearity:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="linear-regression.html#cb62-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(lm_sales_mult)</span></code></pre></div>
<pre><code>##        TV     radio newspaper 
##  1.004611  1.144952  1.145187</code></pre>
<p>No evidence from VIF scores.</p>
<ol start="5" style="list-style-type: decimal">
<li>How accurately can we predict future sales?</li>
</ol>
<p>We can either predict an individual response, <span class="math inline">\(Y = f(X) + \epsilon\)</span> with a prediction interval, or the average response <span class="math inline">\(f(X)\)</span> with a confidence interval.
This is done with the <code>predict.lm()</code> function and by setting the argument <code>interval</code>:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="linear-regression.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make up some new data to predict sales</span></span>
<span id="cb64-2"><a href="linear-regression.html#cb64-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">TV =</span> <span class="fl">160.0</span>, <span class="at">radio =</span> <span class="fl">15.0</span>, <span class="at">newspaper =</span> <span class="fl">72.0</span>)</span>
<span id="cb64-3"><a href="linear-regression.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(</span>
<span id="cb64-4"><a href="linear-regression.html#cb64-4" aria-hidden="true" tabindex="-1"></a>  lm_sales_mult, <span class="at">newdata =</span> d,</span>
<span id="cb64-5"><a href="linear-regression.html#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb64-6"><a href="linear-regression.html#cb64-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##        fit      lwr      upr
## 1 13.01448 9.637749 16.39122</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="linear-regression.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(</span>
<span id="cb66-2"><a href="linear-regression.html#cb66-2" aria-hidden="true" tabindex="-1"></a>  lm_sales_mult, <span class="at">newdata =</span> d,</span>
<span id="cb66-3"><a href="linear-regression.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>, <span class="at">level =</span> <span class="fl">0.95</span></span>
<span id="cb66-4"><a href="linear-regression.html#cb66-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>##        fit     lwr      upr
## 1 13.01448 12.4204 13.60857</code></pre>
<p>As expected, the former is wider than the latter due to incorporating the irreducible error.</p>
<ol start="6" style="list-style-type: decimal">
<li>Is the relationship linear?</li>
</ol>
<p>The residual plot:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="linear-regression.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm_sales_mult, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The shape of these residuals suggests a non-linear relationship.</p>
<ol start="7" style="list-style-type: decimal">
<li>Is there synergy among the advertising media?</li>
</ol>
<p>To account for the non-linearity, we included an interaction term between <code>TV</code> and <code>radio</code>.
The <span class="math inline">\(p\)</span>-value of the interaction term:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="linear-regression.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_sales_inter) <span class="sc">%&gt;%</span></span>
<span id="cb69-2"><a href="linear-regression.html#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="nrrekwjixp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#nrrekwjixp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nrrekwjixp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nrrekwjixp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nrrekwjixp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nrrekwjixp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nrrekwjixp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nrrekwjixp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nrrekwjixp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nrrekwjixp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nrrekwjixp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nrrekwjixp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nrrekwjixp .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#nrrekwjixp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nrrekwjixp .gt_from_md > :first-child {
  margin-top: 0;
}

#nrrekwjixp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nrrekwjixp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nrrekwjixp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#nrrekwjixp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nrrekwjixp .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#nrrekwjixp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nrrekwjixp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nrrekwjixp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nrrekwjixp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nrrekwjixp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nrrekwjixp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#nrrekwjixp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nrrekwjixp .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#nrrekwjixp .gt_left {
  text-align: left;
}

#nrrekwjixp .gt_center {
  text-align: center;
}

#nrrekwjixp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nrrekwjixp .gt_font_normal {
  font-weight: normal;
}

#nrrekwjixp .gt_font_bold {
  font-weight: bold;
}

#nrrekwjixp .gt_font_italic {
  font-style: italic;
}

#nrrekwjixp .gt_super {
  font-size: 65%;
}

#nrrekwjixp .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">6.750</td>
<td class="gt_row gt_right">0.2479</td>
<td class="gt_row gt_right">27.23</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio</td>
<td class="gt_row gt_right">0.029</td>
<td class="gt_row gt_right">0.0089</td>
<td class="gt_row gt_right">3.24</td>
<td class="gt_row gt_left">0.001</td></tr>
    <tr><td class="gt_row gt_left">TV</td>
<td class="gt_row gt_right">0.019</td>
<td class="gt_row gt_right">0.0015</td>
<td class="gt_row gt_right">12.70</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">radio:TV</td>
<td class="gt_row gt_right">0.001</td>
<td class="gt_row gt_right">0.0001</td>
<td class="gt_row gt_right">20.73</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p>and the increase in <span class="math inline">\(R^2\)</span>:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="linear-regression.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_sales_radio_tv)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.8971943</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="linear-regression.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_sales_inter)<span class="sc">$</span>r.squared</span></code></pre></div>
<pre><code>## [1] 0.9677905</code></pre>
<p>suggests a substantial improvement over the additive model.</p>
</div>
<div id="comparison-of-linear-regression-with-k-nearest-neighbors" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Comparison of Linear Regression with <span class="math inline">\(K\)</span>-Nearest Neighbors</h2>
<p>Parametric methods are often easy to fit, and easy to interpret, but the disadvantage is the strong assumption about the form of <span class="math inline">\(f(X)\)</span>.</p>
<p>Non-parametric methods do not explicitly assume a form for <span class="math inline">\(f(X)\)</span> and therefore provide an alternative and more flexible approach to regression.
One of the simplest and best-known methods is <span class="math inline">\(K\)</span>-nearest neighbors regression (closely related to the KNN classifier from Chapter 2).</p>
<p>From the <span class="math inline">\(K\)</span> nearest neighbors (represented by the set <span class="math inline">\(\mathcal{N}_0\)</span>) to a prediction point <span class="math inline">\(x_0\)</span>, it estimates <span class="math inline">\(f(x_0)\)</span> using the average:</p>
<p><span class="math display">\[
\hat{f}(x_0) = \frac{1}{K} \sum_{x_i \in \mathcal{N}_0} y_i.
\]</span></p>
<p>On the choice of <span class="math inline">\(K\)</span>:</p>
<blockquote>
<p>In general, the optimal value
for <span class="math inline">\(K\)</span> will depend on the bias-variance tradeoff, which we introduced in
Chapter 2. A small value for <span class="math inline">\(K\)</span> provides the most flexible fit, which will
have low bias but high variance. This variance is due to the fact that the
prediction in a given region is entirely dependent on just one observation.
In contrast, larger values of <span class="math inline">\(K\)</span> provide a smoother and less variable fit; the
prediction in a region is an average of several points, and so changing one
observation has a smaller effect. However, the smoothing may cause bias by
masking some of the structure in <span class="math inline">\(f(X)\)</span>. In Chapter 5, we introduce several
approaches for estimating test error rates. These methods can be used to
identify the optimal value of <span class="math inline">\(K\)</span> in KNN regression.</p>
</blockquote>
<blockquote>
<p>In what setting will a parametric approach such as least squares linear regression outperform a non-parametric approach such as KNN regression?
The answer is simple: the parametric approach will outperform the non-parametric approach if the parametric form that has been selected is close
to the true form of <span class="math inline">\(f\)</span>.</p>
</blockquote>
<p>There is another consideration when performing KNN with many predictors <span class="math inline">\(p\)</span>:</p>
<blockquote>
<p>However, spreading 50 observations over <span class="math inline">\(p\)</span> = 20 dimensions results in a phenomenon in which a given observation has no
nearby neighbors â€”- this is the so-called curse of dimensionality. That is, the <span class="math inline">\(K\)</span> observations that are nearest to a given test observation <span class="math inline">\(x_0\)</span> may be
very far away from <span class="math inline">\(x_0\)</span> in <span class="math inline">\(p\)</span>-dimensional space when <span class="math inline">\(p\)</span> is large, leading to a
very poor prediction of <span class="math inline">\(f(x_0)\)</span> and hence a poor KNN fit. As a general rule,
parametric methods will tend to outperform non-parametric approaches
when there is a small number of observations per predictor.</p>
</blockquote>
<p>However:</p>
<blockquote>
<p>Even when the dimension is small, we might prefer linear regression to
KNN from an interpretability standpoint. If the test MSE of KNN is only
slightly lower than that of linear regression, we might be willing to forego
a little bit of prediction accuracy for the sake of a simple model that can
be described in terms of just a few coefficients, and for which <span class="math inline">\(p\)</span>-values are
available.</p>
</blockquote>
</div>
<div id="lab-linear-regression" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Lab: Linear Regression</h2>
<div id="libraries" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Libraries</h3>
<p>Load the <code>boston</code> data rather than the full <code>ISLR2</code> package:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="linear-regression.html#cb74-1" aria-hidden="true" tabindex="-1"></a>boston <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Boston</span></code></pre></div>
</div>
<div id="simple-linear-regression-1" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Simple Linear Regression</h3>
<p>Regress median value of owner-occupied homes <code>medv</code> on percentage of houses with lower socioeconomic status <code>lstat</code>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="linear-regression.html#cb75-1" aria-hidden="true" tabindex="-1"></a>lm_medv_lstat <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat, <span class="at">data =</span> boston)</span>
<span id="cb75-2"><a href="linear-regression.html#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_medv_lstat)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat, data = boston)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -15.168  -3.990  -1.318   2.034  24.500 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.55384    0.56263   61.41   &lt;2e-16 ***
## lstat       -0.95005    0.03873  -24.53   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.216 on 504 degrees of freedom
## Multiple R-squared:  0.5441, Adjusted R-squared:  0.5432 
## F-statistic: 601.6 on 1 and 504 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Compute confidence and prediction intervals at different values of <code>lstat</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="linear-regression.html#cb77-1" aria-hidden="true" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">lstat =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>))</span>
<span id="cb77-2"><a href="linear-regression.html#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="linear-regression.html#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(</span>
<span id="cb77-4"><a href="linear-regression.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  nd,</span>
<span id="cb77-5"><a href="linear-regression.html#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="fu">predict</span>(lm_medv_lstat, nd, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span>))</span>
<span id="cb77-6"><a href="linear-regression.html#cb77-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   lstat   fit   lwr   upr
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     5  29.8  29.0  30.6
## 2    10  25.1  24.5  25.6
## 3    15  20.3  19.7  20.9</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="linear-regression.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_cols</span>(</span>
<span id="cb79-2"><a href="linear-regression.html#cb79-2" aria-hidden="true" tabindex="-1"></a>  nd,</span>
<span id="cb79-3"><a href="linear-regression.html#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="fu">predict</span>(lm_medv_lstat, nd, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>))</span>
<span id="cb79-4"><a href="linear-regression.html#cb79-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   lstat   fit   lwr   upr
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     5  29.8 17.6   42.0
## 2    10  25.1 12.8   37.3
## 3    15  20.3  8.08  32.5</code></pre>
<p>The <code>broom::augment</code> function is a more convenient method:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="linear-regression.html#cb81-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">augment</span>(</span>
<span id="cb81-2"><a href="linear-regression.html#cb81-2" aria-hidden="true" tabindex="-1"></a>  lm_medv_lstat, <span class="at">newdata =</span> nd, <span class="at">interval =</span> <span class="st">&quot;confidence&quot;</span></span>
<span id="cb81-3"><a href="linear-regression.html#cb81-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   lstat .fitted .lower .upper
##   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1     5    29.8   29.0   30.6
## 2    10    25.1   24.5   25.6
## 3    15    20.3   19.7   20.9</code></pre>
<p>Plot the relationship between <code>medv</code> and <code>lstat</code>:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="linear-regression.html#cb83-1" aria-hidden="true" tabindex="-1"></a>boston <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="linear-regression.html#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lstat, <span class="at">y =</span> medv)) <span class="sc">+</span></span>
<span id="cb83-3"><a href="linear-regression.html#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb83-4"><a href="linear-regression.html#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(lm_medv_lstat)[<span class="st">&quot;lstat&quot;</span>],</span>
<span id="cb83-5"><a href="linear-regression.html#cb83-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="fu">coef</span>(lm_medv_lstat)[<span class="st">&quot;(Intercept)&quot;</span>],</span>
<span id="cb83-6"><a href="linear-regression.html#cb83-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.0</span>, <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>day9_yellow)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>To display model diagnostics, we can call <code>plot()</code> on the model object as we have before, but I like the <code>performance</code> package because it uses <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="linear-regression.html#cb84-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(lm_medv_lstat)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="864" style="display: block; margin: auto;" /></p>
<p>The <code>stats::hatvalues()</code> function is a new one to me, for computing leverage:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="linear-regression.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hatvalues</span>(lm_medv_lstat)[<span class="fu">which.max</span>(<span class="fu">hatvalues</span>(lm_medv_lstat))]</span></code></pre></div>
<pre><code>##        375 
## 0.02686517</code></pre>
<p>Unsurprisingly, this point is the one with the largest value of <code>lstat</code>:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="linear-regression.html#cb87-1" aria-hidden="true" tabindex="-1"></a>boston <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="linear-regression.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">row =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(), lstat, medv) <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="linear-regression.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lstat <span class="sc">==</span> <span class="fu">max</span>(lstat))</span></code></pre></div>
<pre><code>##   row lstat medv
## 1 375 37.97 13.8</code></pre>
</div>
<div id="multiple-linear-regression-1" class="section level3" number="3.6.3">
<h3><span class="header-section-number">3.6.3</span> Multiple Linear Regression</h3>
<p>Fit to all predictors and check VIF with the <code>performance</code> package:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="linear-regression.html#cb89-1" aria-hidden="true" tabindex="-1"></a>lm_medv_all <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> boston)</span>
<span id="cb89-2"><a href="linear-regression.html#cb89-2" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_collinearity</span>(lm_medv_all)</span></code></pre></div>
<pre><code>## # Check for Multicollinearity
## 
## Low Correlation
## 
##     Term  VIF Increased SE Tolerance
##     crim 1.77         1.33      0.57
##       zn 2.30         1.52      0.44
##    indus 3.99         2.00      0.25
##     chas 1.07         1.03      0.93
##      nox 4.37         2.09      0.23
##       rm 1.91         1.38      0.52
##      age 3.09         1.76      0.32
##      dis 3.95         1.99      0.25
##  ptratio 1.80         1.34      0.56
##    lstat 2.87         1.69      0.35
## 
## Moderate Correlation
## 
##  Term  VIF Increased SE Tolerance
##   rad 7.45         2.73      0.13
##   tax 9.00         3.00      0.11</code></pre>
<p>The <code>rad</code> (accessibility to radial highways) and <code>tax</code> (property tax rate) variables have moderate VIF.</p>
</div>
<div id="interaction-terms" class="section level3" number="3.6.4">
<h3><span class="header-section-number">3.6.4</span> Interaction Terms</h3>
<p>Interaction between <code>lstat</code> and <code>age</code>:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="linear-regression.html#cb91-1" aria-hidden="true" tabindex="-1"></a>lm_medv_lstat_age <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">*</span> age, <span class="at">data =</span> boston)</span>
<span id="cb91-2"><a href="linear-regression.html#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_medv_lstat_age) <span class="sc">%&gt;%</span></span>
<span id="cb91-3"><a href="linear-regression.html#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="qyadpzvdjs" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#qyadpzvdjs .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qyadpzvdjs .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qyadpzvdjs .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qyadpzvdjs .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qyadpzvdjs .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qyadpzvdjs .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qyadpzvdjs .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qyadpzvdjs .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qyadpzvdjs .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qyadpzvdjs .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qyadpzvdjs .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qyadpzvdjs .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#qyadpzvdjs .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qyadpzvdjs .gt_from_md > :first-child {
  margin-top: 0;
}

#qyadpzvdjs .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qyadpzvdjs .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qyadpzvdjs .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#qyadpzvdjs .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qyadpzvdjs .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#qyadpzvdjs .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qyadpzvdjs .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qyadpzvdjs .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qyadpzvdjs .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qyadpzvdjs .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qyadpzvdjs .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#qyadpzvdjs .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qyadpzvdjs .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#qyadpzvdjs .gt_left {
  text-align: left;
}

#qyadpzvdjs .gt_center {
  text-align: center;
}

#qyadpzvdjs .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qyadpzvdjs .gt_font_normal {
  font-weight: normal;
}

#qyadpzvdjs .gt_font_bold {
  font-weight: bold;
}

#qyadpzvdjs .gt_font_italic {
  font-style: italic;
}

#qyadpzvdjs .gt_super {
  font-size: 65%;
}

#qyadpzvdjs .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">36.089</td>
<td class="gt_row gt_right">1.4698</td>
<td class="gt_row gt_right">24.55</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">lstat</td>
<td class="gt_row gt_right">-1.392</td>
<td class="gt_row gt_right">0.1675</td>
<td class="gt_row gt_right">-8.31</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">age</td>
<td class="gt_row gt_right">-0.001</td>
<td class="gt_row gt_right">0.0199</td>
<td class="gt_row gt_right">-0.04</td>
<td class="gt_row gt_left">0.971</td></tr>
    <tr><td class="gt_row gt_left">lstat:age</td>
<td class="gt_row gt_right">0.004</td>
<td class="gt_row gt_right">0.0019</td>
<td class="gt_row gt_right">2.24</td>
<td class="gt_row gt_left">0.025</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="non-linear-transformations-of-the-predictors" class="section level3" number="3.6.5">
<h3><span class="header-section-number">3.6.5</span> Non-linear Transformations of the Predictors</h3>
<p>Perform a regression of <code>medv</code> onto <code>lstat</code> and <code>lstat^2</code>, and compare fits with <code>anova</code>:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="linear-regression.html#cb92-1" aria-hidden="true" tabindex="-1"></a>lm_medv_lstat2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> lstat <span class="sc">+</span> <span class="fu">I</span>(lstat<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> boston)</span>
<span id="cb92-2"><a href="linear-regression.html#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="linear-regression.html#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_medv_lstat, lm_medv_lstat2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: medv ~ lstat
## Model 2: medv ~ lstat + I(lstat^2)
##   Res.Df   RSS Df Sum of Sq     F    Pr(&gt;F)    
## 1    504 19472                                 
## 2    503 15347  1    4125.1 135.2 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The quadratic model is superior by the <span class="math inline">\(F\)</span>-test.
Check the residuals:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="linear-regression.html#cb94-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(lm_medv_lstat2, <span class="at">check =</span> <span class="st">&quot;linearity&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-46-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>The quadratic term is an obvious improvement, but still some non-linearity at large values of <code>medv</code>.</p>
<p>The <code>poly()</code> function is a quick way to include higher order terms:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="linear-regression.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Orthogonalized predictors by default</span></span>
<span id="cb95-2"><a href="linear-regression.html#cb95-2" aria-hidden="true" tabindex="-1"></a>lm_medv_lstat5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">5</span>), <span class="at">data =</span> boston)</span>
<span id="cb95-3"><a href="linear-regression.html#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_medv_lstat5)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   term            coefficient std.error `t-statistic` `p-value`
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    
## 1 (Intercept)            22.5     0.232         97.2  &lt;0.001   
## 2 poly(lstat, 5)1      -152.      5.21         -29.2  &lt;0.001   
## 3 poly(lstat, 5)2        64.2     5.21          12.3  &lt;0.001   
## 4 poly(lstat, 5)3       -27.1     5.21          -5.19 &lt;0.001   
## 5 poly(lstat, 5)4        25.5     5.21           4.88 &lt;0.001   
## 6 poly(lstat, 5)5       -19.3     5.21          -3.69 &lt;0.001</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="linear-regression.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raw polynomials</span></span>
<span id="cb97-2"><a href="linear-regression.html#cb97-2" aria-hidden="true" tabindex="-1"></a>lm_medv_lstat5_raw <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="fu">poly</span>(lstat, <span class="dv">5</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>), <span class="at">data =</span> boston)</span>
<span id="cb97-3"><a href="linear-regression.html#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_medv_lstat5_raw)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   term                        coefficient std.error `t-statistic` `p-value`
##   &lt;chr&gt;                             &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    
## 1 (Intercept)                      67.7      3.60           18.8  &lt;0.001   
## 2 poly(lstat, 5, raw = TRUE)1     -12.0      1.53           -7.86 &lt;0.001   
## 3 poly(lstat, 5, raw = TRUE)2       1.27     0.223           5.7  &lt;0.001   
## 4 poly(lstat, 5, raw = TRUE)3      -0.068    0.0144         -4.75 &lt;0.001   
## 5 poly(lstat, 5, raw = TRUE)4       0.002    0.0004          4.14 &lt;0.001   
## 6 poly(lstat, 5, raw = TRUE)5       0        0              -3.69 &lt;0.001</code></pre>
</div>
<div id="qualitative-predictors-1" class="section level3" number="3.6.6">
<h3><span class="header-section-number">3.6.6</span> Qualitative Predictors</h3>
<p>Load <code>carseats</code>:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="linear-regression.html#cb99-1" aria-hidden="true" tabindex="-1"></a>carseats <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Carseats</span></code></pre></div>
<p>The <code>contrasts()</code> function shows the dummy coding for the qualitative <code>ShelveLoc</code> variable:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="linear-regression.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(carseats<span class="sc">$</span>ShelveLoc)</span></code></pre></div>
<pre><code>##        Good Medium
## Bad       0      0
## Good      1      0
## Medium    0      1</code></pre>
<p>Fit the model and print the coefficients related to <code>ShelveLoc</code>:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="linear-regression.html#cb102-1" aria-hidden="true" tabindex="-1"></a>lm_sales <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sales <span class="sc">~</span> . <span class="sc">+</span> Income<span class="sc">:</span>Advertising <span class="sc">+</span> Price<span class="sc">:</span>Age,</span>
<span id="cb102-2"><a href="linear-regression.html#cb102-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> carseats)</span>
<span id="cb102-3"><a href="linear-regression.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_sales) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="linear-regression.html#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;ShelveLoc|Intercept&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   term            coefficient std.error `t-statistic` `p-value`
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt; &lt;chr&gt;    
## 1 (Intercept)            6.58     1.01           6.52 &lt;0.001   
## 2 ShelveLocGood          4.85     0.153         31.7  &lt;0.001   
## 3 ShelveLocMedium        1.95     0.126         15.5  &lt;0.001</code></pre>
</div>
</div>
<div id="exercises" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Exercises</h2>
<div id="applied" class="section level3 unnumbered">
<h3>Applied</h3>
<p>Iâ€™ll attempt to do these exercises in the <code>tidymodels</code> framework.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="linear-regression.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span></code></pre></div>
<div id="simple-linear-regression-with-auto" class="section level4 unnumbered">
<h4>8. Simple linear regression with <code>Auto</code></h4>
<p>This is way overkill for a simple linear regression, but here is a <code>tidymodels</code> workflow object for regressing <code>mpg</code> on <code>horsepower</code>:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="linear-regression.html#cb105-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(mpg <span class="sc">~</span> horsepower, <span class="at">data =</span> auto)</span>
<span id="cb105-2"><a href="linear-regression.html#cb105-2" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="linear-regression.html#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;regression&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-4"><a href="linear-regression.html#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;lm&quot;</span>)</span>
<span id="cb105-5"><a href="linear-regression.html#cb105-5" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-6"><a href="linear-regression.html#cb105-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lm_mpg_hp_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb105-7"><a href="linear-regression.html#cb105-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(lm_mpg_hp_spec)</span>
<span id="cb105-8"><a href="linear-regression.html#cb105-8" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_workflow</span></code></pre></div>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: linear_reg()
## 
## -- Preprocessor ----------------------------------------------------------------
## 0 Recipe Steps
## 
## -- Model -----------------------------------------------------------------------
## Linear Regression Model Specification (regression)
## 
## Computational engine: lm</code></pre>
<p>Fit the model and print the estimates:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="linear-regression.html#cb107-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_fit <span class="ot">&lt;-</span> lm_mpg_hp_workflow <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="linear-regression.html#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> auto)</span>
<span id="cb107-3"><a href="linear-regression.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_mpg_hp_fit) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="linear-regression.html#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ieutnewgsj" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ieutnewgsj .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ieutnewgsj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ieutnewgsj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ieutnewgsj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ieutnewgsj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ieutnewgsj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ieutnewgsj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ieutnewgsj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ieutnewgsj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ieutnewgsj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ieutnewgsj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ieutnewgsj .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ieutnewgsj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ieutnewgsj .gt_from_md > :first-child {
  margin-top: 0;
}

#ieutnewgsj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ieutnewgsj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ieutnewgsj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ieutnewgsj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ieutnewgsj .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ieutnewgsj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ieutnewgsj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ieutnewgsj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ieutnewgsj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ieutnewgsj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ieutnewgsj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ieutnewgsj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ieutnewgsj .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ieutnewgsj .gt_left {
  text-align: left;
}

#ieutnewgsj .gt_center {
  text-align: center;
}

#ieutnewgsj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ieutnewgsj .gt_font_normal {
  font-weight: normal;
}

#ieutnewgsj .gt_font_bold {
  font-weight: bold;
}

#ieutnewgsj .gt_font_italic {
  font-style: italic;
}

#ieutnewgsj .gt_super {
  font-size: 65%;
}

#ieutnewgsj .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">39.936</td>
<td class="gt_row gt_right">0.7175</td>
<td class="gt_row gt_right">55.66</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">horsepower</td>
<td class="gt_row gt_right">-0.158</td>
<td class="gt_row gt_right">0.0064</td>
<td class="gt_row gt_right">-24.49</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The <code>tidymodels</code> framework uses the same functions as we have seen (the â€œengineâ€ specifies the <code>lm</code> function), but in principled fashion with a standardized interface.
We can extract the actual <code>lm</code> object from <code>lm_mpg_hp_fit</code> using <code>extract_fit_engine()</code></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="linear-regression.html#cb108-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_fit_engine <span class="ot">&lt;-</span> lm_mpg_hp_fit <span class="sc">%&gt;%</span></span>
<span id="cb108-2"><a href="linear-regression.html#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>()</span>
<span id="cb108-3"><a href="linear-regression.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_mpg_hp_fit_engine)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -13.5710  -3.2592  -0.3435   2.7630  16.9240 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 39.935861   0.717499   55.66   &lt;2e-16 ***
## horsepower  -0.157845   0.006446  -24.49   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.906 on 390 degrees of freedom
## Multiple R-squared:  0.6059, Adjusted R-squared:  0.6049 
## F-statistic: 599.7 on 1 and 390 DF,  p-value: &lt; 2.2e-16</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Observations on the model:</li>
</ol>
<ul>
<li>There is a relationship between <code>mpg</code> and <code>horsepower</code>.</li>
<li>Is is highly significant (<span class="math inline">\(p\)</span> &lt;0.001) with <span class="math inline">\(R^2\)</span> = 0.61</li>
<li>The relationship is negative. Every unit of horsepower is associated with a -0.16 reduction in miles per gallon.</li>
<li>The confidence and prediction intervals of predicted <code>mpg</code> given <code>horsepower</code> = 98:</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="linear-regression.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm_mpg_hp_fit, <span class="fu">tibble</span>(<span class="at">horsepower =</span> <span class="dv">98</span>), <span class="at">type =</span> <span class="st">&quot;conf_int&quot;</span>,</span>
<span id="cb110-2"><a href="linear-regression.html#cb110-2" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Don&#39;t have to call this, because it is the default value</span></span>
<span id="cb110-3"><a href="linear-regression.html#cb110-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   .pred_lower .pred_upper
##         &lt;dbl&gt;       &lt;dbl&gt;
## 1        24.0        25.0</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="linear-regression.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(lm_mpg_hp_fit, <span class="fu">tibble</span>(<span class="at">horsepower =</span> <span class="dv">98</span>), <span class="at">type =</span> <span class="st">&quot;pred_int&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   .pred_lower .pred_upper
##         &lt;dbl&gt;       &lt;dbl&gt;
## 1        14.8        34.1</code></pre>
<p>Note that the <code>lm_mpg_hp_fit</code> is a <code>workflow</code> object, and so the <code>parsnip::predict.model_fit()</code> function takes a different argument (<code>type</code>) to specify confidence/prediction intervals.
Before, we were calling <code>predict.lm()</code> which uses the <code>interval</code> argument.
Note that it also doesnâ€™t return the point estimate, just the lower and upper values.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Plot with best fit line:</li>
</ol>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="linear-regression.html#cb114-1" aria-hidden="true" tabindex="-1"></a>auto <span class="sc">%&gt;%</span></span>
<span id="cb114-2"><a href="linear-regression.html#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> horsepower)) <span class="sc">+</span></span>
<span id="cb114-3"><a href="linear-regression.html#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> mpg), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb114-4"><a href="linear-regression.html#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="fu">coef</span>(lm_mpg_hp_fit_engine)[<span class="st">&quot;horsepower&quot;</span>],</span>
<span id="cb114-5"><a href="linear-regression.html#cb114-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">intercept =</span> <span class="fu">coef</span>(lm_mpg_hp_fit_engine)[<span class="st">&quot;(Intercept)&quot;</span>],</span>
<span id="cb114-6"><a href="linear-regression.html#cb114-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> td_colors<span class="sc">$</span>nice<span class="sc">$</span>emerald)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-56-1.png" width="576" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Diagnostic plots:</li>
</ol>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="linear-regression.html#cb115-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_hp_fit_engine <span class="sc">%&gt;%</span></span>
<span id="cb115-2"><a href="linear-regression.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Two potential problems: non-linearity (top left plot) and homogeneity of variance (top right).</p>
</div>
<div id="multiple-linear-regression-with-auto" class="section level4 unnumbered">
<h4>9. Multiple linear regression with <code>Auto</code></h4>
<ol style="list-style-type: lower-alpha">
<li>Scatterplot of all variables.</li>
</ol>
<p>For quickly producing these correlation matrices, I like the <code>GGally::ggpairs()</code> function:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="linear-regression.html#cb116-1" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(auto <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>name))</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" style="display: block; margin: auto;" /></p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Compute the correlations.</li>
</ol>
<p>The above plot shows the correlation coefficients, but here is the <code>cor()</code> output:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="linear-regression.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(auto <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>name))</span></code></pre></div>
<pre><code>##                     mpg  cylinders displacement horsepower     weight
## mpg           1.0000000 -0.7776175   -0.8051269 -0.7784268 -0.8322442
## cylinders    -0.7776175  1.0000000    0.9508233  0.8429834  0.8975273
## displacement -0.8051269  0.9508233    1.0000000  0.8972570  0.9329944
## horsepower   -0.7784268  0.8429834    0.8972570  1.0000000  0.8645377
## weight       -0.8322442  0.8975273    0.9329944  0.8645377  1.0000000
## acceleration  0.4233285 -0.5046834   -0.5438005 -0.6891955 -0.4168392
## year          0.5805410 -0.3456474   -0.3698552 -0.4163615 -0.3091199
## origin        0.5652088 -0.5689316   -0.6145351 -0.4551715 -0.5850054
##              acceleration       year     origin
## mpg             0.4233285  0.5805410  0.5652088
## cylinders      -0.5046834 -0.3456474 -0.5689316
## displacement   -0.5438005 -0.3698552 -0.6145351
## horsepower     -0.6891955 -0.4163615 -0.4551715
## weight         -0.4168392 -0.3091199 -0.5850054
## acceleration    1.0000000  0.2903161  0.2127458
## year            0.2903161  1.0000000  0.1815277
## origin          0.2127458  0.1815277  1.0000000</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Fit the multiple linear regression.</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="linear-regression.html#cb120-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(mpg <span class="sc">~</span> ., <span class="at">data =</span> auto) <span class="sc">%&gt;%</span></span>
<span id="cb120-2"><a href="linear-regression.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_rm</span>(name)</span>
<span id="cb120-3"><a href="linear-regression.html#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="linear-regression.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Skip the spec step, and just put it directly into the workflow</span></span>
<span id="cb120-5"><a href="linear-regression.html#cb120-5" aria-hidden="true" tabindex="-1"></a>lm_mpg_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb120-6"><a href="linear-regression.html#cb120-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(lm_mpg_recipe) <span class="sc">%&gt;%</span></span>
<span id="cb120-7"><a href="linear-regression.html#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># By default, linear_reg() will use lm as the engine and regression as mode</span></span>
<span id="cb120-8"><a href="linear-regression.html#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(<span class="fu">linear_reg</span>())</span>
<span id="cb120-9"><a href="linear-regression.html#cb120-9" aria-hidden="true" tabindex="-1"></a>lm_mpg_workflow</span></code></pre></div>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: linear_reg()
## 
## -- Preprocessor ----------------------------------------------------------------
## 1 Recipe Step
## 
## * step_rm()
## 
## -- Model -----------------------------------------------------------------------
## Linear Regression Model Specification (regression)
## 
## Computational engine: lm</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="linear-regression.html#cb122-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_fit <span class="ot">&lt;-</span> lm_mpg_workflow <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="linear-regression.html#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> auto)</span>
<span id="cb122-3"><a href="linear-regression.html#cb122-3" aria-hidden="true" tabindex="-1"></a>lm_mpg_fit_engine <span class="ot">&lt;-</span> <span class="fu">extract_fit_engine</span>(lm_mpg_fit)</span>
<span id="cb122-4"><a href="linear-regression.html#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_mpg_fit_engine)</span></code></pre></div>
<pre><code>## 
## Call:
## stats::lm(formula = ..y ~ ., data = data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5903 -2.1565 -0.1169  1.8690 13.0604 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  -17.218435   4.644294  -3.707  0.00024 ***
## cylinders     -0.493376   0.323282  -1.526  0.12780    
## displacement   0.019896   0.007515   2.647  0.00844 ** 
## horsepower    -0.016951   0.013787  -1.230  0.21963    
## weight        -0.006474   0.000652  -9.929  &lt; 2e-16 ***
## acceleration   0.080576   0.098845   0.815  0.41548    
## year           0.750773   0.050973  14.729  &lt; 2e-16 ***
## origin         1.426141   0.278136   5.127 4.67e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.328 on 384 degrees of freedom
## Multiple R-squared:  0.8215, Adjusted R-squared:  0.8182 
## F-statistic: 252.4 on 7 and 384 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li>There is a relationship between the predictors and <code>mpg</code>: <span class="math inline">\(F\)</span> = 252.4</li>
<li>The following terms are statistically significant: (Intercept), displacement, weight, year, origin</li>
<li>The coefficient for <code>year</code> suggests that, for every increment in car model year, <code>mpg</code> increases by 0.75</li>
</ul>
<ol start="4" style="list-style-type: lower-alpha">
<li>Diagnostic plots.</li>
</ol>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="linear-regression.html#cb124-1" aria-hidden="true" tabindex="-1"></a>lm_mpg_fit <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="linear-regression.html#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb124-3"><a href="linear-regression.html#cb124-3" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Some non-linearity and moderate collinearity.
There is a point with high leverage, but it has a fairly small standardized residual.</p>
</div>
<div id="multiple-linear-regression-with-carseats" class="section level4 unnumbered">
<h4>10. Multiple linear regression with <code>Carseats</code></h4>
<ol style="list-style-type: lower-alpha">
<li>Fit a model to predict <code>Sales</code> using <code>Price</code>, <code>Urban</code>, and <code>US</code>.</li>
</ol>
<p>For demonstration, here Iâ€™ll use the minimal code possible while still using <code>tidymodels</code> (i.e.Â skip <code>recipe</code> and <code>workflow</code> steps):</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="linear-regression.html#cb125-1" aria-hidden="true" tabindex="-1"></a>lm_sales_price_urban_us_fit <span class="ot">&lt;-</span></span>
<span id="cb125-2"><a href="linear-regression.html#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> <span class="co"># default engine = &quot;lm&quot;</span></span>
<span id="cb125-3"><a href="linear-regression.html#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Sales <span class="sc">~</span> Price <span class="sc">+</span> Urban <span class="sc">+</span> US, <span class="at">data =</span> carseats)</span>
<span id="cb125-4"><a href="linear-regression.html#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="linear-regression.html#cb125-5" aria-hidden="true" tabindex="-1"></a>fit_tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(lm_sales_price_urban_us_fit)</span>
<span id="cb125-6"><a href="linear-regression.html#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_sales_price_urban_us_fit) <span class="sc">%&gt;%</span></span>
<span id="cb125-7"><a href="linear-regression.html#cb125-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="anofkmyvtu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#anofkmyvtu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#anofkmyvtu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#anofkmyvtu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#anofkmyvtu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#anofkmyvtu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anofkmyvtu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#anofkmyvtu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#anofkmyvtu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#anofkmyvtu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#anofkmyvtu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#anofkmyvtu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#anofkmyvtu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#anofkmyvtu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#anofkmyvtu .gt_from_md > :first-child {
  margin-top: 0;
}

#anofkmyvtu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#anofkmyvtu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#anofkmyvtu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#anofkmyvtu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#anofkmyvtu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#anofkmyvtu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#anofkmyvtu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#anofkmyvtu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#anofkmyvtu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#anofkmyvtu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#anofkmyvtu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#anofkmyvtu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#anofkmyvtu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#anofkmyvtu .gt_left {
  text-align: left;
}

#anofkmyvtu .gt_center {
  text-align: center;
}

#anofkmyvtu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#anofkmyvtu .gt_font_normal {
  font-weight: normal;
}

#anofkmyvtu .gt_font_bold {
  font-weight: bold;
}

#anofkmyvtu .gt_font_italic {
  font-style: italic;
}

#anofkmyvtu .gt_super {
  font-size: 65%;
}

#anofkmyvtu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">13.043</td>
<td class="gt_row gt_right">0.6510</td>
<td class="gt_row gt_right">20.04</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">Price</td>
<td class="gt_row gt_right">-0.054</td>
<td class="gt_row gt_right">0.0052</td>
<td class="gt_row gt_right">-10.39</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">UrbanYes</td>
<td class="gt_row gt_right">-0.022</td>
<td class="gt_row gt_right">0.2717</td>
<td class="gt_row gt_right">-0.08</td>
<td class="gt_row gt_left">0.936</td></tr>
    <tr><td class="gt_row gt_left">USYes</td>
<td class="gt_row gt_right">1.201</td>
<td class="gt_row gt_right">0.2590</td>
<td class="gt_row gt_right">4.63</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Provide an interpretation of each coefficient.</li>
</ol>
<ul>
<li>There is a significant negative relationship between <code>Sales</code> and <code>Price</code>:
<ul>
<li>A difference of -0.054 thousand unit sales per dollar of price</li>
</ul></li>
<li>There is no significant association between <code>Urban</code> and <code>Sales</code>:
<ul>
<li>Urban stores sell -0.022 thousand units compared to non-urban</li>
</ul></li>
<li>There is a significant difference between US and non-US stores.
<ul>
<li>US stores sell 1.2 thousand more units on average compared to non-US</li>
</ul></li>
</ul>
<ol start="3" style="list-style-type: lower-alpha">
<li>Write out the model formula.</li>
</ol>
<p>There is a nice package called <code>equatiomatic</code> for writing out model formulae:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="linear-regression.html#cb126-1" aria-hidden="true" tabindex="-1"></a>lm_sales_price_urban_us_fit <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="linear-regression.html#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-3"><a href="linear-regression.html#cb126-3" aria-hidden="true" tabindex="-1"></a>  equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>()</span></code></pre></div>
<p><span class="math display">\[
\operatorname{Sales} = \alpha + \beta_{1}(\operatorname{Price}) + \beta_{2}(\operatorname{Urban}_{\operatorname{Yes}}) + \beta_{3}(\operatorname{US}_{\operatorname{Yes}}) + \epsilon
\]</span></p>
<p>Note that it uses <span class="math inline">\(\alpha\)</span>, rather than <span class="math inline">\(\beta_0\)</span>, to represent intercepts by default.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>For which predictions can you reject the null hypothesis <span class="math inline">\(H_0: \beta_j = 0\)</span>?</li>
</ol>
<p>For <span class="math inline">\(\beta_1\)</span> (<code>Price</code>) and <span class="math inline">\(\beta_3\)</span> (<code>US</code>).</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Fit a smaller model with just the predictors in (d).</li>
</ol>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="linear-regression.html#cb127-1" aria-hidden="true" tabindex="-1"></a>lm_sales_price_us_fit <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="linear-regression.html#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(Sales <span class="sc">~</span> Price <span class="sc">+</span> US, <span class="at">data =</span> carseats)</span>
<span id="cb127-3"><a href="linear-regression.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_sales_price_us_fit) <span class="sc">%&gt;%</span></span>
<span id="cb127-4"><a href="linear-regression.html#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="rmiuhntxqy" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#rmiuhntxqy .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rmiuhntxqy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmiuhntxqy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rmiuhntxqy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rmiuhntxqy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmiuhntxqy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rmiuhntxqy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rmiuhntxqy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rmiuhntxqy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rmiuhntxqy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rmiuhntxqy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rmiuhntxqy .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#rmiuhntxqy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rmiuhntxqy .gt_from_md > :first-child {
  margin-top: 0;
}

#rmiuhntxqy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rmiuhntxqy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rmiuhntxqy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#rmiuhntxqy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmiuhntxqy .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#rmiuhntxqy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rmiuhntxqy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rmiuhntxqy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rmiuhntxqy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rmiuhntxqy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmiuhntxqy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#rmiuhntxqy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rmiuhntxqy .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#rmiuhntxqy .gt_left {
  text-align: left;
}

#rmiuhntxqy .gt_center {
  text-align: center;
}

#rmiuhntxqy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rmiuhntxqy .gt_font_normal {
  font-weight: normal;
}

#rmiuhntxqy .gt_font_bold {
  font-weight: bold;
}

#rmiuhntxqy .gt_font_italic {
  font-style: italic;
}

#rmiuhntxqy .gt_super {
  font-size: 65%;
}

#rmiuhntxqy .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">13.031</td>
<td class="gt_row gt_right">0.6310</td>
<td class="gt_row gt_right">20.65</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">Price</td>
<td class="gt_row gt_right">-0.054</td>
<td class="gt_row gt_right">0.0052</td>
<td class="gt_row gt_right">-10.42</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">USYes</td>
<td class="gt_row gt_right">1.200</td>
<td class="gt_row gt_right">0.2585</td>
<td class="gt_row gt_right">4.64</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<ol start="6" style="list-style-type: lower-alpha">
<li>How well do the model fits the data?</li>
</ol>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="linear-regression.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb128-2"><a href="linear-regression.html#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">model =</span> <span class="st">&quot;small&quot;</span>, <span class="fu">glance</span>(lm_sales_price_us_fit)),</span>
<span id="cb128-3"><a href="linear-regression.html#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">model =</span> <span class="st">&quot;full&quot;</span>, <span class="fu">glance</span>(lm_sales_price_urban_us_fit))</span>
<span id="cb128-4"><a href="linear-regression.html#cb128-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb128-5"><a href="linear-regression.html#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb128-6"><a href="linear-regression.html#cb128-6" aria-hidden="true" tabindex="-1"></a>    model, <span class="at">R2 =</span> <span class="fu">round</span>(r.squared, <span class="dv">3</span>), <span class="at">RSE =</span> <span class="fu">round</span>(sigma, <span class="dv">3</span>)</span>
<span id="cb128-7"><a href="linear-regression.html#cb128-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb128-8"><a href="linear-regression.html#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="jntwjwlsoh" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#jntwjwlsoh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jntwjwlsoh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jntwjwlsoh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jntwjwlsoh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jntwjwlsoh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jntwjwlsoh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jntwjwlsoh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jntwjwlsoh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jntwjwlsoh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jntwjwlsoh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jntwjwlsoh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jntwjwlsoh .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#jntwjwlsoh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jntwjwlsoh .gt_from_md > :first-child {
  margin-top: 0;
}

#jntwjwlsoh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jntwjwlsoh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jntwjwlsoh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#jntwjwlsoh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jntwjwlsoh .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#jntwjwlsoh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jntwjwlsoh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jntwjwlsoh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jntwjwlsoh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jntwjwlsoh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jntwjwlsoh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#jntwjwlsoh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jntwjwlsoh .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#jntwjwlsoh .gt_left {
  text-align: left;
}

#jntwjwlsoh .gt_center {
  text-align: center;
}

#jntwjwlsoh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jntwjwlsoh .gt_font_normal {
  font-weight: normal;
}

#jntwjwlsoh .gt_font_bold {
  font-weight: bold;
}

#jntwjwlsoh .gt_font_italic {
  font-style: italic;
}

#jntwjwlsoh .gt_super {
  font-size: 65%;
}

#jntwjwlsoh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">model</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">R2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">RSE</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">small</td>
<td class="gt_row gt_right">0.239</td>
<td class="gt_row gt_right">2.469</td></tr>
    <tr><td class="gt_row gt_left">full</td>
<td class="gt_row gt_right">0.239</td>
<td class="gt_row gt_right">2.472</td></tr>
  </tbody>
  
  
</table>
</div>
<p>Excluding <code>Urban</code> makes no difference to <span class="math inline">\(R^2\)</span>.
Run an <span class="math inline">\(F\)</span>-test as well:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="linear-regression.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(</span>
<span id="cb129-2"><a href="linear-regression.html#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>(lm_sales_price_urban_us_fit),</span>
<span id="cb129-3"><a href="linear-regression.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_fit_engine</span>(lm_sales_price_us_fit)</span>
<span id="cb129-4"><a href="linear-regression.html#cb129-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Sales ~ Price + Urban + US
## Model 2: Sales ~ Price + US
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1    396 2420.8                           
## 2    397 2420.9 -1  -0.03979 0.0065 0.9357</code></pre>
<ol start="7" style="list-style-type: lower-alpha">
<li>Obtain 95% confidence intervals for the coefficients from (e).</li>
</ol>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="linear-regression.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(lm_sales_price_us_fit, <span class="at">conf.int =</span> <span class="fl">0.95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="linear-regression.html#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb131-3"><a href="linear-regression.html#cb131-3" aria-hidden="true" tabindex="-1"></a>    term, <span class="fu">across</span>(<span class="fu">c</span>(estimate, conf.low, conf.high), round, <span class="dv">3</span>)</span>
<span id="cb131-4"><a href="linear-regression.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb131-5"><a href="linear-regression.html#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ovzowvfvfx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ovzowvfvfx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ovzowvfvfx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ovzowvfvfx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ovzowvfvfx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ovzowvfvfx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovzowvfvfx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ovzowvfvfx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ovzowvfvfx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ovzowvfvfx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ovzowvfvfx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ovzowvfvfx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ovzowvfvfx .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ovzowvfvfx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ovzowvfvfx .gt_from_md > :first-child {
  margin-top: 0;
}

#ovzowvfvfx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ovzowvfvfx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ovzowvfvfx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ovzowvfvfx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovzowvfvfx .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ovzowvfvfx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ovzowvfvfx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ovzowvfvfx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ovzowvfvfx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ovzowvfvfx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ovzowvfvfx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ovzowvfvfx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ovzowvfvfx .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ovzowvfvfx .gt_left {
  text-align: left;
}

#ovzowvfvfx .gt_center {
  text-align: center;
}

#ovzowvfvfx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ovzowvfvfx .gt_font_normal {
  font-weight: normal;
}

#ovzowvfvfx .gt_font_bold {
  font-weight: bold;
}

#ovzowvfvfx .gt_font_italic {
  font-style: italic;
}

#ovzowvfvfx .gt_super {
  font-size: 65%;
}

#ovzowvfvfx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">13.031</td>
<td class="gt_row gt_right">11.790</td>
<td class="gt_row gt_right">14.271</td></tr>
    <tr><td class="gt_row gt_left">Price</td>
<td class="gt_row gt_right">-0.054</td>
<td class="gt_row gt_right">-0.065</td>
<td class="gt_row gt_right">-0.044</td></tr>
    <tr><td class="gt_row gt_left">USYes</td>
<td class="gt_row gt_right">1.200</td>
<td class="gt_row gt_right">0.692</td>
<td class="gt_row gt_right">1.708</td></tr>
  </tbody>
  
  
</table>
</div>
<ol start="8" style="list-style-type: lower-alpha">
<li>Is there evidence of outliers or high leverage observations in the model from (e)?</li>
</ol>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="linear-regression.html#cb132-1" aria-hidden="true" tabindex="-1"></a>lm_sales_price_us_fit <span class="sc">%&gt;%</span></span>
<span id="cb132-2"><a href="linear-regression.html#cb132-2" aria-hidden="true" tabindex="-1"></a>  performance<span class="sc">::</span><span class="fu">check_model</span>(<span class="at">check =</span> <span class="st">&quot;outliers&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-68-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>No evidence of outliers or high leverage points.</p>
</div>
<div id="simple-linear-regression-to-simulated-data" class="section level4 unnumbered">
<h4>13. Simple linear regression to simulated data</h4>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="linear-regression.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li>Generate 100 observations from <span class="math inline">\(N(0,1)\)</span>.</li>
</ol>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="linear-regression.html#cb134-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Generate 100 observations from <span class="math inline">\(N(0, 0.25)\)</span>.</li>
</ol>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="linear-regression.html#cb135-1" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.25</span>)</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Generate <span class="math inline">\(Y = -1 + 0.5 X + \epsilon\)</span></li>
</ol>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="linear-regression.html#cb136-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> eps</span>
<span id="cb136-2"><a href="linear-regression.html#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y)</span></code></pre></div>
<pre><code>## [1] 100</code></pre>
<p><span class="math inline">\(\beta_0\)</span> = -1, and <span class="math inline">\(\beta_1\)</span> = 0.5.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Scatterplot between <code>x</code> and <code>y</code>.</li>
</ol>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="linear-regression.html#cb138-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(x, y)</span>
<span id="cb138-2"><a href="linear-regression.html#cb138-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb138-3"><a href="linear-regression.html#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y))</span>
<span id="cb138-4"><a href="linear-regression.html#cb138-4" aria-hidden="true" tabindex="-1"></a>p  </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="288" style="display: block; margin: auto;" /></p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Fit the simple linear regression and compare estimates to simulation parameters.</li>
</ol>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="linear-regression.html#cb139-1" aria-hidden="true" tabindex="-1"></a>lm_y_x <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> d)</span>
<span id="cb139-2"><a href="linear-regression.html#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_y_x) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="maszwdpqyg" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#maszwdpqyg .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#maszwdpqyg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#maszwdpqyg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#maszwdpqyg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#maszwdpqyg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#maszwdpqyg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#maszwdpqyg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#maszwdpqyg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#maszwdpqyg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#maszwdpqyg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#maszwdpqyg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#maszwdpqyg .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#maszwdpqyg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#maszwdpqyg .gt_from_md > :first-child {
  margin-top: 0;
}

#maszwdpqyg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#maszwdpqyg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#maszwdpqyg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#maszwdpqyg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#maszwdpqyg .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#maszwdpqyg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#maszwdpqyg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#maszwdpqyg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#maszwdpqyg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#maszwdpqyg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#maszwdpqyg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#maszwdpqyg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#maszwdpqyg .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#maszwdpqyg .gt_left {
  text-align: left;
}

#maszwdpqyg .gt_center {
  text-align: center;
}

#maszwdpqyg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#maszwdpqyg .gt_font_normal {
  font-weight: normal;
}

#maszwdpqyg .gt_font_bold {
  font-weight: bold;
}

#maszwdpqyg .gt_font_italic {
  font-style: italic;
}

#maszwdpqyg .gt_super {
  font-size: 65%;
}

#maszwdpqyg .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">-1.009</td>
<td class="gt_row gt_right">0.0242</td>
<td class="gt_row gt_right">-41.63</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">x</td>
<td class="gt_row gt_right">0.500</td>
<td class="gt_row gt_right">0.0269</td>
<td class="gt_row gt_right">18.56</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p><span class="math inline">\(\hat{\beta_0}\)</span> and <span class="math inline">\(\hat{\beta_1}\)</span> are very close (essentially equal) to the simulation values.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Plot the least squares and population regression lines.</li>
</ol>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="linear-regression.html#cb140-1" aria-hidden="true" tabindex="-1"></a>d_lines <span class="ot">&lt;-</span></span>
<span id="cb140-2"><a href="linear-regression.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tribble</span>(</span>
<span id="cb140-3"><a href="linear-regression.html#cb140-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>line, <span class="sc">~</span>slope, <span class="sc">~</span>intercept,</span>
<span id="cb140-4"><a href="linear-regression.html#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Population&quot;</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb140-5"><a href="linear-regression.html#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Least squares&quot;</span>, <span class="fu">coef</span>(lm_y_x)[<span class="dv">2</span>], <span class="fu">coef</span>(lm_y_x)[<span class="dv">1</span>]</span>
<span id="cb140-6"><a href="linear-regression.html#cb140-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb140-7"><a href="linear-regression.html#cb140-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb140-8"><a href="linear-regression.html#cb140-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb140-9"><a href="linear-regression.html#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d_lines,</span>
<span id="cb140-10"><a href="linear-regression.html#cb140-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> intercept, <span class="at">color =</span> line),</span>
<span id="cb140-11"><a href="linear-regression.html#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb140-12"><a href="linear-regression.html#cb140-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb140-13"><a href="linear-regression.html#cb140-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb140-14"><a href="linear-regression.html#cb140-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="288" style="display: block; margin: auto;" /></p>
<p>Exactly on top of each other.</p>
<ol start="7" style="list-style-type: lower-alpha">
<li>Fit a polynomial regression using <span class="math inline">\(x^2\)</span>.</li>
</ol>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="linear-regression.html#cb141-1" aria-hidden="true" tabindex="-1"></a>lm_y_x2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> d)</span>
<span id="cb141-2"><a href="linear-regression.html#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_y_x, lm_y_x2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: y ~ x
## Model 2: y ~ x + I(x^2)
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     98 5.6772                           
## 2     97 5.5643  1   0.11291 1.9682 0.1638</code></pre>
<p>By an <span class="math inline">\(F\)</span>-test, the <span class="math inline">\(x^2\)</span> term did not improve the model fit.
We can also look at <span class="math inline">\(R^2\)</span>:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="linear-regression.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">summary</span>(lm_y_x)<span class="sc">$</span>r.squared, <span class="fu">summary</span>(lm_y_x2)<span class="sc">$</span>r.squared)</span></code></pre></div>
<pre><code>## [1] 0.7784361 0.7828424</code></pre>
<ol start="8" style="list-style-type: lower-alpha">
<li>Repeat with less noise.</li>
</ol>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="linear-regression.html#cb145-1" aria-hidden="true" tabindex="-1"></a>d_less <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb145-2"><a href="linear-regression.html#cb145-2" aria-hidden="true" tabindex="-1"></a>  x, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb145-3"><a href="linear-regression.html#cb145-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb145-4"><a href="linear-regression.html#cb145-4" aria-hidden="true" tabindex="-1"></a>lm_y_x_less <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> d_less)</span>
<span id="cb145-5"><a href="linear-regression.html#cb145-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_less) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y))</span>
<span id="cb145-6"><a href="linear-regression.html#cb145-6" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="linear-regression.html#cb146-1" aria-hidden="true" tabindex="-1"></a>d_lines <span class="ot">&lt;-</span></span>
<span id="cb146-2"><a href="linear-regression.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tribble</span>(</span>
<span id="cb146-3"><a href="linear-regression.html#cb146-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>line, <span class="sc">~</span>slope, <span class="sc">~</span>intercept,</span>
<span id="cb146-4"><a href="linear-regression.html#cb146-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Population&quot;</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb146-5"><a href="linear-regression.html#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Least squares&quot;</span>, <span class="fu">coef</span>(lm_y_x_less)[<span class="dv">2</span>], <span class="fu">coef</span>(lm_y_x_less)[<span class="dv">1</span>]</span>
<span id="cb146-6"><a href="linear-regression.html#cb146-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb146-7"><a href="linear-regression.html#cb146-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb146-8"><a href="linear-regression.html#cb146-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb146-9"><a href="linear-regression.html#cb146-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d_lines,</span>
<span id="cb146-10"><a href="linear-regression.html#cb146-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> intercept, <span class="at">color =</span> line),</span>
<span id="cb146-11"><a href="linear-regression.html#cb146-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb146-12"><a href="linear-regression.html#cb146-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb146-13"><a href="linear-regression.html#cb146-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb146-14"><a href="linear-regression.html#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-2.png" width="288" style="display: block; margin: auto;" /></p>
<ol style="list-style-type: lower-roman">
<li>Repeat with more noise.</li>
</ol>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="linear-regression.html#cb147-1" aria-hidden="true" tabindex="-1"></a>d_more <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb147-2"><a href="linear-regression.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  x, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.5</span><span class="sc">*</span>x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb147-3"><a href="linear-regression.html#cb147-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-4"><a href="linear-regression.html#cb147-4" aria-hidden="true" tabindex="-1"></a>lm_y_x_more <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> d_more)</span>
<span id="cb147-5"><a href="linear-regression.html#cb147-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d_more) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y))</span>
<span id="cb147-6"><a href="linear-regression.html#cb147-6" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-1.png" width="288" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="linear-regression.html#cb148-1" aria-hidden="true" tabindex="-1"></a>d_lines <span class="ot">&lt;-</span></span>
<span id="cb148-2"><a href="linear-regression.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tribble</span>(</span>
<span id="cb148-3"><a href="linear-regression.html#cb148-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span>line, <span class="sc">~</span>slope, <span class="sc">~</span>intercept,</span>
<span id="cb148-4"><a href="linear-regression.html#cb148-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Population&quot;</span>, <span class="fl">0.5</span>, <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb148-5"><a href="linear-regression.html#cb148-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Least squares&quot;</span>, <span class="fu">coef</span>(lm_y_x_more)[<span class="dv">2</span>], <span class="fu">coef</span>(lm_y_x_more)[<span class="dv">1</span>]</span>
<span id="cb148-6"><a href="linear-regression.html#cb148-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb148-7"><a href="linear-regression.html#cb148-7" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb148-8"><a href="linear-regression.html#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb148-9"><a href="linear-regression.html#cb148-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> d_lines,</span>
<span id="cb148-10"><a href="linear-regression.html#cb148-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">slope =</span> slope, <span class="at">intercept =</span> intercept, <span class="at">color =</span> line),</span>
<span id="cb148-11"><a href="linear-regression.html#cb148-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span></span>
<span id="cb148-12"><a href="linear-regression.html#cb148-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb148-13"><a href="linear-regression.html#cb148-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb148-14"><a href="linear-regression.html#cb148-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-79-2.png" width="288" style="display: block; margin: auto;" /></p>
<ol start="6" style="list-style-type: lower-alpha">
<li>What are the confidence intervals of the coefficients for the different data?</li>
</ol>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="linear-regression.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(</span>
<span id="cb149-2"><a href="linear-regression.html#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">data =</span> <span class="st">&quot;original&quot;</span>, <span class="fu">tidy</span>(lm_y_x, <span class="at">conf.int =</span> <span class="fl">0.95</span>)),</span>
<span id="cb149-3"><a href="linear-regression.html#cb149-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">data =</span> <span class="st">&quot;less&quot;</span>, <span class="fu">tidy</span>(lm_y_x_less, <span class="at">conf.int =</span> <span class="fl">0.95</span>)),</span>
<span id="cb149-4"><a href="linear-regression.html#cb149-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="at">data =</span> <span class="st">&quot;more&quot;</span>, <span class="fu">tidy</span>(lm_y_x_more, <span class="at">conf.int =</span> <span class="fl">0.95</span>))</span>
<span id="cb149-5"><a href="linear-regression.html#cb149-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb149-6"><a href="linear-regression.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb149-7"><a href="linear-regression.html#cb149-7" aria-hidden="true" tabindex="-1"></a>    data, term,</span>
<span id="cb149-8"><a href="linear-regression.html#cb149-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(estimate, conf.low, conf.high), round, <span class="dv">3</span>)</span>
<span id="cb149-9"><a href="linear-regression.html#cb149-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb149-10"><a href="linear-regression.html#cb149-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(data) <span class="sc">%&gt;%</span></span>
<span id="cb149-11"><a href="linear-regression.html#cb149-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">&quot;term&quot;</span>)</span></code></pre></div>
<div id="aabxdtuftx" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#aabxdtuftx .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#aabxdtuftx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aabxdtuftx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#aabxdtuftx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#aabxdtuftx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aabxdtuftx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#aabxdtuftx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#aabxdtuftx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#aabxdtuftx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#aabxdtuftx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#aabxdtuftx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#aabxdtuftx .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#aabxdtuftx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#aabxdtuftx .gt_from_md > :first-child {
  margin-top: 0;
}

#aabxdtuftx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#aabxdtuftx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#aabxdtuftx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#aabxdtuftx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aabxdtuftx .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#aabxdtuftx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#aabxdtuftx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#aabxdtuftx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#aabxdtuftx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#aabxdtuftx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aabxdtuftx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#aabxdtuftx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#aabxdtuftx .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#aabxdtuftx .gt_left {
  text-align: left;
}

#aabxdtuftx .gt_center {
  text-align: center;
}

#aabxdtuftx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#aabxdtuftx .gt_font_normal {
  font-weight: normal;
}

#aabxdtuftx .gt_font_bold {
  font-weight: bold;
}

#aabxdtuftx .gt_font_italic {
  font-style: italic;
}

#aabxdtuftx .gt_super {
  font-size: 65%;
}

#aabxdtuftx .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.low</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">conf.high</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">original</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">(Intercept)</td>
<td class="gt_row gt_right">-1.009</td>
<td class="gt_row gt_right">-1.058</td>
<td class="gt_row gt_right">-0.961</td></tr>
    <tr><td class="gt_row gt_left gt_stub">x</td>
<td class="gt_row gt_right">0.500</td>
<td class="gt_row gt_right">0.446</td>
<td class="gt_row gt_right">0.553</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">less</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">(Intercept)</td>
<td class="gt_row gt_right">-0.991</td>
<td class="gt_row gt_right">-1.012</td>
<td class="gt_row gt_right">-0.970</td></tr>
    <tr><td class="gt_row gt_left gt_stub">x</td>
<td class="gt_row gt_right">0.483</td>
<td class="gt_row gt_right">0.459</td>
<td class="gt_row gt_right">0.506</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">more</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">(Intercept)</td>
<td class="gt_row gt_right">-1.023</td>
<td class="gt_row gt_right">-1.118</td>
<td class="gt_row gt_right">-0.927</td></tr>
    <tr><td class="gt_row gt_left gt_stub">x</td>
<td class="gt_row gt_right">0.549</td>
<td class="gt_row gt_right">0.443</td>
<td class="gt_row gt_right">0.656</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="collineratiy-simulation" class="section level4 unnumbered">
<h4>14. Collineratiy simulation</h4>
<ol style="list-style-type: lower-alpha">
<li>Simulate.</li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="linear-regression.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb150-2"><a href="linear-regression.html#cb150-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb150-3"><a href="linear-regression.html#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">runif</span>(<span class="dv">100</span>), <span class="at">x2 =</span> <span class="fl">0.5</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>) <span class="sc">/</span> <span class="dv">10</span>,</span>
<span id="cb150-4"><a href="linear-regression.html#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fl">0.3</span> <span class="sc">*</span> x2 <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb150-5"><a href="linear-regression.html#cb150-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><span class="math display">\[
Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon
\]</span></p>
<p><span class="math inline">\(\beta_0\)</span> = 2, <span class="math inline">\(\beta_1\)</span> = 2, and <span class="math inline">\(\beta_2\)</span> = 0.3.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Correlation between <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</li>
</ol>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="linear-regression.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(d)</span></code></pre></div>
<pre><code>##           x1        x2         y
## x1 1.0000000 0.8351212 0.4498446
## x2 0.8351212 1.0000000 0.4199171
## y  0.4498446 0.4199171 1.0000000</code></pre>
<p>Unsurprisingly very high, <span class="math inline">\(r\)</span> = 0.835.</p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Fit the regression model.</li>
</ol>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="linear-regression.html#cb153-1" aria-hidden="true" tabindex="-1"></a>lm_y_x1_x2 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb153-2"><a href="linear-regression.html#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> d)</span>
<span id="cb153-3"><a href="linear-regression.html#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_y_x1_x2) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="swqeswtyiu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#swqeswtyiu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#swqeswtyiu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swqeswtyiu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#swqeswtyiu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#swqeswtyiu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swqeswtyiu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#swqeswtyiu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#swqeswtyiu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#swqeswtyiu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#swqeswtyiu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#swqeswtyiu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#swqeswtyiu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#swqeswtyiu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#swqeswtyiu .gt_from_md > :first-child {
  margin-top: 0;
}

#swqeswtyiu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#swqeswtyiu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#swqeswtyiu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#swqeswtyiu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swqeswtyiu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#swqeswtyiu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#swqeswtyiu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#swqeswtyiu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#swqeswtyiu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#swqeswtyiu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swqeswtyiu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#swqeswtyiu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#swqeswtyiu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#swqeswtyiu .gt_left {
  text-align: left;
}

#swqeswtyiu .gt_center {
  text-align: center;
}

#swqeswtyiu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#swqeswtyiu .gt_font_normal {
  font-weight: normal;
}

#swqeswtyiu .gt_font_bold {
  font-weight: bold;
}

#swqeswtyiu .gt_font_italic {
  font-style: italic;
}

#swqeswtyiu .gt_super {
  font-size: 65%;
}

#swqeswtyiu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.13</td>
<td class="gt_row gt_right">0.2319</td>
<td class="gt_row gt_right">9.19</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">x1</td>
<td class="gt_row gt_right">1.44</td>
<td class="gt_row gt_right">0.7212</td>
<td class="gt_row gt_right">2.00</td>
<td class="gt_row gt_left">0.049</td></tr>
    <tr><td class="gt_row gt_left">x2</td>
<td class="gt_row gt_right">1.01</td>
<td class="gt_row gt_right">1.1337</td>
<td class="gt_row gt_right">0.89</td>
<td class="gt_row gt_left">0.375</td></tr>
  </tbody>
  
  
</table>
</div>
<p>We can reject the null that <span class="math inline">\(\beta_2 = 0\)</span>, but not for <span class="math inline">\(\beta_1\)</span>.
The estimates are nowhere close to the true values.</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Fit the model of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_1\)</span>.</li>
</ol>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="linear-regression.html#cb154-1" aria-hidden="true" tabindex="-1"></a>lm_y_x1 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb154-2"><a href="linear-regression.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> d)</span>
<span id="cb154-3"><a href="linear-regression.html#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_y_x1) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="uosexngzmz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#uosexngzmz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#uosexngzmz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uosexngzmz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#uosexngzmz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#uosexngzmz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uosexngzmz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#uosexngzmz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#uosexngzmz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#uosexngzmz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#uosexngzmz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#uosexngzmz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#uosexngzmz .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#uosexngzmz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#uosexngzmz .gt_from_md > :first-child {
  margin-top: 0;
}

#uosexngzmz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#uosexngzmz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#uosexngzmz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#uosexngzmz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uosexngzmz .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#uosexngzmz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#uosexngzmz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#uosexngzmz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#uosexngzmz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#uosexngzmz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uosexngzmz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#uosexngzmz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#uosexngzmz .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#uosexngzmz .gt_left {
  text-align: left;
}

#uosexngzmz .gt_center {
  text-align: center;
}

#uosexngzmz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#uosexngzmz .gt_font_normal {
  font-weight: normal;
}

#uosexngzmz .gt_font_bold {
  font-weight: bold;
}

#uosexngzmz .gt_font_italic {
  font-style: italic;
}

#uosexngzmz .gt_super {
  font-size: 65%;
}

#uosexngzmz .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.112</td>
<td class="gt_row gt_right">0.2307</td>
<td class="gt_row gt_right">9.15</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">x1</td>
<td class="gt_row gt_right">1.976</td>
<td class="gt_row gt_right">0.3963</td>
<td class="gt_row gt_right">4.99</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p>We recover the approximate true parameter, and reject the null.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Fit the model of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X_2\)</span>.</li>
</ol>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="linear-regression.html#cb155-1" aria-hidden="true" tabindex="-1"></a>lm_y_x2 <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="linear-regression.html#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(y <span class="sc">~</span> x2, <span class="at">data =</span> d)</span>
<span id="cb155-3"><a href="linear-regression.html#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_y_x2) <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span></code></pre></div>
<div id="orfbuaqmum" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#orfbuaqmum .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#orfbuaqmum .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#orfbuaqmum .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#orfbuaqmum .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#orfbuaqmum .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#orfbuaqmum .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#orfbuaqmum .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#orfbuaqmum .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#orfbuaqmum .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#orfbuaqmum .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#orfbuaqmum .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#orfbuaqmum .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#orfbuaqmum .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#orfbuaqmum .gt_from_md > :first-child {
  margin-top: 0;
}

#orfbuaqmum .gt_from_md > :last-child {
  margin-bottom: 0;
}

#orfbuaqmum .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#orfbuaqmum .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#orfbuaqmum .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#orfbuaqmum .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#orfbuaqmum .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#orfbuaqmum .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#orfbuaqmum .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#orfbuaqmum .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#orfbuaqmum .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#orfbuaqmum .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#orfbuaqmum .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#orfbuaqmum .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#orfbuaqmum .gt_left {
  text-align: left;
}

#orfbuaqmum .gt_center {
  text-align: center;
}

#orfbuaqmum .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#orfbuaqmum .gt_font_normal {
  font-weight: normal;
}

#orfbuaqmum .gt_font_bold {
  font-weight: bold;
}

#orfbuaqmum .gt_font_italic {
  font-style: italic;
}

#orfbuaqmum .gt_super {
  font-size: 65%;
}

#orfbuaqmum .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">2.39</td>
<td class="gt_row gt_right">0.1949</td>
<td class="gt_row gt_right">12.26</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">x2</td>
<td class="gt_row gt_right">2.90</td>
<td class="gt_row gt_right">0.6330</td>
<td class="gt_row gt_right">4.58</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p>We can reject the null, but donâ€™t recover <span class="math inline">\(\beta_2 = 0.3\)</span>.</p>
<ol start="6" style="list-style-type: lower-alpha">
<li>Do the results contradict each other?</li>
</ol>
<p>Yes, the models give much different results.</p>
</div>
<div id="univariable-and-multivariable-regression-on-boston" class="section level4 unnumbered">
<h4>15. Univariable and multivariable regression on <code>Boston</code></h4>
<ol style="list-style-type: lower-alpha">
<li>Fit univariable models.</li>
</ol>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="linear-regression.html#cb156-1" aria-hidden="true" tabindex="-1"></a>lm_crim_uni <span class="ot">&lt;-</span></span>
<span id="cb156-2"><a href="linear-regression.html#cb156-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb156-3"><a href="linear-regression.html#cb156-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get a list of predictors</span></span>
<span id="cb156-4"><a href="linear-regression.html#cb156-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictor =</span> <span class="fu">names</span>(boston)[<span class="fu">names</span>(boston) <span class="sc">!=</span> <span class="st">&quot;crim&quot;</span>]</span>
<span id="cb156-5"><a href="linear-regression.html#cb156-5" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb156-6"><a href="linear-regression.html#cb156-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb156-7"><a href="linear-regression.html#cb156-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod =</span> <span class="fu">map</span>(</span>
<span id="cb156-8"><a href="linear-regression.html#cb156-8" aria-hidden="true" tabindex="-1"></a>      predictor,</span>
<span id="cb156-9"><a href="linear-regression.html#cb156-9" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">lm</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">&quot;crim ~ &quot;</span>, .x)), <span class="at">data =</span> boston)</span>
<span id="cb156-10"><a href="linear-regression.html#cb156-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb156-11"><a href="linear-regression.html#cb156-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_tidy =</span> <span class="fu">map</span>(mod, broom<span class="sc">::</span>tidy)</span>
<span id="cb156-12"><a href="linear-regression.html#cb156-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>These associations were statistical significant at <span class="math inline">\(\alpha = 0.05\)</span>:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="linear-regression.html#cb157-1" aria-hidden="true" tabindex="-1"></a>lm_crim_uni <span class="sc">%&gt;%</span></span>
<span id="cb157-2"><a href="linear-regression.html#cb157-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(mod_tidy) <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="linear-regression.html#cb157-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>, p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-4"><a href="linear-regression.html#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb157-5"><a href="linear-regression.html#cb157-5" aria-hidden="true" tabindex="-1"></a>    predictor, <span class="at">estimate =</span> <span class="fu">signif</span>(estimate, <span class="dv">4</span>),</span>
<span id="cb157-6"><a href="linear-regression.html#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value)</span>
<span id="cb157-7"><a href="linear-regression.html#cb157-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb157-8"><a href="linear-regression.html#cb157-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="zhbiyhxytn" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#zhbiyhxytn .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#zhbiyhxytn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zhbiyhxytn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#zhbiyhxytn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#zhbiyhxytn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zhbiyhxytn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#zhbiyhxytn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#zhbiyhxytn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#zhbiyhxytn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#zhbiyhxytn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#zhbiyhxytn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#zhbiyhxytn .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#zhbiyhxytn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#zhbiyhxytn .gt_from_md > :first-child {
  margin-top: 0;
}

#zhbiyhxytn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#zhbiyhxytn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#zhbiyhxytn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#zhbiyhxytn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zhbiyhxytn .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#zhbiyhxytn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#zhbiyhxytn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#zhbiyhxytn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#zhbiyhxytn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#zhbiyhxytn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zhbiyhxytn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#zhbiyhxytn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#zhbiyhxytn .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#zhbiyhxytn .gt_left {
  text-align: left;
}

#zhbiyhxytn .gt_center {
  text-align: center;
}

#zhbiyhxytn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#zhbiyhxytn .gt_font_normal {
  font-weight: normal;
}

#zhbiyhxytn .gt_font_bold {
  font-weight: bold;
}

#zhbiyhxytn .gt_font_italic {
  font-style: italic;
}

#zhbiyhxytn .gt_super {
  font-size: 65%;
}

#zhbiyhxytn .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">predictor</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">zn</td>
<td class="gt_row gt_right">-0.07393</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">indus</td>
<td class="gt_row gt_right">0.50980</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">nox</td>
<td class="gt_row gt_right">31.25000</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">rm</td>
<td class="gt_row gt_right">-2.68400</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">age</td>
<td class="gt_row gt_right">0.10780</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">dis</td>
<td class="gt_row gt_right">-1.55100</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">rad</td>
<td class="gt_row gt_right">0.61790</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">tax</td>
<td class="gt_row gt_right">0.02974</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">ptratio</td>
<td class="gt_row gt_right">1.15200</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">lstat</td>
<td class="gt_row gt_right">0.54880</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">medv</td>
<td class="gt_row gt_right">-0.36320</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Fit the multiple regression.</li>
</ol>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="linear-regression.html#cb158-1" aria-hidden="true" tabindex="-1"></a>lm_crim_mult <span class="ot">&lt;-</span> <span class="fu">lm</span>(crim <span class="sc">~</span> ., <span class="at">data =</span> boston)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="linear-regression.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy_custom</span>(lm_crim_mult) <span class="sc">%&gt;%</span></span>
<span id="cb159-2"><a href="linear-regression.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div>
<div id="ztejltwxob" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#ztejltwxob .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ztejltwxob .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztejltwxob .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ztejltwxob .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ztejltwxob .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztejltwxob .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ztejltwxob .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ztejltwxob .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ztejltwxob .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ztejltwxob .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ztejltwxob .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ztejltwxob .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#ztejltwxob .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ztejltwxob .gt_from_md > :first-child {
  margin-top: 0;
}

#ztejltwxob .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ztejltwxob .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ztejltwxob .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#ztejltwxob .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztejltwxob .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#ztejltwxob .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ztejltwxob .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ztejltwxob .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ztejltwxob .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ztejltwxob .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztejltwxob .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#ztejltwxob .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ztejltwxob .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#ztejltwxob .gt_left {
  text-align: left;
}

#ztejltwxob .gt_center {
  text-align: center;
}

#ztejltwxob .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ztejltwxob .gt_font_normal {
  font-weight: normal;
}

#ztejltwxob .gt_font_bold {
  font-weight: bold;
}

#ztejltwxob .gt_font_italic {
  font-style: italic;
}

#ztejltwxob .gt_super {
  font-size: 65%;
}

#ztejltwxob .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">term</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">t-statistic</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p-value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_left">(Intercept)</td>
<td class="gt_row gt_right">13.778</td>
<td class="gt_row gt_right">7.0818</td>
<td class="gt_row gt_right">1.95</td>
<td class="gt_row gt_left">0.052</td></tr>
    <tr><td class="gt_row gt_left">zn</td>
<td class="gt_row gt_right">0.046</td>
<td class="gt_row gt_right">0.0188</td>
<td class="gt_row gt_right">2.43</td>
<td class="gt_row gt_left">0.015</td></tr>
    <tr><td class="gt_row gt_left">indus</td>
<td class="gt_row gt_right">-0.058</td>
<td class="gt_row gt_right">0.0836</td>
<td class="gt_row gt_right">-0.70</td>
<td class="gt_row gt_left">0.486</td></tr>
    <tr><td class="gt_row gt_left">chas</td>
<td class="gt_row gt_right">-0.825</td>
<td class="gt_row gt_right">1.1834</td>
<td class="gt_row gt_right">-0.70</td>
<td class="gt_row gt_left">0.486</td></tr>
    <tr><td class="gt_row gt_left">nox</td>
<td class="gt_row gt_right">-9.958</td>
<td class="gt_row gt_right">5.2898</td>
<td class="gt_row gt_right">-1.88</td>
<td class="gt_row gt_left">0.060</td></tr>
    <tr><td class="gt_row gt_left">rm</td>
<td class="gt_row gt_right">0.629</td>
<td class="gt_row gt_right">0.6071</td>
<td class="gt_row gt_right">1.04</td>
<td class="gt_row gt_left">0.301</td></tr>
    <tr><td class="gt_row gt_left">age</td>
<td class="gt_row gt_right">-0.001</td>
<td class="gt_row gt_right">0.0179</td>
<td class="gt_row gt_right">-0.05</td>
<td class="gt_row gt_left">0.962</td></tr>
    <tr><td class="gt_row gt_left">dis</td>
<td class="gt_row gt_right">-1.012</td>
<td class="gt_row gt_right">0.2825</td>
<td class="gt_row gt_right">-3.58</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">rad</td>
<td class="gt_row gt_right">0.612</td>
<td class="gt_row gt_right">0.0875</td>
<td class="gt_row gt_right">7.00</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left">tax</td>
<td class="gt_row gt_right">-0.004</td>
<td class="gt_row gt_right">0.0052</td>
<td class="gt_row gt_right">-0.73</td>
<td class="gt_row gt_left">0.466</td></tr>
    <tr><td class="gt_row gt_left">ptratio</td>
<td class="gt_row gt_right">-0.304</td>
<td class="gt_row gt_right">0.1864</td>
<td class="gt_row gt_right">-1.63</td>
<td class="gt_row gt_left">0.103</td></tr>
    <tr><td class="gt_row gt_left">lstat</td>
<td class="gt_row gt_right">0.139</td>
<td class="gt_row gt_right">0.0757</td>
<td class="gt_row gt_right">1.83</td>
<td class="gt_row gt_left">0.067</td></tr>
    <tr><td class="gt_row gt_left">medv</td>
<td class="gt_row gt_right">-0.220</td>
<td class="gt_row gt_right">0.0598</td>
<td class="gt_row gt_right">-3.68</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
<p>We reject the null for these predictors: <code>zn, dis, rad, medv</code></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>Compare regression estimates.</li>
</ol>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="linear-regression.html#cb160-1" aria-hidden="true" tabindex="-1"></a>lm_crim_estimates <span class="ot">&lt;-</span></span>
<span id="cb160-2"><a href="linear-regression.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  lm_crim_uni <span class="sc">%&gt;%</span></span>
<span id="cb160-3"><a href="linear-regression.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(mod_tidy) <span class="sc">%&gt;%</span></span>
<span id="cb160-4"><a href="linear-regression.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-5"><a href="linear-regression.html#cb160-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb160-6"><a href="linear-regression.html#cb160-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">model =</span> <span class="st">&quot;univariable&quot;</span>, term, estimate</span>
<span id="cb160-7"><a href="linear-regression.html#cb160-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb160-8"><a href="linear-regression.html#cb160-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb160-9"><a href="linear-regression.html#cb160-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tidy</span>(lm_crim_mult) <span class="sc">%&gt;%</span></span>
<span id="cb160-10"><a href="linear-regression.html#cb160-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(term <span class="sc">!=</span> <span class="st">&quot;(Intercept)&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-11"><a href="linear-regression.html#cb160-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">transmute</span>(</span>
<span id="cb160-12"><a href="linear-regression.html#cb160-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> <span class="st">&quot;multivariable&quot;</span>, term, estimate</span>
<span id="cb160-13"><a href="linear-regression.html#cb160-13" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb160-14"><a href="linear-regression.html#cb160-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb160-15"><a href="linear-regression.html#cb160-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> model, <span class="at">values_from =</span> estimate)</span>
<span id="cb160-16"><a href="linear-regression.html#cb160-16" aria-hidden="true" tabindex="-1"></a>lm_crim_estimates <span class="sc">%&gt;%</span></span>
<span id="cb160-17"><a href="linear-regression.html#cb160-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> univariable, <span class="at">y =</span> multivariable)) <span class="sc">+</span></span>
<span id="cb160-18"><a href="linear-regression.html#cb160-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb160-19"><a href="linear-regression.html#cb160-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-90-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>One really bad outlier:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="linear-regression.html#cb161-1" aria-hidden="true" tabindex="-1"></a>lm_crim_estimates <span class="sc">%&gt;%</span> <span class="fu">filter</span>(univariable <span class="sc">&gt;</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   term  univariable multivariable
##   &lt;chr&gt;       &lt;dbl&gt;         &lt;dbl&gt;
## 1 nox          31.2         -9.96</code></pre>
<p>Exclude that term and label the points:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="linear-regression.html#cb163-1" aria-hidden="true" tabindex="-1"></a>lm_crim_estimates <span class="sc">%&gt;%</span></span>
<span id="cb163-2"><a href="linear-regression.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(univariable <span class="sc">&lt;</span> <span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb163-3"><a href="linear-regression.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> univariable, <span class="at">y =</span> multivariable)) <span class="sc">+</span></span>
<span id="cb163-4"><a href="linear-regression.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb163-5"><a href="linear-regression.html#cb163-5" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> term)) <span class="sc">+</span></span>
<span id="cb163-6"><a href="linear-regression.html#cb163-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="480" style="display: block; margin: auto;" /></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Is there evidence of non-linear association for any predictors?</li>
</ol>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="linear-regression.html#cb164-1" aria-hidden="true" tabindex="-1"></a>lm_crim_uni_poly <span class="ot">&lt;-</span></span>
<span id="cb164-2"><a href="linear-regression.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb164-3"><a href="linear-regression.html#cb164-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictor =</span> <span class="fu">names</span>(boston)[<span class="fu">names</span>(boston) <span class="sc">!=</span> <span class="st">&quot;crim&quot;</span>]</span>
<span id="cb164-4"><a href="linear-regression.html#cb164-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb164-5"><a href="linear-regression.html#cb164-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb164-6"><a href="linear-regression.html#cb164-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod =</span> <span class="fu">map</span>(</span>
<span id="cb164-7"><a href="linear-regression.html#cb164-7" aria-hidden="true" tabindex="-1"></a>      predictor,</span>
<span id="cb164-8"><a href="linear-regression.html#cb164-8" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">lm</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">&quot;crim ~ poly(&quot;</span>, .x, <span class="st">&quot;, 3)&quot;</span>)), <span class="at">data =</span> boston)</span>
<span id="cb164-9"><a href="linear-regression.html#cb164-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb164-10"><a href="linear-regression.html#cb164-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_tidy =</span> <span class="fu">map</span>(mod, broom<span class="sc">::</span>tidy)</span>
<span id="cb164-11"><a href="linear-regression.html#cb164-11" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## Error in `mutate()`:
## ! Problem while computing `mod = map(...)`.
## Caused by error in `poly()`:
## ! &#39;degree&#39; must be less than number of unique points</code></pre>
<p>One of these models returned an error because the predictor does not have enough unique points to use polynomial regression.
Look at the number of unique values for each variable in <code>boston</code>:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="linear-regression.html#cb166-1" aria-hidden="true" tabindex="-1"></a>boston <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="linear-regression.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb166-3"><a href="linear-regression.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb166-4"><a href="linear-regression.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_unique_vals =</span> <span class="fu">n_distinct</span>(value), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-5"><a href="linear-regression.html#cb166-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(n_unique_vals)</span></code></pre></div>
<pre><code>## # A tibble: 13 x 2
##    name    n_unique_vals
##    &lt;chr&gt;           &lt;int&gt;
##  1 chas                2
##  2 rad                 9
##  3 zn                 26
##  4 ptratio            46
##  5 tax                66
##  6 indus              76
##  7 nox                81
##  8 medv              229
##  9 age               356
## 10 dis               412
## 11 rm                446
## 12 lstat             455
## 13 crim              504</code></pre>
<p>The <code>chas</code> variable is a dummy variable to indicate the Charles River.
Exclude it and fit again:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="linear-regression.html#cb168-1" aria-hidden="true" tabindex="-1"></a>lm_crim_uni_poly <span class="ot">&lt;-</span></span>
<span id="cb168-2"><a href="linear-regression.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb168-3"><a href="linear-regression.html#cb168-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">predictor =</span> <span class="fu">names</span>(boston)[<span class="fu">names</span>(boston) <span class="sc">!=</span> <span class="st">&quot;crim&quot;</span>]</span>
<span id="cb168-4"><a href="linear-regression.html#cb168-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb168-5"><a href="linear-regression.html#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(predictor <span class="sc">!=</span> <span class="st">&quot;chas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb168-6"><a href="linear-regression.html#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb168-7"><a href="linear-regression.html#cb168-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod =</span> <span class="fu">map</span>(</span>
<span id="cb168-8"><a href="linear-regression.html#cb168-8" aria-hidden="true" tabindex="-1"></a>      predictor,</span>
<span id="cb168-9"><a href="linear-regression.html#cb168-9" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">lm</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(<span class="st">&quot;crim ~ poly(&quot;</span>, .x, <span class="st">&quot;, 3)&quot;</span>)), <span class="at">data =</span> boston)</span>
<span id="cb168-10"><a href="linear-regression.html#cb168-10" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb168-11"><a href="linear-regression.html#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">mod_tidy =</span> <span class="fu">map</span>(mod, broom<span class="sc">::</span>tidy)</span>
<span id="cb168-12"><a href="linear-regression.html#cb168-12" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>These predictors have significant polynomial terms:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="linear-regression.html#cb169-1" aria-hidden="true" tabindex="-1"></a>lm_crim_uni_poly <span class="sc">%&gt;%</span></span>
<span id="cb169-2"><a href="linear-regression.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(mod_tidy) <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="linear-regression.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(term, <span class="st">&quot;poly&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="linear-regression.html#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(predictor) <span class="sc">%&gt;%</span></span>
<span id="cb169-5"><a href="linear-regression.html#cb169-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">sum</span>(p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb169-6"><a href="linear-regression.html#cb169-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb169-7"><a href="linear-regression.html#cb169-7" aria-hidden="true" tabindex="-1"></a>    predictor, term,</span>
<span id="cb169-8"><a href="linear-regression.html#cb169-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">estimate =</span> <span class="fu">signif</span>(estimate, <span class="dv">4</span>), <span class="at">std.error =</span> <span class="fu">signif</span>(std.error, <span class="dv">4</span>),</span>
<span id="cb169-9"><a href="linear-regression.html#cb169-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.value =</span> scales<span class="sc">::</span><span class="fu">pvalue</span>(p.value)</span>
<span id="cb169-10"><a href="linear-regression.html#cb169-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb169-11"><a href="linear-regression.html#cb169-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">&quot;term&quot;</span>)</span></code></pre></div>
<div id="czrnmwoxbz" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#czrnmwoxbz .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#czrnmwoxbz .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czrnmwoxbz .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#czrnmwoxbz .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#czrnmwoxbz .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czrnmwoxbz .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#czrnmwoxbz .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#czrnmwoxbz .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#czrnmwoxbz .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#czrnmwoxbz .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#czrnmwoxbz .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#czrnmwoxbz .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#czrnmwoxbz .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#czrnmwoxbz .gt_from_md > :first-child {
  margin-top: 0;
}

#czrnmwoxbz .gt_from_md > :last-child {
  margin-bottom: 0;
}

#czrnmwoxbz .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#czrnmwoxbz .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#czrnmwoxbz .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czrnmwoxbz .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#czrnmwoxbz .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#czrnmwoxbz .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#czrnmwoxbz .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#czrnmwoxbz .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#czrnmwoxbz .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czrnmwoxbz .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#czrnmwoxbz .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#czrnmwoxbz .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#czrnmwoxbz .gt_left {
  text-align: left;
}

#czrnmwoxbz .gt_center {
  text-align: center;
}

#czrnmwoxbz .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#czrnmwoxbz .gt_font_normal {
  font-weight: normal;
}

#czrnmwoxbz .gt_font_bold {
  font-weight: bold;
}

#czrnmwoxbz .gt_font_italic {
  font-style: italic;
}

#czrnmwoxbz .gt_super {
  font-size: 65%;
}

#czrnmwoxbz .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">estimate</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">std.error</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">p.value</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">zn</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(zn, 3)1</td>
<td class="gt_row gt_right">-38.750</td>
<td class="gt_row gt_right">8.372</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(zn, 3)2</td>
<td class="gt_row gt_right">23.940</td>
<td class="gt_row gt_right">8.372</td>
<td class="gt_row gt_left">0.004</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(zn, 3)3</td>
<td class="gt_row gt_right">-10.070</td>
<td class="gt_row gt_right">8.372</td>
<td class="gt_row gt_left">0.230</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">indus</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(indus, 3)1</td>
<td class="gt_row gt_right">78.590</td>
<td class="gt_row gt_right">7.423</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(indus, 3)2</td>
<td class="gt_row gt_right">-24.390</td>
<td class="gt_row gt_right">7.423</td>
<td class="gt_row gt_left">0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(indus, 3)3</td>
<td class="gt_row gt_right">-54.130</td>
<td class="gt_row gt_right">7.423</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">nox</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(nox, 3)1</td>
<td class="gt_row gt_right">81.370</td>
<td class="gt_row gt_right">7.234</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(nox, 3)2</td>
<td class="gt_row gt_right">-28.830</td>
<td class="gt_row gt_right">7.234</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(nox, 3)3</td>
<td class="gt_row gt_right">-60.360</td>
<td class="gt_row gt_right">7.234</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">rm</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(rm, 3)1</td>
<td class="gt_row gt_right">-42.380</td>
<td class="gt_row gt_right">8.330</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(rm, 3)2</td>
<td class="gt_row gt_right">26.580</td>
<td class="gt_row gt_right">8.330</td>
<td class="gt_row gt_left">0.002</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(rm, 3)3</td>
<td class="gt_row gt_right">-5.510</td>
<td class="gt_row gt_right">8.330</td>
<td class="gt_row gt_left">0.509</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">age</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(age, 3)1</td>
<td class="gt_row gt_right">68.180</td>
<td class="gt_row gt_right">7.840</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(age, 3)2</td>
<td class="gt_row gt_right">37.480</td>
<td class="gt_row gt_right">7.840</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(age, 3)3</td>
<td class="gt_row gt_right">21.350</td>
<td class="gt_row gt_right">7.840</td>
<td class="gt_row gt_left">0.007</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">dis</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(dis, 3)1</td>
<td class="gt_row gt_right">-73.390</td>
<td class="gt_row gt_right">7.331</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(dis, 3)2</td>
<td class="gt_row gt_right">56.370</td>
<td class="gt_row gt_right">7.331</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(dis, 3)3</td>
<td class="gt_row gt_right">-42.620</td>
<td class="gt_row gt_right">7.331</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">rad</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(rad, 3)1</td>
<td class="gt_row gt_right">120.900</td>
<td class="gt_row gt_right">6.682</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(rad, 3)2</td>
<td class="gt_row gt_right">17.490</td>
<td class="gt_row gt_right">6.682</td>
<td class="gt_row gt_left">0.009</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(rad, 3)3</td>
<td class="gt_row gt_right">4.698</td>
<td class="gt_row gt_right">6.682</td>
<td class="gt_row gt_left">0.482</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">tax</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(tax, 3)1</td>
<td class="gt_row gt_right">112.600</td>
<td class="gt_row gt_right">6.854</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(tax, 3)2</td>
<td class="gt_row gt_right">32.090</td>
<td class="gt_row gt_right">6.854</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(tax, 3)3</td>
<td class="gt_row gt_right">-7.997</td>
<td class="gt_row gt_right">6.854</td>
<td class="gt_row gt_left">0.244</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">ptratio</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(ptratio, 3)1</td>
<td class="gt_row gt_right">56.050</td>
<td class="gt_row gt_right">8.122</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(ptratio, 3)2</td>
<td class="gt_row gt_right">24.770</td>
<td class="gt_row gt_right">8.122</td>
<td class="gt_row gt_left">0.002</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(ptratio, 3)3</td>
<td class="gt_row gt_right">-22.280</td>
<td class="gt_row gt_right">8.122</td>
<td class="gt_row gt_left">0.006</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">lstat</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(lstat, 3)1</td>
<td class="gt_row gt_right">88.070</td>
<td class="gt_row gt_right">7.629</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(lstat, 3)2</td>
<td class="gt_row gt_right">15.890</td>
<td class="gt_row gt_right">7.629</td>
<td class="gt_row gt_left">0.038</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(lstat, 3)3</td>
<td class="gt_row gt_right">-11.570</td>
<td class="gt_row gt_right">7.629</td>
<td class="gt_row gt_left">0.130</td></tr>
    <tr class="gt_group_heading_row">
      <td colspan="4" class="gt_group_heading">medv</td>
    </tr>
    <tr><td class="gt_row gt_left gt_stub">poly(medv, 3)1</td>
<td class="gt_row gt_right">-75.060</td>
<td class="gt_row gt_right">6.569</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(medv, 3)2</td>
<td class="gt_row gt_right">88.090</td>
<td class="gt_row gt_right">6.569</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
    <tr><td class="gt_row gt_left gt_stub">poly(medv, 3)3</td>
<td class="gt_row gt_right">-48.030</td>
<td class="gt_row gt_right">6.569</td>
<td class="gt_row gt_left">&lt;0.001</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div id="reproducibility" class="section level2 unnumbered">
<h2>Reproducibility</h2>
<details>
<summary>
Reproducibility receipt
</summary>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="linear-regression.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2022-04-13 22:16:24 AST&quot;</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="linear-regression.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="st">&quot;git2r&quot;</span> <span class="sc">%in%</span> <span class="fu">installed.packages</span>()) {</span>
<span id="cb172-2"><a href="linear-regression.html#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (git2r<span class="sc">::</span><span class="fu">in_repository</span>()) {</span>
<span id="cb172-3"><a href="linear-regression.html#cb172-3" aria-hidden="true" tabindex="-1"></a>    git2r<span class="sc">::</span><span class="fu">repository</span>()</span>
<span id="cb172-4"><a href="linear-regression.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb172-5"><a href="linear-regression.html#cb172-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Local:    main C:/Users/tdunn/Documents/learning/islr-tidy
## Remote:   main @ origin (https://github.com/taylordunn/islr-tidy)
## Head:     [bda4b37] 2022-04-13: Started chapter 7</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="linear-regression.html#cb174-1" aria-hidden="true" tabindex="-1"></a>sessioninfo<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div>
<pre><code>## - Session info ---------------------------------------------------------------
##  setting  value                       
##  version  R version 4.1.3 (2022-03-10)
##  os       Windows 10 x64              
##  system   x86_64, mingw32             
##  ui       RTerm                       
##  language (EN)                        
##  collate  English_Canada.1252         
##  ctype    English_Canada.1252         
##  tz       America/Curacao             
##  date     2022-04-13                  
## 
## - Packages -------------------------------------------------------------------
##  package      * version    date       lib source                           
##  abind          1.4-5      2016-07-21 [1] CRAN (R 4.1.1)                   
##  assertthat     0.2.1      2019-03-21 [1] CRAN (R 4.1.0)                   
##  backports      1.2.1      2020-12-09 [1] CRAN (R 4.1.0)                   
##  bayestestR     0.10.5     2021-07-26 [1] CRAN (R 4.1.0)                   
##  bit            4.0.4      2020-08-04 [1] CRAN (R 4.1.2)                   
##  bit64          4.0.5      2020-08-30 [1] CRAN (R 4.1.2)                   
##  bookdown       0.24       2021-09-02 [1] CRAN (R 4.1.1)                   
##  broom        * 0.7.10     2021-10-31 [1] CRAN (R 4.1.2)                   
##  bslib          0.2.5.1    2021-05-18 [1] CRAN (R 4.1.0)                   
##  cachem         1.0.6      2021-08-19 [1] CRAN (R 4.1.1)                   
##  car            3.0-12     2021-11-06 [1] CRAN (R 4.1.2)                   
##  carData        3.0-4      2020-05-22 [1] CRAN (R 4.1.1)                   
##  cellranger     1.1.0      2016-07-27 [1] CRAN (R 4.1.0)                   
##  checkmate      2.0.0      2020-02-06 [1] CRAN (R 4.1.0)                   
##  class          7.3-20     2022-01-16 [2] CRAN (R 4.1.3)                   
##  cli            3.2.0      2022-02-14 [1] CRAN (R 4.1.3)                   
##  coda           0.19-4     2020-09-30 [1] CRAN (R 4.1.0)                   
##  codetools      0.2-18     2020-11-04 [2] CRAN (R 4.1.3)                   
##  colorspace     2.0-3      2022-02-21 [1] CRAN (R 4.1.3)                   
##  corrr        * 0.4.3      2020-11-24 [1] CRAN (R 4.1.0)                   
##  crayon         1.5.1      2022-03-26 [1] CRAN (R 4.1.3)                   
##  datawizard     0.1.0      2021-06-18 [1] CRAN (R 4.1.0)                   
##  DBI            1.1.2      2021-12-20 [1] CRAN (R 4.1.2)                   
##  dbplyr         2.1.1      2021-04-06 [1] CRAN (R 4.1.0)                   
##  DEoptimR       1.0-9      2021-05-24 [1] CRAN (R 4.1.0)                   
##  dials        * 0.0.10     2021-09-10 [1] CRAN (R 4.1.1)                   
##  DiceDesign     1.9        2021-02-13 [1] CRAN (R 4.1.0)                   
##  digest         0.6.29     2021-12-01 [1] CRAN (R 4.1.2)                   
##  distill        1.3        2021-10-13 [1] CRAN (R 4.1.2)                   
##  downlit        0.4.0      2021-10-29 [1] CRAN (R 4.1.1)                   
##  dplyr        * 1.0.8      2022-02-08 [1] CRAN (R 4.1.3)                   
##  dunnr        * 0.2.5      2022-01-15 [1] Github (taylordunn/dunnr@c83b30e)
##  effectsize     0.4.5      2021-05-25 [1] CRAN (R 4.1.0)                   
##  ellipsis       0.3.2      2021-04-29 [1] CRAN (R 4.1.0)                   
##  emmeans        1.7.0      2021-09-29 [1] CRAN (R 4.1.2)                   
##  equatiomatic   0.2.0      2021-01-30 [1] CRAN (R 4.1.0)                   
##  estimability   1.3        2018-02-11 [1] CRAN (R 4.1.1)                   
##  evaluate       0.14       2019-05-28 [1] CRAN (R 4.1.0)                   
##  extrafont      0.17       2014-12-08 [1] CRAN (R 4.1.0)                   
##  extrafontdb    1.0        2012-06-11 [1] CRAN (R 4.1.0)                   
##  fansi          1.0.3      2022-03-24 [1] CRAN (R 4.1.3)                   
##  farver         2.1.0      2021-02-28 [1] CRAN (R 4.1.0)                   
##  fastmap        1.1.0      2021-01-25 [1] CRAN (R 4.1.0)                   
##  forcats      * 0.5.1      2021-01-27 [1] CRAN (R 4.1.0)                   
##  foreach        1.5.2      2022-02-02 [1] CRAN (R 4.1.3)                   
##  fs             1.5.2      2021-12-08 [1] CRAN (R 4.1.2)                   
##  furrr          0.2.3      2021-06-25 [1] CRAN (R 4.1.2)                   
##  future         1.24.0     2022-02-19 [1] CRAN (R 4.1.3)                   
##  future.apply   1.8.1      2021-08-10 [1] CRAN (R 4.1.3)                   
##  generics       0.1.2      2022-01-31 [1] CRAN (R 4.1.3)                   
##  GGally         2.1.2      2021-06-21 [1] CRAN (R 4.1.0)                   
##  ggplot2      * 3.3.5      2021-06-25 [1] CRAN (R 4.1.0)                   
##  ggrepel        0.9.1      2021-01-15 [1] CRAN (R 4.1.0)                   
##  ggridges       0.5.3      2021-01-08 [1] CRAN (R 4.1.0)                   
##  git2r          0.28.0     2021-01-10 [1] CRAN (R 4.1.0)                   
##  globals        0.14.0     2020-11-22 [1] CRAN (R 4.1.0)                   
##  glue           1.6.2      2022-02-24 [1] CRAN (R 4.1.3)                   
##  gower          0.2.2      2020-06-23 [1] CRAN (R 4.1.0)                   
##  GPfit          1.0-8      2019-02-08 [1] CRAN (R 4.1.0)                   
##  gridExtra      2.3        2017-09-09 [1] CRAN (R 4.1.0)                   
##  gt           * 0.3.1      2021-08-07 [1] CRAN (R 4.1.2)                   
##  gtable         0.3.0      2019-03-25 [1] CRAN (R 4.1.0)                   
##  hardhat        0.2.0      2022-01-24 [1] CRAN (R 4.1.3)                   
##  haven          2.4.1      2021-04-23 [1] CRAN (R 4.1.0)                   
##  here         * 1.0.1      2020-12-13 [1] CRAN (R 4.1.0)                   
##  highr          0.9        2021-04-16 [1] CRAN (R 4.1.0)                   
##  hms            1.1.1      2021-09-26 [1] CRAN (R 4.1.2)                   
##  htmltools      0.5.2      2021-08-25 [1] CRAN (R 4.1.1)                   
##  httr           1.4.2      2020-07-20 [1] CRAN (R 4.1.0)                   
##  infer        * 1.0.0      2021-08-13 [1] CRAN (R 4.1.1)                   
##  insight        0.14.2     2021-06-22 [1] CRAN (R 4.1.0)                   
##  ipred          0.9-12     2021-09-15 [1] CRAN (R 4.1.1)                   
##  ISLR2        * 1.3-1      2022-01-10 [1] CRAN (R 4.1.2)                   
##  iterators      1.0.14     2022-02-05 [1] CRAN (R 4.1.3)                   
##  jquerylib      0.1.4      2021-04-26 [1] CRAN (R 4.1.0)                   
##  jsonlite       1.7.3      2022-01-17 [1] CRAN (R 4.1.2)                   
##  knitr          1.37       2021-12-16 [1] CRAN (R 4.1.2)                   
##  labeling       0.4.2      2020-10-20 [1] CRAN (R 4.1.0)                   
##  lattice        0.20-45    2021-09-22 [2] CRAN (R 4.1.3)                   
##  lava           1.6.10     2021-09-02 [1] CRAN (R 4.1.3)                   
##  lhs            1.1.1      2020-10-05 [1] CRAN (R 4.1.0)                   
##  lifecycle      1.0.1      2021-09-24 [1] CRAN (R 4.1.1)                   
##  listenv        0.8.0      2019-12-05 [1] CRAN (R 4.1.0)                   
##  lubridate      1.8.0      2021-10-07 [1] CRAN (R 4.1.1)                   
##  magrittr       2.0.2      2022-01-26 [1] CRAN (R 4.1.3)                   
##  MASS           7.3-55     2022-01-16 [2] CRAN (R 4.1.3)                   
##  Matrix         1.4-0      2021-12-08 [2] CRAN (R 4.1.3)                   
##  memoise        2.0.1      2021-11-26 [1] CRAN (R 4.1.2)                   
##  mgcv           1.8-39     2022-02-24 [2] CRAN (R 4.1.3)                   
##  modeldata    * 0.1.1      2021-07-14 [1] CRAN (R 4.1.0)                   
##  modelr         0.1.8      2020-05-19 [1] CRAN (R 4.1.0)                   
##  munsell        0.5.0      2018-06-12 [1] CRAN (R 4.1.0)                   
##  mvtnorm        1.1-3      2021-10-08 [1] CRAN (R 4.1.1)                   
##  nlme           3.1-155    2022-01-16 [2] CRAN (R 4.1.3)                   
##  nnet           7.3-17     2022-01-16 [2] CRAN (R 4.1.3)                   
##  parallelly     1.30.0     2021-12-17 [1] CRAN (R 4.1.2)                   
##  parameters     0.14.0     2021-05-29 [1] CRAN (R 4.1.0)                   
##  parsnip      * 0.1.7      2021-07-21 [1] CRAN (R 4.1.0)                   
##  patchwork    * 1.1.1      2020-12-17 [1] CRAN (R 4.1.0)                   
##  performance    0.7.3      2021-07-21 [1] CRAN (R 4.1.1)                   
##  pillar         1.7.0      2022-02-01 [1] CRAN (R 4.1.2)                   
##  pkgconfig      2.0.3      2019-09-22 [1] CRAN (R 4.1.0)                   
##  plyr           1.8.7      2022-03-24 [1] CRAN (R 4.1.3)                   
##  pROC           1.17.0.1   2021-01-13 [1] CRAN (R 4.1.0)                   
##  prodlim        2019.11.13 2019-11-17 [1] CRAN (R 4.1.0)                   
##  purrr        * 0.3.4      2020-04-17 [1] CRAN (R 4.1.2)                   
##  qqplotr        0.0.5      2021-04-23 [1] CRAN (R 4.1.0)                   
##  R6             2.5.1      2021-08-19 [1] CRAN (R 4.1.1)                   
##  RColorBrewer   1.1-3      2022-04-03 [1] CRAN (R 4.1.3)                   
##  Rcpp           1.0.8.3    2022-03-17 [1] CRAN (R 4.1.3)                   
##  readr        * 2.1.1      2021-11-30 [1] CRAN (R 4.1.2)                   
##  readxl         1.3.1      2019-03-13 [1] CRAN (R 4.1.0)                   
##  recipes      * 0.1.17     2021-09-27 [1] CRAN (R 4.1.1)                   
##  reprex         2.0.0      2021-04-02 [1] CRAN (R 4.1.0)                   
##  reshape        0.8.8      2018-10-23 [1] CRAN (R 4.1.0)                   
##  rlang          1.0.2      2022-03-04 [1] CRAN (R 4.1.3)                   
##  rmarkdown      2.11       2021-09-14 [1] CRAN (R 4.1.1)                   
##  robustbase     0.93-8     2021-06-02 [1] CRAN (R 4.1.0)                   
##  rpart          4.1.16     2022-01-24 [2] CRAN (R 4.1.3)                   
##  rprojroot      2.0.2      2020-11-15 [1] CRAN (R 4.1.0)                   
##  rsample      * 0.1.0      2021-05-08 [1] CRAN (R 4.1.0)                   
##  rstudioapi     0.13       2020-11-12 [1] CRAN (R 4.1.0)                   
##  Rttf2pt1       1.3.8      2020-01-10 [1] CRAN (R 4.1.1)                   
##  rvest          1.0.0      2021-03-09 [1] CRAN (R 4.1.0)                   
##  sass           0.4.0      2021-05-12 [1] CRAN (R 4.1.0)                   
##  scales       * 1.1.1      2020-05-11 [1] CRAN (R 4.1.0)                   
##  see            0.6.4      2021-05-29 [1] CRAN (R 4.1.0)                   
##  sessioninfo    1.1.1      2018-11-05 [1] CRAN (R 4.1.0)                   
##  stringi        1.7.6      2021-11-29 [1] CRAN (R 4.1.2)                   
##  stringr      * 1.4.0      2019-02-10 [1] CRAN (R 4.1.0)                   
##  survival       3.2-13     2021-08-24 [2] CRAN (R 4.1.3)                   
##  tibble       * 3.1.6      2021-11-07 [1] CRAN (R 4.1.1)                   
##  tidymodels   * 0.1.4      2021-10-01 [1] CRAN (R 4.1.1)                   
##  tidyr        * 1.2.0      2022-02-01 [1] CRAN (R 4.1.3)                   
##  tidyselect     1.1.2      2022-02-21 [1] CRAN (R 4.1.3)                   
##  tidyverse    * 1.3.1      2021-04-15 [1] CRAN (R 4.1.3)                   
##  timeDate       3043.102   2018-02-21 [1] CRAN (R 4.1.0)                   
##  tune         * 0.1.6      2021-07-21 [1] CRAN (R 4.1.0)                   
##  tzdb           0.2.0      2021-10-27 [1] CRAN (R 4.1.2)                   
##  usethis        2.1.5      2021-12-09 [1] CRAN (R 4.1.2)                   
##  utf8           1.2.2      2021-07-24 [1] CRAN (R 4.1.0)                   
##  vctrs          0.3.8      2021-04-29 [1] CRAN (R 4.1.3)                   
##  vroom          1.5.7      2021-11-30 [1] CRAN (R 4.1.2)                   
##  withr          2.5.0      2022-03-03 [1] CRAN (R 4.1.3)                   
##  workflows    * 0.2.3      2021-07-16 [1] CRAN (R 4.1.0)                   
##  workflowsets * 0.1.0      2021-07-22 [1] CRAN (R 4.1.0)                   
##  xfun           0.29       2021-12-14 [1] CRAN (R 4.1.2)                   
##  xml2           1.3.3      2021-11-30 [1] CRAN (R 4.1.2)                   
##  xtable         1.8-4      2019-04-21 [1] CRAN (R 4.1.0)                   
##  yaml           2.2.1      2020-02-01 [1] CRAN (R 4.1.0)                   
##  yardstick    * 0.0.8      2021-03-28 [1] CRAN (R 4.1.0)                   
## 
## [1] C:/Users/tdunn/Documents/R/win-library/4.1
## [2] C:/Program Files/R/R-4.1.3/library</code></pre>
</details>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Smith2018" class="csl-entry">
Smith, Gary. 2018. <span>â€œ<span class="nocase">Step away from stepwise</span>.â€</span> <em>Journal of Big Data</em> 5 (1): 32. <a href="https://doi.org/10.1186/s40537-018-0143-6">https://doi.org/10.1186/s40537-018-0143-6</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistical-learning.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="classification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
